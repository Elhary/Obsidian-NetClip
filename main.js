/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => NetClipPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian9 = require("obsidian");

// src/view/ClipperView.ts
var import_obsidian7 = require("obsidian");

// src/utils.ts
function normalizeUrl(url) {
  try {
    const parsedUrl = new URL(url);
    const trackingParams = [
      "utm_source",
      "utm_medium",
      "utm_campaign",
      "utm_term",
      "utm_content",
      "fbclid",
      "gclid"
    ];
    trackingParams.forEach((param) => {
      parsedUrl.searchParams.delete(param);
    });
    return parsedUrl.toString();
  } catch (e) {
    return null;
  }
}
function sanitizePath(path) {
  return path.replace(/[\/\\:*?"<>|]/g, "_").replace(/\s+/g, " ").trim();
}
function getDomain(url) {
  try {
    const parsedUrl = new URL(url);
    return parsedUrl.hostname.replace(/^www\./, "");
  } catch (e) {
    return "Unknown Domain";
  }
}

// src/deleteModal.ts
var import_obsidian = require("obsidian");
var DeleteConfirmationModal = class extends import_obsidian.Modal {
  constructor(app, file, onConfirmDelete) {
    super(app);
    this.file = file;
    this.onConfirmDelete = onConfirmDelete;
  }
  onOpen() {
    this.titleEl.setText("Confirm Delete");
    this.contentEl.createEl("p", { text: `Are you sure you want to delete the article "${this.file.basename}"?` });
    const buttonContainer = this.contentEl.createEl("div", { cls: "netclip_button-container" });
    const confirmButton = buttonContainer.createEl("button", {
      cls: "mod-warning",
      text: "Delete"
    });
    const cancelButton = buttonContainer.createEl("button", { text: "Cancel" });
    confirmButton.addEventListener("click", async () => {
      await this.onConfirmDelete();
      this.close();
    });
    cancelButton.addEventListener("click", () => {
      this.close();
    });
  }
  onClose() {
    this.contentEl.empty();
  }
};

// src/contextMenu.ts
var import_obsidian6 = require("obsidian");

// src/view/ModalWebView.ts
var import_obsidian4 = require("obsidian");

// src/webViewComponent.ts
var import_obsidian3 = require("obsidian");

// src/search/searchUrls.ts
var baseSearchUrls = {
  google: "https://www.google.com/search?q=",
  youtube: "https://www.youtube.com/results?search_query=",
  bing: "https://www.bing.com/search?q=",
  perplexity: "https://www.perplexity.ai/search/new?q=",
  duckduckgo: "https://duckduckgo.com/?q=",
  genspark: "https://www.genspark.ai/search?query=",
  kagi: "https://kagi.com/search?q=",
  yahoo: "http://search.yahoo.com/search?p="
};

// src/search/fetchSuggestions.ts
var import_obsidian2 = require("obsidian");
var fetchSuggestions = (query, suggestionContainer, suggestionsBox, selectSuggestion) => {
  suggestionsBox.innerHTML = "";
  if (!query || query.trim() === "") {
    suggestionContainer.style.display = "none";
    return;
  }
  (0, import_obsidian2.requestUrl)({
    url: `https://suggestqueries.google.com/complete/search?client=chrome&q=${encodeURIComponent(query)}`,
    method: "GET",
    headers: {
      "User-Agent": "Mozilla/5.0",
      "Accept": "application/json"
    }
  }).then((response) => {
    if (response.status !== 200) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    try {
      const data = JSON.parse(response.text);
      const suggestions = data[1] || [];
      suggestionContainer.style.display = suggestions.length > 0 ? "block" : "none";
      suggestions.forEach((suggestion) => {
        const suggestionDiv = document.createElement("div");
        suggestionDiv.classList.add("netClip-suggestion-item");
        const iconSpan = document.createElement("span");
        iconSpan.classList.add("search_icon");
        iconSpan.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>';
        const textSpan = document.createElement("span");
        textSpan.textContent = suggestion;
        suggestionDiv.appendChild(iconSpan);
        suggestionDiv.appendChild(textSpan);
        suggestionDiv.onclick = () => selectSuggestion(suggestion);
        suggestionsBox.appendChild(suggestionDiv);
      });
    } catch (parseError) {
      console.error("Error parsing suggestions:", parseError);
      suggestionContainer.style.display = "none";
    }
  }).catch((error) => {
    console.error("Error fetching suggestions:", error);
    suggestionContainer.style.display = "none";
  });
};

// src/search/search.ts
var WebSearch = class {
  constructor(searchInput, suggestionContainer, suggestionsBox, settings = {}) {
    this.currentSuggestionIndex = -1;
    // Use the imported baseSearchUrls
    this.baseSearchUrls = baseSearchUrls;
    this.searchInput = searchInput;
    this.suggestionContainer = suggestionContainer;
    this.suggestionsBox = suggestionsBox;
    this.settings = {
      searchEngine: "google",
      ...settings
    };
    this.setupEventListeners();
  }
  setupEventListeners() {
    this.searchInput.addEventListener("input", () => {
      const query = this.searchInput.value.trim();
      if (query === "") {
        this.hideSuggestions();
      } else {
        fetchSuggestions(
          query,
          this.suggestionContainer,
          this.suggestionsBox,
          this.selectSuggestion.bind(this)
        );
      }
    });
    this.searchInput.addEventListener("keydown", (event) => {
      const suggestions = this.suggestionsBox.children;
      switch (event.key) {
        case "ArrowDown":
          event.preventDefault();
          this.navigateSuggestions("down", suggestions);
          break;
        case "ArrowUp":
          event.preventDefault();
          this.navigateSuggestions("up", suggestions);
          break;
        case "Enter":
          event.preventDefault();
          this.handleEnterKey(suggestions);
          break;
        case "Escape":
          this.hideSuggestions();
          break;
      }
    });
    document.addEventListener("click", (event) => {
      if (!this.searchInput.contains(event.target) && !this.suggestionContainer.contains(event.target)) {
        this.hideSuggestions();
      }
    });
  }
  isValidUrl(str) {
    try {
      new URL(str);
      return true;
    } catch (e) {
      return false;
    }
  }
  constructSearchUrl(query) {
    const selectedEngine = this.settings.searchEngine || "google";
    const baseSearchUrl = this.baseSearchUrls[selectedEngine];
    const encodedQuery = encodeURIComponent(query.trim());
    return `${baseSearchUrl}${encodedQuery}`;
  }
  navigateToQuery(query) {
    const searchUrl = this.isValidUrl(query) ? query : this.constructSearchUrl(query);
    const event = new CustomEvent("search-query", {
      detail: { url: searchUrl, query }
    });
    this.searchInput.dispatchEvent(event);
    return searchUrl;
  }
  selectSuggestion(suggestion) {
    this.searchInput.value = suggestion;
    this.navigateToQuery(suggestion);
    this.hideSuggestions();
  }
  navigateSuggestions(direction, suggestions) {
    if (suggestions.length === 0)
      return;
    if (this.currentSuggestionIndex !== -1) {
      suggestions[this.currentSuggestionIndex].classList.remove("selected");
    }
    if (direction === "down") {
      this.currentSuggestionIndex = this.currentSuggestionIndex < suggestions.length - 1 ? this.currentSuggestionIndex + 1 : -1;
    } else {
      this.currentSuggestionIndex = this.currentSuggestionIndex > -1 ? this.currentSuggestionIndex - 1 : suggestions.length - 1;
    }
    if (this.currentSuggestionIndex === -1) {
      this.searchInput.value = this.searchInput.getAttribute("data-original-value") || "";
    } else {
      const selectedSuggestion = suggestions[this.currentSuggestionIndex];
      selectedSuggestion.classList.add("selected");
      this.searchInput.value = selectedSuggestion.textContent || "";
    }
  }
  handleEnterKey(suggestions) {
    if (this.currentSuggestionIndex !== -1 && suggestions[this.currentSuggestionIndex]) {
      suggestions[this.currentSuggestionIndex].click();
    } else {
      const query = this.searchInput.value;
      if (query) {
        this.navigateToQuery(query);
      }
    }
    this.hideSuggestions();
  }
  hideSuggestions() {
    this.suggestionContainer.style.display = "none";
    this.suggestionsBox.innerHTML = "";
    this.currentSuggestionIndex = -1;
  }
};

// src/webViewComponent.ts
var WebViewComponent = class {
  constructor(app, url, settings = {}, onClipCallback) {
    this.app = app;
    this.isFrameReady = false;
    this.navigationHistory = [];
    this.currentHistoryIndex = -1;
    this.url = url;
    this.settings = {
      defaultWidth: "100%",
      defaultHeight: "100%",
      searchEngine: "google",
      fitToContainer: true,
      ...settings
    };
    this.onClipCallback = onClipCallback;
  }
  createContainer() {
    const containerEl = document.createElement("div");
    containerEl.classList.add("netClip_webview_container");
    const controlsEl = containerEl.createDiv("netClip_web_controls");
    this.setupNavigationBtns(controlsEl);
    this.setupSearchInput(controlsEl);
    this.setupClipBtn(controlsEl);
    this.setupFrameContainer(containerEl);
    this.navigationHistory.push(this.url);
    this.currentHistoryIndex = 0;
    return containerEl;
  }
  setupSearchInput(container) {
    const searchContainer = container.createDiv("netClip_search_container");
    this.searchInput = searchContainer.createEl("input", { type: "text", placeholder: "Search...", value: this.url });
    const suggestionContainer = searchContainer.createDiv("netClip_query_box");
    const suggestionsBox = suggestionContainer.createDiv("netClip_suggestions");
    this.search = new WebSearch(
      this.searchInput,
      suggestionContainer,
      suggestionsBox,
      { searchEngine: this.settings.searchEngine }
    );
    this.searchInput.addEventListener("search-query", (event) => {
      const { url } = event.detail;
      this.navigateTo(url);
    });
  }
  setupClipBtn(container) {
    if (this.onClipCallback) {
      const clipContianer = container.createDiv("netClip_clip_btn_container");
      this.clipBtn = clipContianer.createEl("button", { text: "Clip" });
      this.clipBtn.onclick = () => {
        var _a;
        (_a = this.onClipCallback) == null ? void 0 : _a.call(this, this.getCurrentUrl());
      };
    }
  }
  setupNavigationBtns(container) {
    const leftContainer = container.createDiv("netClip_nav_left");
    this.backBtn = leftContainer.createEl("button", { cls: "netClip_back_btn netClip_btn" });
    this.backBtn.innerHTML = `
        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left"><path d="m15 18-6-6 6-6"/></svg>
        `;
    this.backBtn.onclick = () => this.goBack();
    this.backBtn.disabled = true;
    this.forwardBtn = leftContainer.createEl("button", { cls: "netClip_forward_btn netClip_btn" });
    this.forwardBtn.innerHTML = `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right"><path d="m9 18 6-6-6-6"/></svg>
        `;
    this.forwardBtn.onclick = () => this.goForward();
    this.forwardBtn.disabled = true;
    const refreshBtn = leftContainer.createEl("button", { cls: "netClip_refresh_btn netClip_btn" });
    refreshBtn.innerHTML = `
        <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-ccw"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/></svg>
        `;
    refreshBtn.onclick = () => this.refresh();
  }
  setupFrameContainer(containerEl) {
    const frameContainer = containerEl.createDiv("netClip_frame-container");
    frameContainer.style.flexGrow = "1";
    frameContainer.style.position = "relative";
    frameContainer.style.overflow = "hidden";
    this.loadingSpinner = frameContainer.createDiv("loading-spinner");
    this.loadingSpinner.style.position = "absolute";
    this.loadingSpinner.style.display = "none";
    this.frame = this.createFrame();
    frameContainer.appendChild(this.frame);
    return frameContainer;
  }
  createFrame() {
    return import_obsidian3.Platform.isMobileApp ? this.createIframe() : this.createWebview();
  }
  createIframe() {
    const iframe = document.createElement("iframe");
    iframe.setAttribute("allowpopups", "");
    iframe.setAttribute("credentialless", "true");
    iframe.setAttribute("crossorigin", "anonymous");
    iframe.setAttribute("src", this.url);
    iframe.setAttribute("sandbox", "allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts allow-top-navigation-by-user-activation");
    iframe.setAttribute("allow", "encrypted-media;fullscreen;oversized-images;picture-in-picture;sync-xhr;geolocation");
    iframe.style.width = "100%";
    iframe.style.height = "100%";
    iframe.style.border = "none";
    iframe.style.objectFit = "contain";
    iframe.style.backgroundColor = "#f0f0f0";
    iframe.addEventListener("load", () => {
      this.onFrameLoad();
    });
    return iframe;
  }
  // Create webview for desktop
  createWebview() {
    const webview = document.createElement("webview");
    webview.allowpopups = true;
    webview.src = this.url;
    webview.style.width = "100%";
    webview.style.height = "100%";
    webview.style.border = "none";
    webview.style.backgroundColor = "#f0f0f0";
    webview.style.objectFit = "contain";
    webview.addEventListener("dom-ready", () => {
      this.isFrameReady = true;
      this.updateUrlDisplay();
      this.loadingSpinner.style.display = "none";
    });
    webview.addEventListener("did-start-loading", () => {
      this.loadingSpinner.style.display = "block";
    });
    webview.addEventListener("did-stop-loading", () => {
      this.loadingSpinner.style.display = "none";
    });
    webview.addEventListener("did-navigate", () => {
      this.updateUrlDisplay();
      this.updateNavigationButtons();
    });
    webview.addEventListener("did-navigate-in-page", () => {
      this.updateUrlDisplay();
      this.updateNavigationButtons();
    });
    return webview;
  }
  onFrameLoad() {
    this.isFrameReady = true;
    this.updateUrlDisplay();
    this.loadingSpinner.style.display = "none";
    const currentUrl = this.getCurrentUrl();
    if (currentUrl !== this.navigationHistory[this.currentHistoryIndex]) {
      this.navigationHistory = this.navigationHistory.slice(0, this.currentHistoryIndex + 1);
      this.navigationHistory.push(currentUrl);
      this.currentHistoryIndex++;
      this.updateNavigationButtons();
    }
  }
  navigateTo(url) {
    this.url = url;
    this.navigationHistory.push(this.url);
    this.currentHistoryIndex = this.navigationHistory.length - 1;
    this.frame.src = this.url;
    this.updateUrlDisplay();
  }
  getCurrentUrl() {
    var _a;
    if (this.frame instanceof HTMLIFrameElement) {
      return ((_a = this.frame.contentWindow) == null ? void 0 : _a.location.href) || this.url;
    } else if (this.frame && typeof this.frame.getURL === "function") {
      return this.frame.getURL() || this.url;
    }
    return this.url;
  }
  updateUrlDisplay() {
    const currentUrl = this.getCurrentUrl();
    this.url = currentUrl;
    if (this.searchInput) {
      this.searchInput.value = currentUrl;
    }
  }
  updateNavigationButtons() {
    var _a, _b;
    if (this.frame instanceof HTMLIFrameElement) {
      this.backBtn.disabled = this.currentHistoryIndex <= 0;
      this.forwardBtn.disabled = this.currentHistoryIndex >= this.navigationHistory.length - 1;
    } else {
      const webview = this.frame;
      this.backBtn.disabled = !((_a = webview.canGoBack) == null ? void 0 : _a.call(webview));
      this.forwardBtn.disabled = !((_b = webview.canGoForward) == null ? void 0 : _b.call(webview));
    }
  }
  goBack() {
    var _a, _b;
    if (this.isFrameReady) {
      this.loadingSpinner.style.display = "block";
      if (this.frame instanceof HTMLIFrameElement) {
        if (this.currentHistoryIndex > 0) {
          this.currentHistoryIndex--;
          this.frame.src = this.navigationHistory[this.currentHistoryIndex];
        }
      } else {
        const webview = this.frame;
        if ((_a = webview.canGoBack) == null ? void 0 : _a.call(webview)) {
          (_b = webview.goBack) == null ? void 0 : _b.call(webview);
        }
      }
    }
  }
  goForward() {
    var _a, _b;
    if (this.isFrameReady) {
      this.loadingSpinner.style.display = "block";
      if (this.frame instanceof HTMLIFrameElement) {
        if (this.currentHistoryIndex < this.navigationHistory.length - 1) {
          this.currentHistoryIndex++;
          this.frame.src = this.navigationHistory[this.currentHistoryIndex];
        }
      } else {
        const webview = this.frame;
        if ((_a = webview.canGoForward) == null ? void 0 : _a.call(webview)) {
          (_b = webview.goForward) == null ? void 0 : _b.call(webview);
        }
      }
    }
  }
  refresh() {
    var _a;
    if (this.isFrameReady) {
      this.loadingSpinner.style.display = "block";
      if (this.frame instanceof HTMLIFrameElement) {
        (_a = this.frame.contentWindow) == null ? void 0 : _a.location.reload();
      } else {
        this.frame.reload();
      }
    }
  }
};

// src/view/ModalWebView.ts
var DEFAULT_SETTINGS = {
  defaultWidth: "100%",
  defaultHeight: "100%"
};
var WebViewModal = class extends import_obsidian4.Modal {
  constructor(app, url, settings = DEFAULT_SETTINGS, plugin) {
    var _a, _b, _c;
    super(app);
    this.plugin = plugin;
    this.settings = {
      defaultWidth: ((_a = plugin == null ? void 0 : plugin.settings) == null ? void 0 : _a.modalWidth) || settings.defaultWidth || "80vw",
      defaultHeight: ((_b = plugin == null ? void 0 : plugin.settings) == null ? void 0 : _b.modalHeight) || settings.defaultHeight || "80vh"
    };
    this.webViewComponent = new WebViewComponent(
      this.app,
      url,
      {
        defaultWidth: this.settings.defaultWidth,
        defaultHeight: this.settings.defaultHeight,
        searchEngine: ((_c = plugin == null ? void 0 : plugin.settings) == null ? void 0 : _c.searchEngine) || "default"
      },
      async (clipUrl) => {
        if (this.plugin && typeof this.plugin.clipWebpage === "function") {
          await this.plugin.clipWebpage(clipUrl);
        } else {
          new import_obsidian4.Notice("Clip webpage function not available");
        }
      }
    );
  }
  onOpen() {
    const { contentEl } = this;
    this.modalEl.style.width = this.settings.defaultWidth;
    this.modalEl.style.height = this.settings.defaultHeight;
    const webViewContainer = this.webViewComponent.createContainer();
    contentEl.appendChild(webViewContainer);
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/view/EditorWebView.ts
var import_obsidian5 = require("obsidian");
var VIEW_TYPE_WORKSPACE_WEBVIEW = "netClip_workspace_webview";
var WorkspaceLeafWebView = class extends import_obsidian5.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.initialUrl = "";
    this.icon = "globe";
    this.plugin = plugin;
  }
  setUrl(url) {
    this.initialUrl = url;
    this.reloadWebView();
  }
  getViewType() {
    return VIEW_TYPE_WORKSPACE_WEBVIEW;
  }
  getDisplayText() {
    return "Web View";
  }
  reloadWebView() {
    this.containerEl.empty();
    this.createWebViewComponent();
  }
  createWebViewComponent() {
    this.webViewComponent = new WebViewComponent(
      this.app,
      this.initialUrl,
      {
        searchEngine: this.plugin.settings.searchEngine
      },
      async (clipUrl) => {
        if (this.plugin && typeof this.plugin.clipWebpage === "function") {
          await this.plugin.clipWebpage(clipUrl);
        } else {
          new import_obsidian5.Notice("Clip webpage function not available");
        }
      }
    );
    const containerEl = this.webViewComponent.createContainer();
    this.containerEl.appendChild(containerEl);
  }
  async onOpen() {
    var _a;
    this.containerEl = this.containerEl.children[1];
    this.containerEl.empty();
    const stateUrl = (_a = this.leaf.getViewState().state) == null ? void 0 : _a.url;
    this.initialUrl = typeof stateUrl === "string" && stateUrl || this.plugin.settings.defaultWebUrl || "https://google.com";
    this.createWebViewComponent();
  }
  async onClose() {
    this.containerEl.empty();
  }
};

// src/contextMenu.ts
var ClipperContextMenu = class {
  constructor(app, file, onDelete, onOpenArticle, url) {
    this.app = app;
    this.file = file;
    this.url = url;
    this.onDelete = onDelete;
    this.onOpenArticle = onOpenArticle;
    this.plugin = this.app.plugins.getPlugin("net-clip");
  }
  show(anchorElement) {
    const menu = new import_obsidian6.Menu();
    menu.addItem((item) => {
      item.setTitle("Open page in Editor").setIcon("globe").onClick(() => {
        if (this.url) {
          const existingLeaf = this.app.workspace.getLeavesOfType(VIEW_TYPE_WORKSPACE_WEBVIEW).find((leaf) => {
            const view = leaf.view;
            return view.url === this.url;
          });
          if (existingLeaf) {
            this.app.workspace.setActiveLeaf(existingLeaf, { focus: true });
          } else {
            const leaf = this.app.workspace.getLeaf("tab");
            leaf.setViewState({
              type: VIEW_TYPE_WORKSPACE_WEBVIEW,
              state: { url: this.url }
            }).then(() => {
              if (leaf.view instanceof WorkspaceLeafWebView) {
                leaf.view.setUrl(this.url);
                this.app.workspace.setActiveLeaf(leaf, { focus: true });
              }
            });
          }
        } else {
          new import_obsidian6.Notice("No URL found for this clipping");
        }
      });
    });
    menu.addItem((item) => {
      item.setTitle("Open page in Modal").setIcon("maximize").onClick(() => {
        if (this.url) {
          const modal = new WebViewModal(
            this.app,
            this.url,
            void 0,
            this.plugin
          );
          modal.open();
        } else {
          new import_obsidian6.Notice("No URL found for this clipping");
        }
      });
    });
    menu.addItem((item) => {
      item.setTitle("Open in Editor").setIcon("file-text").onClick(() => {
        this.onOpenArticle(this.file);
      });
    });
    menu.addItem((item) => {
      item.setTitle("Delete").setIcon("trash").onClick(() => {
        this.onDelete(this.file);
      });
    });
    const rect = anchorElement.getBoundingClientRect();
    menu.showAtPosition({ x: rect.left, y: rect.bottom });
  }
};

// src/view/ClipperView.ts
var CLIPPER_VIEW = "netClip_clipper_view";
var clipperHomeView = class extends import_obsidian7.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.icon = "newspaper";
    this.plugin = plugin;
    this.settings = plugin.settings;
  }
  getViewType() {
    return CLIPPER_VIEW;
  }
  getDisplayText() {
    return "Clipper View";
  }
  async onOpen() {
    this.containerEl = this.containerEl.children[1];
    this.containerEl.empty();
    const clipperContainer = this.containerEl.createEl("div", { cls: "net_clipper_container" });
    const clipperHeader = clipperContainer.createEl("div", { cls: "net_clipper_header" });
    const openWeb = clipperHeader.createEl("span", { cls: "netopen_Web" });
    const openSettings = clipperHeader.createEl("span", { cls: "netopen_settings" });
    openWeb.innerHTML = `
         <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-globe">
           <circle cx="12" cy="12" r="10"/>
           <path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/>
           <path d="M2 12h20"/>
         </svg>
         `;
    openSettings.innerHTML = `
         <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bolt">
           <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
           <circle cx="12" cy="12" r="4"/>
         </svg>
         `;
    const clipInputContainer = clipperContainer.createEl("div", { cls: "netclip_input_container" });
    openWeb.addEventListener("click", async () => {
      const defaultUrl = this.settings.defaultWebUrl || "https://google.com";
      const existingLeaf = this.app.workspace.getLeavesOfType(VIEW_TYPE_WORKSPACE_WEBVIEW).find((leaf) => {
        const view = leaf.view;
        return view.url === defaultUrl;
      });
      if (existingLeaf) {
        this.app.workspace.setActiveLeaf(existingLeaf, { focus: true });
      } else {
        const leaf = this.app.workspace.getLeaf(true);
        await leaf.setViewState({
          type: VIEW_TYPE_WORKSPACE_WEBVIEW,
          state: { url: defaultUrl }
        });
        this.app.workspace.setActiveLeaf(leaf, { focus: true });
      }
    });
    openSettings.addEventListener("click", () => {
      this.app.settings.open();
      this.app.settings.openTabById("net-clip-settings");
    });
    const clipInput = clipInputContainer.createEl(
      "input",
      {
        cls: "net_clip_input",
        type: "text",
        placeholder: "Enter URL to clip..."
      }
    );
    const clipButton = clipInputContainer.createEl("button", {
      cls: "netclip_btn",
      text: "Clip"
    });
    clipButton.addEventListener("click", () => {
      if (clipInput.value) {
        const normalizedUrl = normalizeUrl(clipInput.value);
        if (normalizedUrl) {
          this.plugin.clipWebpage(normalizedUrl);
        }
        clipInput.value = "";
      }
    });
    const SavedContentBox = clipperContainer.createEl("div", { cls: "netclip_saved_container" });
    await this.renderSavedContent(SavedContentBox);
  }
  async renderSavedContent(container) {
    container.empty();
    const files = this.app.vault.getMarkdownFiles();
    const clippedFiles = files.filter((file) => file.path.startsWith(this.settings.defaultFolderName));
    if (clippedFiles.length === 0) {
      const emptyContainer = container.createEl("div", { cls: "empty_box" });
      const emptyIcon = emptyContainer.createEl("span", { cls: "empty_icon" });
      emptyIcon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="75" height="75" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open"><path d="M12 7v14"/><path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"/></svg>`;
      emptyContainer.createEl("p", { text: "No articles saved yet." });
      return;
    }
    for (const file of clippedFiles) {
      const content = await this.app.vault.read(file);
      const clippedEl = container.createEl("div", { cls: "netClip_card" });
      const thumbnailMatch = content.match(/!\[Thumbnail\]\((.+)\)/);
      const imageUrl = thumbnailMatch ? thumbnailMatch[1] : "https://cdn.pixabay.com/photo/2023/12/14/06/45/chicken-8448262_1280.jpg";
      clippedEl.createEl("img", { attr: { src: imageUrl } });
      const clippedTitle = clippedEl.createEl("h6", { text: file.basename });
      clippedTitle.addEventListener("click", () => {
        this.openArticle(file);
      });
      const bottomContent = clippedEl.createEl("div", { cls: "netclip_card_bottom" });
      const urlMatch = content.match(/source: "([^"]+)"/);
      if (urlMatch) {
        const articleUrl = urlMatch[1];
        const domainName = getDomain(articleUrl);
        bottomContent.createEl("a", {
          cls: "domain",
          href: articleUrl,
          text: domainName
        });
      } else {
        bottomContent.createEl("span", {
          cls: "domain",
          text: "Unknown Source"
        });
      }
      this.createMenuButton(bottomContent, file, urlMatch == null ? void 0 : urlMatch[1]);
      container.appendChild(clippedEl);
    }
  }
  createMenuButton(bottomContent, file, url) {
    const menuButton = bottomContent.createEl("span", { cls: "menu-button" });
    menuButton.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#fff" viewBox="0 0 256 256">
                <path d="M140,128a12,12,0,1,1-12-12A12,12,0,0,1,140,128ZM128,72a12,12,0,1,0-12-12A12,12,0,0,0,128,72Zm0,112a12,12,0,1,0,12,12A12,12,0,0,0,128,184Z"></path>
            </svg>`;
    menuButton.addEventListener("click", (event) => {
      event.preventDefault();
      event.stopPropagation();
      const contextMenu = new ClipperContextMenu(
        this.app,
        file,
        this.showDeleteConfirmation.bind(this),
        this.openArticle.bind(this),
        url
      );
      contextMenu.show(menuButton);
    });
  }
  showDeleteConfirmation(file) {
    const modal = new DeleteConfirmationModal(
      this.app,
      file,
      async () => {
        await this.app.vault.delete(file);
        const savedContainer = this.containerEl.querySelector(".netclip_saved_container");
        await this.renderSavedContent(savedContainer);
      }
    );
    modal.open();
  }
  openArticle(file) {
    const openLeaves = this.app.workspace.getLeavesOfType("markdown");
    const targetLeaf = openLeaves.find((leaf) => {
      var _a;
      const viewState = leaf.getViewState();
      return viewState.type === "markdown" && ((_a = viewState.state) == null ? void 0 : _a.file) === file.path;
    });
    if (targetLeaf) {
      this.app.workspace.revealLeaf(targetLeaf);
    } else {
      this.app.workspace.openLinkText(file.path, "", true);
    }
  }
};

// src/settings.ts
var import_obsidian8 = require("obsidian");
var DEFAULT_SETTINGS2 = {
  viewPosition: "default",
  defaultFolderName: "Saved Articles",
  defaultWebUrl: "https://google.com",
  modalWidth: "80vw",
  modalHeight: "80vh",
  searchEngine: "google"
};
var NetClipSettingTab = class extends import_obsidian8.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
    this.id = "net-clip-settings";
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "NetClip Settings" });
    new import_obsidian8.Setting(containerEl).setName("View Position").setDesc("Choose where the Web Clipper view should appear").addDropdown(
      (dropdown) => dropdown.addOption("left", "Left Sidebar").addOption("right", "Right Sidebar").addOption("default", "Default Position").setValue(this.plugin.settings.viewPosition).onChange(async (value) => {
        this.plugin.settings.viewPosition = value;
        await this.plugin.saveSettings();
        const leaves = this.app.workspace.getLeavesOfType(CLIPPER_VIEW);
        if (leaves.length > 0) {
          const activeLeaf = leaves[0];
          activeLeaf.detach();
          this.plugin.activateView();
        }
      })
    );
    new import_obsidian8.Setting(containerEl).setName("Default Folder Name").setDesc("Set the default folder where clipped articles are saved").addText(
      (text) => text.setPlaceholder("Enter folder name").setValue(this.plugin.settings.defaultFolderName).onChange(async (value) => {
        if (value.trim() === "") {
          new import_obsidian8.Notice("Folder name cannot be empty.");
          return;
        }
        this.plugin.settings.defaultFolderName = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian8.Setting(containerEl).setName("Modal Height").setDesc("Set the default height for the web modal (use CSS units like vh, %, px)").addText((text) => text.setPlaceholder("80vh").setValue(this.plugin.settings.modalHeight).onChange(async (value) => {
      this.plugin.settings.modalHeight = value || "80vh";
      await this.plugin.saveSettings();
    }));
    new import_obsidian8.Setting(containerEl).setName("Modal Width").setDesc("Set the default height for the web modal (use CSS units like vh, %, px)").addText((text) => text.setPlaceholder("80vh").setValue(this.plugin.settings.modalWidth).onChange(async (value) => {
      this.plugin.settings.modalWidth = value || "80vh";
      await this.plugin.saveSettings();
    }));
    new import_obsidian8.Setting(containerEl).setName("Search Engine").setDesc("Choose the default search engine for search queries").addDropdown(
      (dropdown) => dropdown.addOption("google", "Google").addOption("youtube", "YouTube").addOption("bing", "Bing").addOption("perplexity", "Perplexity").addOption("duckduckgo", "Duckduckgo").addOption("genspark", "Genspark").addOption("kagi", "Kagi").setValue(this.plugin.settings.searchEngine).onChange(async (value) => {
        console.log("Selected Search Engine:", value);
        this.plugin.settings.searchEngine = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian8.Setting(containerEl).setName("Default Web Modal URL").setDesc("Set the default URL opened when using the web modal/editor").addText(
      (text) => text.setPlaceholder("Enter default URL").setValue(this.plugin.settings.defaultWebUrl).onChange(async (value) => {
        try {
          new URL(value);
          this.plugin.settings.defaultWebUrl = value;
          await this.plugin.saveSettings();
        } catch (e) {
          new import_obsidian8.Notice("Invalid URL. Please enter a valid URL.");
        }
      })
    );
  }
};

// src/helper.ts
var ProcessNodeHelper = class {
  constructor(plugin) {
    this.recentLinks = /* @__PURE__ */ new Set();
    this.seenImages = /* @__PURE__ */ new Set();
    this.firstImageProcessed = false;
    this.plugin = plugin;
  }
  resetProcessingFlags() {
    this.firstImageProcessed = false;
    this.seenImages.clear();
    this.recentLinks.clear();
  }
  processNode(node, baseUrl) {
    var _a;
    if (node.nodeType === Node.TEXT_NODE) {
      return (node.textContent || "").trim();
    }
    if (!(node instanceof HTMLElement)) {
      return "";
    }
    let content = "";
    const element = node;
    switch (element.tagName) {
      case "BLOCKQUOTE": {
        const quoteContent = Array.from(element.childNodes).map((child) => this.processNode(child, baseUrl)).join("").trim();
        if (quoteContent) {
          content += `> ${quoteContent.replace(/\n/g, "\n> ")}

`;
        }
        break;
      }
      case "A": {
        const href = element.getAttribute("href");
        const text = ((_a = element.textContent) == null ? void 0 : _a.trim()) || "";
        if (href && text) {
          const previousTextNode = element.previousSibling;
          const nextTextNode = element.nextSibling;
          const prefixSpace = this.shouldAddSpace(previousTextNode);
          const suffixSpace = this.shouldAddSpace(nextTextNode);
          const absoluteLink = this.resolveUrl(baseUrl, href);
          if (!this.isRepeatedLink(text, absoluteLink)) {
            content += `${prefixSpace}[${text}](${absoluteLink})${suffixSpace}`;
          }
        }
        break;
      }
      case "STRONG": {
        content += `**${Array.from(element.childNodes).map((child) => this.processNode(child, baseUrl)).join("")}**`;
        break;
      }
      case "EM": {
        content += `*${Array.from(element.childNodes).map((child) => this.processNode(child, baseUrl)).join("")}*`;
        break;
      }
      case "H1": {
        content += `# ${Array.from(element.childNodes).map((child) => this.processNode(child, baseUrl)).join("")}

`;
        break;
      }
      case "H2": {
        content += `## ${Array.from(element.childNodes).map((child) => this.processNode(child, baseUrl)).join("")}

`;
        break;
      }
      case "H3": {
        content += `### ${Array.from(element.childNodes).map((child) => this.processNode(child, baseUrl)).join("")}

`;
        break;
      }
      case "H4": {
        content += `#### ${Array.from(element.childNodes).map((child) => this.processNode(child, baseUrl)).join("")}

`;
        break;
      }
      case "H5": {
        content += `##### ${Array.from(element.childNodes).map((child) => this.processNode(child, baseUrl)).join("")}

`;
        break;
      }
      case "H6": {
        content += `###### ${Array.from(element.childNodes).map((child) => this.processNode(child, baseUrl)).join("")}

`;
        break;
      }
      case "TABLE": {
        content += this.processTableElement(element);
        break;
      }
      case "UL": {
        content += Array.from(element.childNodes).map((child) => this.processNode(child, baseUrl)).filter((item) => item.trim()).map((item) => `- ${item.trim()}`).join("\n") + "\n\n";
        break;
      }
      case "OL": {
        content += Array.from(element.childNodes).map((child) => this.processNode(child, baseUrl)).filter((item) => item.trim()).map((item) => `- ${item.trim()}`).join("\n") + "\n\n";
        break;
      }
      case "P": {
        content += Array.from(element.childNodes).map((child) => this.processNode(child, baseUrl)).join("") + "\n\n";
        break;
      }
      case "BR": {
        content += "\n";
        break;
      }
      case "HR": {
        content += "---\n\n";
        break;
      }
      case "IMG": {
        const imgSrc = this.resolveImageSrc(node, baseUrl);
        if (imgSrc) {
          const altText = node.getAttribute("alt") || "Image";
          if (node.closest('.heading,[class*="thumbnailImage"]') || altText.toLowerCase() === "heading") {
            break;
          }
          if (!this.firstImageProcessed) {
            this.firstImageProcessed = true;
            break;
          }
          if (!this.seenImages.has(imgSrc)) {
            content += `![${altText}](${imgSrc})

`;
            this.seenImages.add(imgSrc);
          }
        }
        break;
      }
      case "FIGCAPTION": {
        content += `*${Array.from(element.childNodes).map((child) => this.processNode(child, baseUrl)).join("")}*

`;
        break;
      }
      case "IFRAME": {
        const iframeSrc = element.getAttribute("src");
        const iframeTitle = element.getAttribute("title") || "Embedded Video/Content";
        if (iframeSrc) {
          content += `<iframe src="${iframeSrc}" title="${iframeTitle}"></iframe>

`;
        }
        break;
      }
      case "CODE": {
        const codeContent = element.textContent || "";
        content += `\`\`\`
${codeContent.trim()}
\`\`\`

`;
        break;
      }
      case "PRE": {
        const preContent = Array.from(element.childNodes).map((child) => this.processNode(child, baseUrl)).join("");
        content += `\`\`\`
${preContent.trim()}
\`\`\`

`;
        break;
      }
      default: {
        content += Array.from(element.childNodes).map((child) => this.processNode(child, baseUrl)).join("");
        break;
      }
    }
    return content;
  }
  shouldAddSpace(node) {
    var _a;
    if (!node)
      return "";
    if (node.nodeType === Node.TEXT_NODE) {
      const text = ((_a = node.textContent) == null ? void 0 : _a.trim()) || "";
      return text && !text.endsWith(" ") ? " " : "";
    }
    return "";
  }
  isRepeatedLink(text, link) {
    const linkKey = `${text}:${link}`;
    if (this.recentLinks.has(linkKey)) {
      return true;
    }
    this.recentLinks.add(linkKey);
    if (this.recentLinks.size > 10) {
      const oldestLink = this.recentLinks.values().next().value;
      this.recentLinks.delete(oldestLink);
    }
    return false;
  }
  resolveImageSrc(img, baseUrl) {
    const possibleSrcAttributes = [
      "data-src",
      "src",
      "data-original",
      "data-lazy",
      "data-fallback-src",
      "srcset"
    ];
    for (const attr of possibleSrcAttributes) {
      let src = img.getAttribute(attr);
      if (attr === "data-src" && !src) {
        src = img.getAttribute("src");
      }
      if (attr === "srcset" && src) {
        src = src.split(",")[0].trim().split(" ")[0];
      }
      if (src) {
        if (src.startsWith("data:") || src.startsWith("http")) {
          return src;
        }
        return this.resolveUrl(baseUrl, src);
      }
    }
    return "";
  }
  processTableElement(tableElement) {
    let tableContent = "\n\n";
    const thead = tableElement.querySelector("thead");
    const tbody = tableElement.querySelector("tbody");
    if (thead) {
      const headerRows = thead.querySelectorAll("tr");
      headerRows.forEach((row) => {
        const headerCells = Array.from(row.querySelectorAll("th,td"));
        const headerContent = headerCells.map((cell) => {
          var _a;
          return ((_a = cell.textContent) == null ? void 0 : _a.trim().replace(/\|/g, "\\|")) || "";
        }).join("|");
        const headerSeparator = headerCells.map(() => "---").join("|");
        tableContent += `${headerContent}
${headerSeparator}
`;
      });
    }
    const bodyRows = tbody ? tbody.querySelectorAll("tr") : tableElement.querySelectorAll("tr");
    bodyRows.forEach((row, index) => {
      if (thead && index < thead.querySelectorAll("tr").length)
        return;
      const cells = Array.from(row.querySelectorAll("th,td"));
      const rowContent = cells.map((cell) => {
        var _a;
        return ((_a = cell.textContent) == null ? void 0 : _a.trim().replace(/\|/g, "\\|")) || "";
      }).join("|");
      tableContent += `${rowContent}
`;
    });
    tableContent += "\n";
    return tableContent;
  }
  resolveUrl(base, relative) {
    try {
      return new URL(relative, base).toString();
    } catch (e) {
      return relative;
    }
  }
};

// src/extractors.ts
var ContentExtractors = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.processNodeHelper = new ProcessNodeHelper(plugin);
  }
  extractMainContent(doc, baseUrl) {
    this.processNodeHelper.resetProcessingFlags();
    const mainSelectors = [
      "main",
      "article",
      ".main-content",
      "#main-content",
      ".entry-content",
      "#productDescription",
      "#feature-bullets",
      ".markdown",
      '[class*="blog"]',
      "#centerCol",
      ".a-section.a-spacing-none",
      ".Blog",
      '[class*="blog"]'
    ];
    let mainContent = this.findMainContentElement(doc, mainSelectors);
    this.removeUnnecessaryElements(mainContent);
    return this.processNodeHelper.processNode(mainContent, baseUrl).replace(/\n{5,}/g, "\n\n").trim();
  }
  findMainContentElement(doc, selectors) {
    for (const selector of selectors) {
      const content = doc.querySelector(selector);
      if (content)
        return content;
    }
    return doc.body;
  }
  removeUnnecessaryElements(mainContent) {
    mainContent.querySelectorAll("*").forEach((el) => {
      if (el.className && /\brelated\b/i.test(el.className)) {
        el.remove();
      }
    });
    const elementsToRemove = [
      "script",
      "style",
      "svg",
      "nav",
      "footer",
      "header",
      "aside",
      '[class*="footer"]',
      '[class*="nav"]',
      '[class*="sidebar"]',
      '[class*="sticky"]',
      ".ad-container",
      ".advertisement",
      ".cookie-consent",
      ".menu",
      '[class*="menu"]',
      ".tags",
      '[class*="tags"]',
      '[class*="popup"]',
      '[class*="related"]',
      ".related",
      '[class*="header"]',
      '[class*="newsletter"]',
      '[class*="form"]',
      '[aria-label="Navigation"]',
      '[class*="share"]',
      '[class*="author"]',
      ".read-next",
      '[class*="read-next"]',
      '[data-module="newsletter"]',
      '[data-component="navigation"]',
      '[class*="icon"]',
      ".flex-col"
    ].join(",");
    const preservedTags = [
      "main",
      "article",
      '[class*="article"]',
      '[class*="main"]',
      ".article",
      "p",
      "img",
      "ul",
      "ol",
      '[class*="blog"]',
      ".entry-content",
      ".Blog",
      "header"
    ];
    mainContent.querySelectorAll(elementsToRemove).forEach((el) => {
      const tagName = el.tagName.toLowerCase();
      if (!preservedTags.includes(tagName)) {
        el.remove();
      }
    });
  }
  extractDescription(doc) {
    var _a, _b;
    const metaDescription = (_a = doc.querySelector('meta[name="description"]')) == null ? void 0 : _a.getAttribute("content");
    const ogDescription = (_b = doc.querySelector('meta[property="og:description"]')) == null ? void 0 : _b.getAttribute("content");
    const description = metaDescription || ogDescription;
    return description ? description.replace(/[<>#"]/g, "").trim() : null;
  }
  extractThumbnail(doc) {
    const ogImageTag = doc.querySelector('meta[property="og:image"]');
    const amazonImage = doc.querySelector(".a-dynamic-image");
    const ogImage = ogImageTag == null ? void 0 : ogImageTag.getAttribute("content");
    const amazonImageSrc = amazonImage == null ? void 0 : amazonImage.getAttribute("src");
    return ogImage || amazonImageSrc || "";
  }
  extractPublishTime(doc) {
    var _a;
    const publishDate = (_a = doc.querySelector('meta[property="article:published_time"]')) == null ? void 0 : _a.getAttribute("content");
    return publishDate || "";
  }
  extractAuthor(doc) {
    var _a, _b, _c;
    const authorMeta = (_a = doc.querySelector('meta[name="author"]')) == null ? void 0 : _a.getAttribute("content");
    const authorElement = Array.from(
      doc.querySelectorAll('[class*="Author"],[class*="author"],[id*="Author"],[id*="author"]')
    ).find((el) => {
      var _a2;
      return (_a2 = el.textContent) == null ? void 0 : _a2.trim();
    });
    const byline = (_b = authorElement == null ? void 0 : authorElement.textContent) == null ? void 0 : _b.trim();
    const possibleOrg = (_c = doc.querySelector('meta[name="publisher"],meta[property="og:site_name"]')) == null ? void 0 : _c.getAttribute("content");
    return authorMeta || byline || possibleOrg || "";
  }
  extractPrice(doc) {
    var _a;
    const priceSelectors = [
      ".price",
      'meta[itemprop="price"]',
      ".current-price",
      ".x-price-primary",
      ".priceToPay",
      ".a-price"
    ];
    for (const selector of priceSelectors) {
      const priceElement = doc.querySelector(selector);
      if (priceElement) {
        return ((_a = priceElement.textContent) == null ? void 0 : _a.trim()) || null;
      }
    }
    return null;
  }
  extractBrand(doc) {
    var _a;
    const brandSelectors = ["#bylineInfo"];
    for (const selector of brandSelectors) {
      const brandElement = doc.querySelector(selector);
      if (brandElement) {
        const brandText = ((_a = brandElement.textContent) == null ? void 0 : _a.trim()) || "";
        const brandLinkElement = brandElement.querySelector("a");
        const brandLink = brandLinkElement == null ? void 0 : brandLinkElement.getAttribute("href");
        if (brandLink) {
          const absoluteBrandLink = this.resolveUrl(brandLink, window.location.href);
          return `[${brandText}](${absoluteBrandLink})`;
        }
        return brandText;
      }
    }
    return null;
  }
  extractRating(doc) {
    var _a;
    const ratingSelectors = [
      "#acrPopover",
      'meta[itemprop="rating"]',
      'meta[itemprop="review"]',
      ".average-rating",
      ".star-rating",
      '[class*="rating"]'
    ];
    let ratingText = null;
    for (const selector of ratingSelectors) {
      const ratingElement = doc.querySelector(selector);
      if (ratingElement) {
        const text = (_a = ratingElement.textContent) == null ? void 0 : _a.trim();
        if (text) {
          ratingText = text;
          break;
        }
      }
    }
    if (!ratingText) {
      const starIcons = Array.from(doc.querySelectorAll("span, div")).find(
        (el) => {
          var _a2;
          return (_a2 = el.textContent) == null ? void 0 : _a2.trim().match(/^★+$/);
        }
      );
      if (starIcons) {
        const starCount = starIcons.textContent.length;
        ratingText = `${starCount} out of 5 stars`;
      }
    }
    if (ratingText) {
      const numericMatch = ratingText.match(/(\d+(\.\d+)?)\s*out\s*of\s*5/i);
      if (numericMatch) {
        const numericRating = parseFloat(numericMatch[1]);
        const roundedStars = Math.round(numericRating);
        const stars = "\u2605".repeat(roundedStars) + "\u2606".repeat(5 - roundedStars);
        return `${numericRating} out of 5 stars (${stars})`;
      }
      const starMatch = ratingText.match(/★+/);
      if (starMatch) {
        const starRating = starMatch[0].length;
        const stars = "\u2605".repeat(starRating) + "\u2606".repeat(5 - starRating);
        return `${starRating} out of 5 stars (${stars})`;
      }
    }
    return null;
  }
  resolveUrl(base, relative) {
    try {
      return new URL(relative, base).toString();
    } catch (e) {
      return relative;
    }
  }
};

// src/main.ts
var NetClipPlugin = class extends import_obsidian9.Plugin {
  constructor() {
    super(...arguments);
    this.ClipperView = null;
    this.seenItems = /* @__PURE__ */ new Set();
    this.seenImages = /* @__PURE__ */ new Set();
  }
  isNewContent(content) {
    if (this.seenItems.has(content)) {
      return false;
    }
    this.seenItems.add(content);
    return true;
  }
  processContent(content) {
    const lines = content.split("\n");
    const uniqueLines = lines.filter((line) => this.isNewContent(line.trim()));
    return uniqueLines.join("\n");
  }
  async onload() {
    await this.loadSettings();
    this.contentExtractors = new ContentExtractors(this);
    this.addRibbonIcon("newspaper", "NetClip", async () => {
      await this.activateView();
    });
    this.addCommand({
      id: "open-net-clip",
      name: "OpenNetClip",
      callback: () => {
        this.activateView();
      }
    });
    this.addCommand({
      id: "open-workspace-webview",
      name: "Open Web View on Workspace",
      callback: async () => {
        const leaf = this.app.workspace.getLeaf(true);
        await leaf.setViewState({
          type: VIEW_TYPE_WORKSPACE_WEBVIEW,
          active: true
        });
        this.app.workspace.revealLeaf(leaf);
      },
      hotkeys: [{ modifiers: ["Ctrl", "Alt"], key: "x" }]
    });
    this.addCommand({
      id: "open-web-modal",
      name: "Open Web view on Modal",
      checkCallback: (checking) => {
        if (checking) {
          return true;
        }
        const defaultUrl = this.settings.defaultWebUrl || "https://google.com";
        new WebViewModal(this.app, defaultUrl, void 0, this).open();
      },
      hotkeys: [{ modifiers: ["Ctrl", "Alt"], key: "z" }]
    });
    this.registerView(CLIPPER_VIEW, (leaf) => {
      this.ClipperView = new clipperHomeView(leaf, this);
      return this.ClipperView;
    });
    this.registerView(
      VIEW_TYPE_WORKSPACE_WEBVIEW,
      (leaf) => new WorkspaceLeafWebView(leaf, this)
    );
    this.addSettingTab(new NetClipSettingTab(this.app, this));
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS2, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf = null;
    const leaves = workspace.getLeavesOfType(CLIPPER_VIEW);
    if (leaves.length > 0) {
      leaf = leaves[0];
    } else {
      switch (this.settings.viewPosition) {
        case "left":
          leaf = workspace.getLeftLeaf(false);
          break;
        case "right":
          leaf = workspace.getRightLeaf(false);
          break;
        default:
          leaf = workspace.getLeaf(false);
      }
    }
    if (leaf) {
      await leaf.setViewState({
        type: CLIPPER_VIEW,
        active: true
      });
      workspace.revealLeaf(leaf);
    }
  }
  async clipWebpage(url) {
    var _a;
    if (!this.contentExtractors) {
      return;
    }
    new import_obsidian9.Notice("Clipping...");
    const folderPath = this.settings.defaultFolderName;
    const folderExists = this.app.vault.getAbstractFileByPath(folderPath);
    if (!folderExists) {
      await this.app.vault.createFolder(folderPath);
    }
    const normalizedUrl = normalizeUrl(url);
    if (!normalizedUrl) {
      throw new Error("Invalid URL provided");
    }
    const response = await (0, import_obsidian9.requestUrl)(normalizedUrl);
    const html = response.text;
    const parser = new DOMParser();
    const doc = parser.parseFromString(html, "text/html");
    let title = ((_a = doc.querySelector("title")) == null ? void 0 : _a.textContent) || "";
    if (!title) {
      const headingElement = doc.querySelector("h1") || doc.querySelector(".title");
      if (headingElement && headingElement.textContent) {
        title = headingElement.textContent.trim();
      }
    }
    if (!title) {
      title = `Article from ${getDomain(url)}`;
    }
    title = title.replace(/[#"]/g, "").trim();
    const content = this.contentExtractors.extractMainContent(doc, normalizedUrl);
    const thumbnailUrl = this.contentExtractors.extractThumbnail(doc);
    const author = this.contentExtractors.extractAuthor(doc);
    const desc = this.contentExtractors.extractDescription(doc);
    const publishTime = this.contentExtractors.extractPublishTime(doc);
    const price = this.contentExtractors.extractPrice(doc);
    const brand = this.contentExtractors.extractBrand(doc);
    const rating = this.contentExtractors.extractRating(doc);
    const wordCount = content.split(/\s+/).length;
    const minReadTime = Math.floor(wordCount / 250);
    const maxReadTime = Math.ceil(wordCount / 200);
    const readingTime = minReadTime === maxReadTime ? `${minReadTime}` : `${minReadTime}~${maxReadTime}`;
    const fileName = sanitizePath(`${title}.md`);
    const filePath = `${folderPath}/${fileName}`;
    await this.app.vault.create(
      filePath,
      `---
title: "${title}"
source: "${url}"
` + (publishTime ? `published: ${publishTime}
` : "") + (author ? `author: "${author}"
` : "") + (desc ? `desc: "${desc}"
` : "") + (readingTime ? `readingTime: "${readingTime}min"
` : "") + (price ? `price: "${price}"
` : "") + (brand ? `brand: "${brand}"
` : "") + (rating ? `brand: "${rating}"
` : "") + `---

` + (thumbnailUrl ? `![Thumbnail](${thumbnailUrl})

` : "") + `${content}`
    );
    await this.updateHomeView();
    new import_obsidian9.Notice(`Successfully clipped ${title}`);
  }
  async updateHomeView() {
    if (this.ClipperView) {
      const container = this.ClipperView.containerEl.querySelector(".netclip_saved_container");
      if (container instanceof HTMLDivElement) {
        await this.ClipperView.renderSavedContent(container);
      }
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3ZpZXcvQ2xpcHBlclZpZXcudHMiLCAic3JjL3V0aWxzLnRzIiwgInNyYy9kZWxldGVNb2RhbC50cyIsICJzcmMvY29udGV4dE1lbnUudHMiLCAic3JjL3ZpZXcvTW9kYWxXZWJWaWV3LnRzIiwgInNyYy93ZWJWaWV3Q29tcG9uZW50LnRzIiwgInNyYy9zZWFyY2gvc2VhcmNoVXJscy50cyIsICJzcmMvc2VhcmNoL2ZldGNoU3VnZ2VzdGlvbnMudHMiLCAic3JjL3NlYXJjaC9zZWFyY2gudHMiLCAic3JjL3ZpZXcvRWRpdG9yV2ViVmlldy50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL2hlbHBlci50cyIsICJzcmMvZXh0cmFjdG9ycy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHtOb3RpY2UsIFBsdWdpbiwgcmVxdWVzdFVybCwgV29ya3NwYWNlTGVhZn0gZnJvbSAnb2JzaWRpYW4nXHJcbmltcG9ydCB7Q0xJUFBFUl9WSUVXLCBjbGlwcGVySG9tZVZpZXcgfSBmcm9tICcuL3ZpZXcvQ2xpcHBlclZpZXcnXHJcbmltcG9ydCB7REVGQVVMVF9TRVRUSU5HUywgTmV0Q2xpcFNldHRpbmdUYWJ9IGZyb20gJy4vc2V0dGluZ3MnXHJcbmltcG9ydCB7IHNhbml0aXplUGF0aCwgZ2V0RG9tYWluLCBub3JtYWxpemVVcmwgfSBmcm9tICcuL3V0aWxzJ1xyXG5pbXBvcnQgeyBDb250ZW50RXh0cmFjdG9ycyB9IGZyb20gJy4vZXh0cmFjdG9ycydcclxuaW1wb3J0IHsgVklFV19UWVBFX1dPUktTUEFDRV9XRUJWSUVXLCBXb3Jrc3BhY2VMZWFmV2ViVmlldyB9IGZyb20gJy4vdmlldy9FZGl0b3JXZWJWaWV3J1xyXG5pbXBvcnQgeyBXZWJWaWV3TW9kYWwgfSBmcm9tICcuL3ZpZXcvTW9kYWxXZWJWaWV3J1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTmV0Q2xpcFBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcbiAgcHJpdmF0ZSBDbGlwcGVyVmlldzogY2xpcHBlckhvbWVWaWV3IHwgbnVsbCA9IG51bGw7XHJcbiAgc2V0dGluZ3M6IE5ldENsaXBTZXR0aW5nVGFiO1xyXG4gIGNvbnRlbnRFeHRyYWN0b3JzOiBDb250ZW50RXh0cmFjdG9yczsgXHJcbiAgc2Vlbkl0ZW1zOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoKTtcclxuICBwcml2YXRlIHNlZW5JbWFnZXM6IFNldDxzdHJpbmc+ID0gbmV3IFNldCgpO1xyXG5cclxuICBpc05ld0NvbnRlbnQoY29udGVudDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICBpZiAodGhpcy5zZWVuSXRlbXMuaGFzKGNvbnRlbnQpKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHRoaXMuc2Vlbkl0ZW1zLmFkZChjb250ZW50KTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbiAgcHJvY2Vzc0NvbnRlbnQoY29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XHJcbiAgICBjb25zdCB1bmlxdWVMaW5lcyA9IGxpbmVzLmZpbHRlcihsaW5lID0+IHRoaXMuaXNOZXdDb250ZW50KGxpbmUudHJpbSgpKSk7XHJcbiAgICByZXR1cm4gdW5pcXVlTGluZXMuam9pbignXFxuJyk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBvbmxvYWQoKSB7XHJcbiAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xyXG4gICAgXHJcbiAgICBcclxuXHJcbiAgICB0aGlzLmNvbnRlbnRFeHRyYWN0b3JzID0gbmV3IENvbnRlbnRFeHRyYWN0b3JzKHRoaXMpO1xyXG4gICAgdGhpcy5hZGRSaWJib25JY29uKCduZXdzcGFwZXInLCAnTmV0Q2xpcCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgYXdhaXQgdGhpcy5hY3RpdmF0ZVZpZXcoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgIGlkOiAnb3Blbi1uZXQtY2xpcCcsXHJcbiAgICAgIG5hbWU6ICdPcGVuTmV0Q2xpcCcsXHJcbiAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5hY3RpdmF0ZVZpZXcoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgXHJcbiAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICBpZDogJ29wZW4td29ya3NwYWNlLXdlYnZpZXcnLFxyXG4gICAgICBuYW1lOiAnT3BlbiBXZWIgVmlldyBvbiBXb3Jrc3BhY2UnLFxyXG4gICAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZih0cnVlKTtcclxuICAgICAgICBhd2FpdCBsZWFmLnNldFZpZXdTdGF0ZSh7XHJcbiAgICAgICAgICB0eXBlOiBWSUVXX1RZUEVfV09SS1NQQUNFX1dFQlZJRVcsXHJcbiAgICAgICAgICBhY3RpdmU6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UucmV2ZWFsTGVhZihsZWFmKTtcclxuICAgICAgfSxcclxuICAgICAgaG90a2V5czogW3sgbW9kaWZpZXJzOiBbJ0N0cmwnLCAnQWx0J10sIGtleTogJ3gnIH1dLFxyXG4gICAgfSk7XHJcblxyXG4gICAgXHJcbiAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICBpZDogJ29wZW4td2ViLW1vZGFsJyxcclxuICAgICAgbmFtZTogJ09wZW4gV2ViIHZpZXcgb24gTW9kYWwnLFxyXG4gICAgICBjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmcpID0+IHtcclxuICAgICAgICBpZiAoY2hlY2tpbmcpIHtcclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBkZWZhdWx0VXJsID0gdGhpcy5zZXR0aW5ncy5kZWZhdWx0V2ViVXJsIHx8ICdodHRwczovL2dvb2dsZS5jb20nO1xyXG4gICAgICAgIG5ldyBXZWJWaWV3TW9kYWwodGhpcy5hcHAsIGRlZmF1bHRVcmwsIHVuZGVmaW5lZCwgdGhpcykub3BlbigpO1xyXG4gICAgICB9LFxyXG4gICAgICBob3RrZXlzOiBbeyBtb2RpZmllcnM6IFsnQ3RybCcsICdBbHQnXSwga2V5OiAneicgfV1cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICBcclxuICAgIHRoaXMucmVnaXN0ZXJWaWV3KENMSVBQRVJfVklFVywgKGxlYWYpID0+IHtcclxuICAgICAgdGhpcy5DbGlwcGVyVmlldyA9IG5ldyBjbGlwcGVySG9tZVZpZXcobGVhZiwgdGhpcyk7XHJcbiAgICAgIHJldHVybiB0aGlzLkNsaXBwZXJWaWV3O1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHRoaXMucmVnaXN0ZXJWaWV3KFZJRVdfVFlQRV9XT1JLU1BBQ0VfV0VCVklFVywgKGxlYWYpID0+IFxyXG4gICAgICBuZXcgV29ya3NwYWNlTGVhZldlYlZpZXcobGVhZiwgdGhpcylcclxuICAgICk7XHJcbiAgICBcclxuXHJcbiAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IE5ldENsaXBTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcbiAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcclxuICAgIFxyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xyXG4gICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcclxuICB9XHJcblxyXG5cclxuXHJcblxyXG5cclxuICBhc3luYyBhY3RpdmF0ZVZpZXcoKSB7XHJcbiAgICBjb25zdCB7IHdvcmtzcGFjZSB9ID0gdGhpcy5hcHA7XHJcbiAgICBsZXQgbGVhZjogV29ya3NwYWNlTGVhZiB8IG51bGwgPSBudWxsO1xyXG4gICAgY29uc3QgbGVhdmVzID0gd29ya3NwYWNlLmdldExlYXZlc09mVHlwZShDTElQUEVSX1ZJRVcpO1xyXG5cclxuICAgIGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICBsZWFmID0gbGVhdmVzWzBdO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc3dpdGNoICh0aGlzLnNldHRpbmdzLnZpZXdQb3NpdGlvbikge1xyXG4gICAgICAgIGNhc2UgJ2xlZnQnOlxyXG4gICAgICAgICAgbGVhZiA9IHdvcmtzcGFjZS5nZXRMZWZ0TGVhZihmYWxzZSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdyaWdodCc6XHJcbiAgICAgICAgICBsZWFmID0gd29ya3NwYWNlLmdldFJpZ2h0TGVhZihmYWxzZSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgbGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmKGZhbHNlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChsZWFmKSB7XHJcbiAgICAgIGF3YWl0IGxlYWYuc2V0Vmlld1N0YXRlKHtcclxuICAgICAgICB0eXBlOiBDTElQUEVSX1ZJRVcsXHJcbiAgICAgICAgYWN0aXZlOiB0cnVlLFxyXG4gICAgICB9KTtcclxuICAgICAgd29ya3NwYWNlLnJldmVhbExlYWYobGVhZik7XHJcbiAgICB9IFxyXG4gIH1cclxuXHJcbiAgYXN5bmMgY2xpcFdlYnBhZ2UodXJsOiBzdHJpbmcpIHtcclxuICAgIGlmICghdGhpcy5jb250ZW50RXh0cmFjdG9ycykge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgbmV3IE5vdGljZShcIkNsaXBwaW5nLi4uXCIpO1xyXG5cclxuICAgIGNvbnN0IGZvbGRlclBhdGggPSB0aGlzLnNldHRpbmdzLmRlZmF1bHRGb2xkZXJOYW1lO1xyXG4gICAgY29uc3QgZm9sZGVyRXhpc3RzID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZvbGRlclBhdGgpO1xyXG5cclxuICAgIGlmICghZm9sZGVyRXhpc3RzKSB7XHJcbiAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcihmb2xkZXJQYXRoKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBub3JtYWxpemVkVXJsID0gbm9ybWFsaXplVXJsKHVybCk7XHJcblxyXG4gICAgaWYgKCFub3JtYWxpemVkVXJsKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgVVJMIHByb3ZpZGVkXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybChub3JtYWxpemVkVXJsKTtcclxuICAgIGNvbnN0IGh0bWwgPSByZXNwb25zZS50ZXh0O1xyXG4gICAgY29uc3QgcGFyc2VyID0gbmV3IERPTVBhcnNlcigpO1xyXG4gICAgY29uc3QgZG9jID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhodG1sLCBcInRleHQvaHRtbFwiKTtcclxuICAgIFxyXG4gICAgbGV0IHRpdGxlID0gZG9jLnF1ZXJ5U2VsZWN0b3IoJ3RpdGxlJyk/LnRleHRDb250ZW50IHx8ICcnO1xyXG5cclxuICAgIGlmICghdGl0bGUpIHtcclxuICAgICAgY29uc3QgaGVhZGluZ0VsZW1lbnQgPSBkb2MucXVlcnlTZWxlY3RvcignaDEnKSB8fCBkb2MucXVlcnlTZWxlY3RvcignLnRpdGxlJyk7XHJcbiAgICAgIGlmIChoZWFkaW5nRWxlbWVudCAmJiBoZWFkaW5nRWxlbWVudC50ZXh0Q29udGVudCkge1xyXG4gICAgICAgIHRpdGxlID0gaGVhZGluZ0VsZW1lbnQudGV4dENvbnRlbnQudHJpbSgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCF0aXRsZSkge1xyXG4gICAgICB0aXRsZSA9IGBBcnRpY2xlIGZyb20gJHtnZXREb21haW4odXJsKX1gO1xyXG4gICAgfVxyXG5cclxuICAgIHRpdGxlID0gdGl0bGUucmVwbGFjZSgvWyNcIl0vZywgJycpLnRyaW0oKTtcclxuXHJcblxyXG4gICAgY29uc3QgY29udGVudCA9IHRoaXMuY29udGVudEV4dHJhY3RvcnMuZXh0cmFjdE1haW5Db250ZW50KGRvYywgbm9ybWFsaXplZFVybCk7XHJcbiAgICBjb25zdCB0aHVtYm5haWxVcmwgPSB0aGlzLmNvbnRlbnRFeHRyYWN0b3JzLmV4dHJhY3RUaHVtYm5haWwoZG9jKTtcclxuICAgIGNvbnN0IGF1dGhvciA9IHRoaXMuY29udGVudEV4dHJhY3RvcnMuZXh0cmFjdEF1dGhvcihkb2MpO1xyXG4gICAgY29uc3QgZGVzYyA9IHRoaXMuY29udGVudEV4dHJhY3RvcnMuZXh0cmFjdERlc2NyaXB0aW9uKGRvYyk7XHJcbiAgICBjb25zdCBwdWJsaXNoVGltZSA9IHRoaXMuY29udGVudEV4dHJhY3RvcnMuZXh0cmFjdFB1Ymxpc2hUaW1lKGRvYyk7XHJcbiAgICBjb25zdCBwcmljZSA9IHRoaXMuY29udGVudEV4dHJhY3RvcnMuZXh0cmFjdFByaWNlKGRvYyk7XHJcbiAgICBjb25zdCBicmFuZCA9IHRoaXMuY29udGVudEV4dHJhY3RvcnMuZXh0cmFjdEJyYW5kKGRvYyk7XHJcbiAgICBjb25zdCByYXRpbmcgPSB0aGlzLmNvbnRlbnRFeHRyYWN0b3JzLmV4dHJhY3RSYXRpbmcoZG9jKTtcclxuXHJcbiAgICBjb25zdCB3b3JkQ291bnQgPSBjb250ZW50LnNwbGl0KC9cXHMrLykubGVuZ3RoO1xyXG4gICAgY29uc3QgbWluUmVhZFRpbWUgPSBNYXRoLmZsb29yKHdvcmRDb3VudCAvIDI1MCk7XHJcbiAgICBjb25zdCBtYXhSZWFkVGltZSA9IE1hdGguY2VpbCh3b3JkQ291bnQgLyAyMDApO1xyXG4gICAgY29uc3QgcmVhZGluZ1RpbWUgPSBtaW5SZWFkVGltZSA9PT0gbWF4UmVhZFRpbWVcclxuICAgID9gJHttaW5SZWFkVGltZX1gXHJcbiAgICA6YCR7bWluUmVhZFRpbWV9fiR7bWF4UmVhZFRpbWV9YDtcclxuXHJcblxyXG4gICAgY29uc3QgZmlsZU5hbWUgPSBzYW5pdGl6ZVBhdGgoYCR7dGl0bGV9Lm1kYCk7XHJcbiAgICBjb25zdCBmaWxlUGF0aCA9IGAke2ZvbGRlclBhdGh9LyR7ZmlsZU5hbWV9YDtcclxuXHJcblxyXG4gIFxyXG4gICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKFxyXG4gICAgICBmaWxlUGF0aCxcclxuICAgICAgYC0tLVxcbmAgK1xyXG4gICAgICBgdGl0bGU6IFwiJHt0aXRsZX1cIlxcbmAgK1xyXG4gICAgICBgc291cmNlOiBcIiR7dXJsfVwiXFxuYCArXHJcbiAgICAgIChwdWJsaXNoVGltZSA/IGBwdWJsaXNoZWQ6ICR7cHVibGlzaFRpbWV9XFxuYCA6ICcnKSArIFxyXG4gICAgICAoYXV0aG9yID8gYGF1dGhvcjogXCIke2F1dGhvcn1cIlxcbmAgOiAnJykgK1xyXG4gICAgICAoZGVzYyA/IGBkZXNjOiBcIiR7ZGVzY31cIlxcbmAgOiAnJykgK1xyXG4gICAgICAocmVhZGluZ1RpbWUgPyBgcmVhZGluZ1RpbWU6IFwiJHtyZWFkaW5nVGltZX1taW5cIlxcbmAgOiAnJykgK1xyXG4gICAgICAocHJpY2UgPyBgcHJpY2U6IFwiJHtwcmljZX1cIlxcbmAgOiAnJykgK1xyXG4gICAgICAoYnJhbmQgPyBgYnJhbmQ6IFwiJHticmFuZH1cIlxcbmAgOiAnJykgK1xyXG4gICAgICAocmF0aW5nID8gYGJyYW5kOiBcIiR7cmF0aW5nfVwiXFxuYCA6ICcnKSArXHJcbiAgICAgIGAtLS1cXG5cXG5gICtcclxuICAgICAgKHRodW1ibmFpbFVybCA/IGAhW1RodW1ibmFpbF0oJHt0aHVtYm5haWxVcmx9KVxcblxcbmAgOiAnJykgK1xyXG4gICAgICBgJHtjb250ZW50fWBcclxuICAgICk7XHJcblxyXG4gICAgYXdhaXQgdGhpcy51cGRhdGVIb21lVmlldygpO1xyXG4gICAgbmV3IE5vdGljZShgU3VjY2Vzc2Z1bGx5IGNsaXBwZWQgJHt0aXRsZX1gKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgdXBkYXRlSG9tZVZpZXcoKSB7XHJcbiAgICBpZiAodGhpcy5DbGlwcGVyVmlldykge1xyXG4gICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLkNsaXBwZXJWaWV3LmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIubmV0Y2xpcF9zYXZlZF9jb250YWluZXJcIik7XHJcbiAgICAgIGlmIChjb250YWluZXIgaW5zdGFuY2VvZiBIVE1MRGl2RWxlbWVudCkge1xyXG4gICAgICAgIGF3YWl0IHRoaXMuQ2xpcHBlclZpZXcucmVuZGVyU2F2ZWRDb250ZW50KGNvbnRhaW5lcik7XHJcbiAgICAgICAgXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuICBcclxufVxyXG4iLCAiaW1wb3J0IHsgSXRlbVZpZXcsIFdvcmtzcGFjZUxlYWYsIFRGaWxlLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nXHJcbmltcG9ydCBOZXRDbGlwUGx1Z2luIGZyb20gJy4uL21haW4nXHJcbmltcG9ydCB7IE5ldENsaXBTZXR0aW5nVGFiIH0gZnJvbSAnLi4vc2V0dGluZ3MnXHJcbmltcG9ydCB7IGdldERvbWFpbiwgbm9ybWFsaXplVXJsIH0gZnJvbSAnLi4vdXRpbHMnXHJcbmltcG9ydCB7IERlbGV0ZUNvbmZpcm1hdGlvbk1vZGFsIH0gZnJvbSAnLi4vZGVsZXRlTW9kYWwnXHJcbmltcG9ydCB7IENsaXBwZXJDb250ZXh0TWVudSB9IGZyb20gJy4uL2NvbnRleHRNZW51J1xyXG5pbXBvcnQgeyBWSUVXX1RZUEVfV09SS1NQQUNFX1dFQlZJRVcsIFdvcmtzcGFjZUxlYWZXZWJWaWV3IH0gZnJvbSAnLi9FZGl0b3JXZWJWaWV3J1xyXG5cclxuZXhwb3J0IGNvbnN0IENMSVBQRVJfVklFVyA9ICduZXRDbGlwX2NsaXBwZXJfdmlldyc7XHJcblxyXG5leHBvcnQgY2xhc3MgY2xpcHBlckhvbWVWaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xyXG4gICAgcHJpdmF0ZSBwbHVnaW46IE5ldENsaXBQbHVnaW5cclxuICAgIHByaXZhdGUgc2V0dGluZ3M6IE5ldENsaXBTZXR0aW5nVGFiXHJcbiAgICBpY29uID0gJ25ld3NwYXBlcidcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihsZWFmOiBXb3Jrc3BhY2VMZWFmLCBwbHVnaW46IE5ldENsaXBQbHVnaW4pIHtcclxuICAgICAgICBzdXBlcihsZWFmKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBwbHVnaW4uc2V0dGluZ3M7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Vmlld1R5cGUoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gQ0xJUFBFUl9WSUVXO1xyXG4gICAgfVxyXG5cclxuICAgIGdldERpc3BsYXlUZXh0KCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuICdDbGlwcGVyIFZpZXcnXHJcbiAgICB9XHJcbmFzeW5jIG9uT3BlbigpIHtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbC5jaGlsZHJlblsxXSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGNsaXBwZXJDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ25ldF9jbGlwcGVyX2NvbnRhaW5lcicgfSlcclxuICAgICAgICBjb25zdCBjbGlwcGVySGVhZGVyID0gY2xpcHBlckNvbnRhaW5lci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICduZXRfY2xpcHBlcl9oZWFkZXInIH0pXHJcbiAgICAgICAgY29uc3Qgb3BlbldlYiA9IGNsaXBwZXJIZWFkZXIuY3JlYXRlRWwoJ3NwYW4nLCB7IGNsczogJ25ldG9wZW5fV2ViJyB9KTtcclxuICAgICAgICBjb25zdCBvcGVuU2V0dGluZ3MgPSBjbGlwcGVySGVhZGVyLmNyZWF0ZUVsKCdzcGFuJywge2NsczogJ25ldG9wZW5fc2V0dGluZ3MnfSk7XHJcblxyXG4gICAgICAgIG9wZW5XZWIuaW5uZXJIVE1MID0gYFxyXG4gICAgICAgICA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjI0XCIgaGVpZ2h0PVwiMjRcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIgY2xhc3M9XCJsdWNpZGUgbHVjaWRlLWdsb2JlXCI+XHJcbiAgICAgICAgICAgPGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiLz5cclxuICAgICAgICAgICA8cGF0aCBkPVwiTTEyIDJhMTQuNSAxNC41IDAgMCAwIDAgMjAgMTQuNSAxNC41IDAgMCAwIDAtMjBcIi8+XHJcbiAgICAgICAgICAgPHBhdGggZD1cIk0yIDEyaDIwXCIvPlxyXG4gICAgICAgICA8L3N2Zz5cclxuICAgICAgICAgYFxyXG4gICAgICAgICBvcGVuU2V0dGluZ3MuaW5uZXJIVE1MID0gYFxyXG4gICAgICAgICA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjI0XCIgaGVpZ2h0PVwiMjRcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIgY2xhc3M9XCJsdWNpZGUgbHVjaWRlLWJvbHRcIj5cclxuICAgICAgICAgICA8cGF0aCBkPVwiTTIxIDE2VjhhMiAyIDAgMCAwLTEtMS43M2wtNy00YTIgMiAwIDAgMC0yIDBsLTcgNEEyIDIgMCAwIDAgMyA4djhhMiAyIDAgMCAwIDEgMS43M2w3IDRhMiAyIDAgMCAwIDIgMGw3LTRBMiAyIDAgMCAwIDIxIDE2elwiLz5cclxuICAgICAgICAgICA8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjRcIi8+XHJcbiAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICBgXHJcbiAgICAgICAgIGNvbnN0IGNsaXBJbnB1dENvbnRhaW5lciA9IGNsaXBwZXJDb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHtjbHM6ICduZXRjbGlwX2lucHV0X2NvbnRhaW5lcid9KTtcclxuXHJcbiAgICAgICAgIG9wZW5XZWIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRVcmwgPSB0aGlzLnNldHRpbmdzLmRlZmF1bHRXZWJVcmwgfHwgJ2h0dHBzOi8vZ29vZ2xlLmNvbSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nTGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX1dPUktTUEFDRV9XRUJWSUVXKVxyXG4gICAgICAgICAgICAgICAgLmZpbmQoKGxlYWY6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBsZWFmLnZpZXcgYXMgV29ya3NwYWNlTGVhZldlYlZpZXc7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZpZXcudXJsID09PSBkZWZhdWx0VXJsO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKGV4aXN0aW5nTGVhZikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLnNldEFjdGl2ZUxlYWYoZXhpc3RpbmdMZWFmLCB7IGZvY3VzOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgbGVhZi5zZXRWaWV3U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFZJRVdfVFlQRV9XT1JLU1BBQ0VfV0VCVklFVyxcclxuICAgICAgICAgICAgICAgICAgICBzdGF0ZTogeyB1cmw6IGRlZmF1bHRVcmwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKGxlYWYsIHsgZm9jdXM6IHRydWUgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBvcGVuU2V0dGluZ3MuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmdzLm9wZW4oKTtcclxuICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZ3Mub3BlblRhYkJ5SWQoJ25ldC1jbGlwLXNldHRpbmdzJyk7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgIGNvbnN0IGNsaXBJbnB1dCA9IGNsaXBJbnB1dENvbnRhaW5lci5jcmVhdGVFbCgnaW5wdXQnLCBcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgICBjbHM6ICduZXRfY2xpcF9pbnB1dCcsIFxyXG4gICAgICAgICAgICAgdHlwZTogJ3RleHQnLFxyXG4gICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICdFbnRlciBVUkwgdG8gY2xpcC4uLidcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgY2xpcEJ1dHRvbiA9IGNsaXBJbnB1dENvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywge1xyXG4gICAgICAgIGNsczogJ25ldGNsaXBfYnRuJywgXHJcbiAgICAgICAgdGV4dDogJ0NsaXAnXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNsaXBCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgICAgaWYoY2xpcElucHV0LnZhbHVlKXtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRVcmwgPSBub3JtYWxpemVVcmwoY2xpcElucHV0LnZhbHVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihub3JtYWxpemVkVXJsKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5jbGlwV2VicGFnZShub3JtYWxpemVkVXJsKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2xpcElucHV0LnZhbHVlID0gJydcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBTYXZlZENvbnRlbnRCb3ggPSBjbGlwcGVyQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcIm5ldGNsaXBfc2F2ZWRfY29udGFpbmVyXCJ9KTtcclxuICAgICAgICBhd2FpdCB0aGlzLnJlbmRlclNhdmVkQ29udGVudChTYXZlZENvbnRlbnRCb3gpXHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGFzeW5jIHJlbmRlclNhdmVkQ29udGVudChjb250YWluZXI6IEhUTUxFbGVtZW50KXtcclxuICAgICAgICBjb250YWluZXIuZW1wdHkoKTtcclxuICAgIFxyXG4gICAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xyXG4gICAgICAgIGNvbnN0IGNsaXBwZWRGaWxlcyA9IGZpbGVzLmZpbHRlcihmaWxlID0+IGZpbGUucGF0aC5zdGFydHNXaXRoKHRoaXMuc2V0dGluZ3MuZGVmYXVsdEZvbGRlck5hbWUpKVxyXG4gICAgXHJcbiAgICAgICAgaWYoY2xpcHBlZEZpbGVzLmxlbmd0aCA9PT0gMCl7XHJcbiAgICAgICAgICAgIGNvbnN0IGVtcHR5Q29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2VtcHR5X2JveCcgfSlcclxuICAgICAgICAgICAgY29uc3QgZW1wdHlJY29uID0gZW1wdHlDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgY2xzOiAnZW1wdHlfaWNvbicgfSlcclxuICAgICAgICAgICAgZW1wdHlJY29uLmlubmVySFRNTCA9IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjc1XCIgaGVpZ2h0PVwiNzVcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIxLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIiBjbGFzcz1cImx1Y2lkZSBsdWNpZGUtYm9vay1vcGVuXCI+PHBhdGggZD1cIk0xMiA3djE0XCIvPjxwYXRoIGQ9XCJNMyAxOGExIDEgMCAwIDEtMS0xVjRhMSAxIDAgMCAxIDEtMWg1YTQgNCAwIDAgMSA0IDQgNCA0IDAgMCAxIDQtNGg1YTEgMSAwIDAgMSAxIDF2MTNhMSAxIDAgMCAxLTEgMWgtNmEzIDMgMCAwIDAtMyAzIDMgMyAwIDAgMC0zLTN6XCIvPjwvc3ZnPmA7XHJcbiAgICAgICAgICAgIGVtcHR5Q29udGFpbmVyLmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IFwiTm8gYXJ0aWNsZXMgc2F2ZWQgeWV0LlwiIH0pO1xyXG4gICAgICAgICAgICByZXR1cm47ICAgICAgICBcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgY2xpcHBlZEZpbGVzKXtcclxuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNsaXBwZWRFbCA9IGNvbnRhaW5lci5jcmVhdGVFbCgnZGl2Jywge2NsczogJ25ldENsaXBfY2FyZCd9KTtcclxuICAgIFxyXG4gICAgICAgICAgICBjb25zdCB0aHVtYm5haWxNYXRjaCA9IGNvbnRlbnQubWF0Y2goLyFcXFtUaHVtYm5haWxcXF1cXCgoLispXFwpLyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGltYWdlVXJsID0gdGh1bWJuYWlsTWF0Y2ggPyB0aHVtYm5haWxNYXRjaFsxXSA6ICdodHRwczovL2Nkbi5waXhhYmF5LmNvbS9waG90by8yMDIzLzEyLzE0LzA2LzQ1L2NoaWNrZW4tODQ0ODI2Ml8xMjgwLmpwZyc7IC8vIFVzZSBhIGRlZmF1bHQgaW1hZ2UgaWYgbm8gdGh1bWJuYWlsIGlzIGZvdW5kXHJcbiAgICBcclxuICAgICAgICAgICAgY2xpcHBlZEVsLmNyZWF0ZUVsKFwiaW1nXCIsIHsgYXR0cjogeyBzcmM6IGltYWdlVXJsIH19KTtcclxuICAgIFxyXG4gICAgICAgICAgICBjb25zdCBjbGlwcGVkVGl0bGUgPSBjbGlwcGVkRWwuY3JlYXRlRWwoXCJoNlwiLCB7IHRleHQ6IGZpbGUuYmFzZW5hbWUgfSk7XHJcbiAgICAgICAgICAgIGNsaXBwZWRUaXRsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMub3BlbkFydGljbGUoZmlsZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGJvdHRvbUNvbnRlbnQgPSBjbGlwcGVkRWwuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwibmV0Y2xpcF9jYXJkX2JvdHRvbVwiIH0pO1xyXG4gICAgICAgICAgICBjb25zdCB1cmxNYXRjaCA9IGNvbnRlbnQubWF0Y2goL3NvdXJjZTogXCIoW15cIl0rKVwiLyk7XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKHVybE1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhcnRpY2xlVXJsID0gdXJsTWF0Y2hbMV07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkb21haW5OYW1lID0gZ2V0RG9tYWluKGFydGljbGVVcmwpOyBcclxuICAgICAgICAgICAgICAgIGJvdHRvbUNvbnRlbnQuY3JlYXRlRWwoXCJhXCIsIHsgXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiBcImRvbWFpblwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhyZWY6IGFydGljbGVVcmwsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogZG9tYWluTmFtZVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBib3R0b21Db250ZW50LmNyZWF0ZUVsKFwic3BhblwiLCB7IFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogXCJkb21haW5cIixcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIlVua25vd24gU291cmNlXCJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlTWVudUJ1dHRvbihib3R0b21Db250ZW50LCBmaWxlLCB1cmxNYXRjaD8uWzFdKTtcclxuICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNsaXBwZWRFbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgXHJcbiAgICBwcml2YXRlIGNyZWF0ZU1lbnVCdXR0b24oYm90dG9tQ29udGVudDogSFRNTEVsZW1lbnQsIGZpbGU6IFRGaWxlLCB1cmw/OiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBtZW51QnV0dG9uID0gYm90dG9tQ29udGVudC5jcmVhdGVFbChcInNwYW5cIiwgeyBjbHM6IFwibWVudS1idXR0b25cIiB9KTtcclxuICAgICAgICBtZW51QnV0dG9uLmlubmVySFRNTCA9IGBcclxuICAgICAgICAgICAgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxNlwiIGhlaWdodD1cIjE2XCIgZmlsbD1cIiNmZmZcIiB2aWV3Qm94PVwiMCAwIDI1NiAyNTZcIj5cclxuICAgICAgICAgICAgICAgIDxwYXRoIGQ9XCJNMTQwLDEyOGExMiwxMiwwLDEsMS0xMi0xMkExMiwxMiwwLDAsMSwxNDAsMTI4Wk0xMjgsNzJhMTIsMTIsMCwxLDAtMTItMTJBMTIsMTIsMCwwLDAsMTI4LDcyWm0wLDExMmExMiwxMiwwLDEsMCwxMiwxMkExMiwxMiwwLDAsMCwxMjgsMTg0WlwiPjwvcGF0aD5cclxuICAgICAgICAgICAgPC9zdmc+YDtcclxuXHJcbiAgICAgICAgbWVudUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgY29udGV4dE1lbnUgPSBuZXcgQ2xpcHBlckNvbnRleHRNZW51KFxyXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAsIFxyXG4gICAgICAgICAgICAgICAgZmlsZSwgXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dEZWxldGVDb25maXJtYXRpb24uYmluZCh0aGlzKSxcclxuICAgICAgICAgICAgICAgIHRoaXMub3BlbkFydGljbGUuYmluZCh0aGlzKSxcclxuICAgICAgICAgICAgICAgIHVybFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBjb250ZXh0TWVudS5zaG93KG1lbnVCdXR0b24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBzaG93RGVsZXRlQ29uZmlybWF0aW9uKGZpbGU6IFRGaWxlKSB7XHJcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgRGVsZXRlQ29uZmlybWF0aW9uTW9kYWwoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLCBcclxuICAgICAgICAgICAgZmlsZSwgXHJcbiAgICAgICAgICAgIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmRlbGV0ZShmaWxlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNhdmVkQ29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLm5ldGNsaXBfc2F2ZWRfY29udGFpbmVyXCIpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTYXZlZENvbnRlbnQoc2F2ZWRDb250YWluZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgICAgICBtb2RhbC5vcGVuKCk7XHJcbiAgICB9XHJcbiAgICBcclxuXHJcblxyXG5cclxuICAgIHByaXZhdGUgb3BlbkFydGljbGUoZmlsZTogVEZpbGUpe1xyXG4gICAgICAgIGNvbnN0IG9wZW5MZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFwibWFya2Rvd25cIik7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0TGVhZiA9IG9wZW5MZWF2ZXMuZmluZCgobGVhZikgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB2aWV3U3RhdGUgPSBsZWFmLmdldFZpZXdTdGF0ZSgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdmlld1N0YXRlLnR5cGUgPT09IFwibWFya2Rvd25cIiAmJiB2aWV3U3RhdGUuc3RhdGU/LmZpbGUgPT09IGZpbGUucGF0aDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKHRhcmdldExlYWYpIHtcclxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLnJldmVhbExlYWYodGFyZ2V0TGVhZik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChmaWxlLnBhdGgsICcnLCB0cnVlKTtcclxuICAgICAgICB9ICAgICAgICBcclxuICAgIH1cclxufSIsICJcclxuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZVVybCh1cmw6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCk7XHJcbiAgICBcclxuICAgIC8vIFJlbW92ZSBjb21tb24gdHJhY2tpbmcgcGFyYW1ldGVyc1xyXG4gICAgY29uc3QgdHJhY2tpbmdQYXJhbXMgPSBbXHJcbiAgICAgICd1dG1fc291cmNlJywgJ3V0bV9tZWRpdW0nLCAndXRtX2NhbXBhaWduJywgXHJcbiAgICAgICd1dG1fdGVybScsICd1dG1fY29udGVudCcsICdmYmNsaWQnLCAnZ2NsaWQnXHJcbiAgICBdO1xyXG4gICAgXHJcbiAgICB0cmFja2luZ1BhcmFtcy5mb3JFYWNoKHBhcmFtID0+IHtcclxuICAgICAgcGFyc2VkVXJsLnNlYXJjaFBhcmFtcy5kZWxldGUocGFyYW0pO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHJldHVybiBwYXJzZWRVcmwudG9TdHJpbmcoKTtcclxuICB9IGNhdGNoIHtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzYW5pdGl6ZVBhdGgocGF0aDogc3RyaW5nKTogc3RyaW5nIHtcclxuICByZXR1cm4gcGF0aFxyXG4gICAgLnJlcGxhY2UoL1tcXC9cXFxcOio/XCI8PnxdL2csICdfJykgIC8vIFJlbW92ZSBpbnZhbGlkIGZpbGVuYW1lIGNoYXJhY3RlcnNcclxuICAgIC5yZXBsYWNlKC9cXHMrL2csICcgJykgICAgICAgICAgICAvLyBOb3JtYWxpemUgd2hpdGVzcGFjZVxyXG4gICAgLnRyaW0oKTsgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJpbSBsZWFkaW5nL3RyYWlsaW5nIHdoaXRlc3BhY2VcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXREb21haW4odXJsOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCk7XHJcbiAgICByZXR1cm4gcGFyc2VkVXJsLmhvc3RuYW1lLnJlcGxhY2UoL153d3dcXC4vLCAnJyk7XHJcbiAgfSBjYXRjaCB7XHJcbiAgICByZXR1cm4gJ1Vua25vd24gRG9tYWluJztcclxuICB9XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2ZVVybChiYXNlOiBzdHJpbmcsIHJlbGF0aXZlOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIHRyeSB7XHJcbiAgICByZXR1cm4gbmV3IFVSTChyZWxhdGl2ZSwgYmFzZSkudG9TdHJpbmcoKTtcclxuICB9IGNhdGNoIHtcclxuICAgIHJldHVybiByZWxhdGl2ZTtcclxuICB9XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdFRpdGxlRnJvbUh0bWwoaHRtbDogc3RyaW5nKTogc3RyaW5nIHtcclxuICBjb25zdCB0aXRsZU1hdGNoID0gaHRtbC5tYXRjaCgvPHRpdGxlPiguKj8pPFxcL3RpdGxlPi8pO1xyXG4gIGlmICh0aXRsZU1hdGNoICYmIHRpdGxlTWF0Y2hbMV0pIHtcclxuICAgICAgcmV0dXJuIHRpdGxlTWF0Y2hbMV0udHJpbSgpO1xyXG4gIH1cclxuICByZXR1cm4gJ1VudGl0bGVkJztcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkVXJsKHVybDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgdHJ5IHtcclxuICAgICAgbmV3IFVSTCh1cmwpO1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICB9IGNhdGNoIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRGaWxlRXh0ZW5zaW9uKHVybDogc3RyaW5nKTogc3RyaW5nIHtcclxuICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCk7XHJcbiAgY29uc3QgcGF0aCA9IHBhcnNlZFVybC5wYXRobmFtZTtcclxuICBjb25zdCBleHRlbnNpb24gPSBwYXRoLnNwbGl0KCcuJykucG9wKCk7XHJcbiAgcmV0dXJuIGV4dGVuc2lvbiA/IGV4dGVuc2lvbi50b0xvd2VyQ2FzZSgpIDogJyc7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYWRkUXVlcnlQYXJhbSh1cmw6IHN0cmluZywgcGFyYW1OYW1lOiBzdHJpbmcsIHBhcmFtVmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgY29uc3QgcGFyc2VkVXJsID0gbmV3IFVSTCh1cmwpO1xyXG4gIHBhcnNlZFVybC5zZWFyY2hQYXJhbXMuYXBwZW5kKHBhcmFtTmFtZSwgcGFyYW1WYWx1ZSk7XHJcbiAgcmV0dXJuIHBhcnNlZFVybC50b1N0cmluZygpO1xyXG59IiwgImltcG9ydCB7IE1vZGFsLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcclxuXHJcbmV4cG9ydCBjbGFzcyBEZWxldGVDb25maXJtYXRpb25Nb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICAgIHByaXZhdGUgZmlsZTogVEZpbGU7XHJcbiAgICBwcml2YXRlIG9uQ29uZmlybURlbGV0ZTogKCkgPT4gUHJvbWlzZTx2b2lkPjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IGFueSwgZmlsZTogVEZpbGUsIG9uQ29uZmlybURlbGV0ZTogKCkgPT4gUHJvbWlzZTx2b2lkPikge1xyXG4gICAgICAgIHN1cGVyKGFwcCk7XHJcbiAgICAgICAgdGhpcy5maWxlID0gZmlsZTtcclxuICAgICAgICB0aGlzLm9uQ29uZmlybURlbGV0ZSA9IG9uQ29uZmlybURlbGV0ZTtcclxuICAgIH1cclxuXHJcbiAgICBvbk9wZW4oKSB7XHJcbiAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoJ0NvbmZpcm0gRGVsZXRlJyk7XHJcbiAgICAgICAgdGhpcy5jb250ZW50RWwuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6IGBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoZSBhcnRpY2xlIFwiJHt0aGlzLmZpbGUuYmFzZW5hbWV9XCI/YCB9KTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBidXR0b25Db250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICduZXRjbGlwX2J1dHRvbi1jb250YWluZXInIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGNvbmZpcm1CdXR0b24gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgXHJcbiAgICAgICAgICAgIGNsczogJ21vZC13YXJuaW5nJyxcclxuICAgICAgICAgICAgdGV4dDogJ0RlbGV0ZScgXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdDYW5jZWwnIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbmZpcm1CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMub25Db25maXJtRGVsZXRlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBjYW5jZWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMuY29udGVudEVsLmVtcHR5KCk7XHJcbiAgICB9XHJcbn0iLCAiaW1wb3J0IHsgTWVudSwgTm90aWNlLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgV2ViVmlld01vZGFsIH0gZnJvbSAnLi92aWV3L01vZGFsV2ViVmlldyc7XHJcbmltcG9ydCBOZXRDbGlwUGx1Z2luIGZyb20gJy4vbWFpbic7XHJcbmltcG9ydCB7IFdvcmtzcGFjZUxlYWZXZWJWaWV3LCBWSUVXX1RZUEVfV09SS1NQQUNFX1dFQlZJRVcgfSBmcm9tICcuL3ZpZXcvRWRpdG9yV2ViVmlldyc7XHJcblxyXG5leHBvcnQgY2xhc3MgQ2xpcHBlckNvbnRleHRNZW51IHtcclxuICAgIHByaXZhdGUgYXBwOiBhbnk7XHJcbiAgICBwcml2YXRlIGZpbGU6IFRGaWxlO1xyXG4gICAgcHJpdmF0ZSB1cmw/OiBzdHJpbmc7XHJcbiAgICBwcml2YXRlIG9uRGVsZXRlOiAoZmlsZTogVEZpbGUpID0+IHZvaWQ7XHJcbiAgICBwcml2YXRlIG9uT3BlbkFydGljbGU6IChmaWxlOiBURmlsZSkgPT4gdm9pZDtcclxuICAgIHBsdWdpbjogTmV0Q2xpcFBsdWdpbjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBhcHA6IGFueSwgXHJcbiAgICAgICAgZmlsZTogVEZpbGUsIFxyXG4gICAgICAgIG9uRGVsZXRlOiAoZmlsZTogVEZpbGUpID0+IHZvaWQsIFxyXG4gICAgICAgIG9uT3BlbkFydGljbGU6IChmaWxlOiBURmlsZSkgPT4gdm9pZCwgXHJcbiAgICAgICAgdXJsPzogc3RyaW5nLFxyXG4gICAgKSB7XHJcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XHJcbiAgICAgICAgdGhpcy5maWxlID0gZmlsZTtcclxuICAgICAgICB0aGlzLnVybCA9IHVybDtcclxuICAgICAgICB0aGlzLm9uRGVsZXRlID0gb25EZWxldGU7XHJcbiAgICAgICAgdGhpcy5vbk9wZW5BcnRpY2xlID0gb25PcGVuQXJ0aWNsZTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHRoaXMuYXBwLnBsdWdpbnMuZ2V0UGx1Z2luKCduZXQtY2xpcCcpO1xyXG4gICAgfVxyXG5cclxuICAgIHNob3coYW5jaG9yRWxlbWVudDogSFRNTEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBtZW51ID0gbmV3IE1lbnUoKTtcclxuXHJcbiAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoXCJPcGVuIHBhZ2UgaW4gRWRpdG9yXCIpXHJcbiAgICAgICAgICAgICAgICAuc2V0SWNvbihcImdsb2JlXCIpXHJcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudXJsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nTGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX1dPUktTUEFDRV9XRUJWSUVXKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoKGxlYWY6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBsZWFmLnZpZXcgYXMgV29ya3NwYWNlTGVhZldlYlZpZXc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZpZXcudXJsID09PSB0aGlzLnVybDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0xlYWYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKGV4aXN0aW5nTGVhZiwgeyBmb2N1czogdHJ1ZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigndGFiJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVhZi5zZXRWaWV3U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFZJRVdfVFlQRV9XT1JLU1BBQ0VfV0VCVklFVyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZTogeyB1cmw6IHRoaXMudXJsIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsZWFmLnZpZXcgaW5zdGFuY2VvZiBXb3Jrc3BhY2VMZWFmV2ViVmlldykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWFmLnZpZXcuc2V0VXJsKHRoaXMudXJsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKGxlYWYsIHsgZm9jdXM6IHRydWUgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdObyBVUkwgZm91bmQgZm9yIHRoaXMgY2xpcHBpbmcnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICBpdGVtLnNldFRpdGxlKFwiT3BlbiBwYWdlIGluIE1vZGFsXCIpXHJcbiAgICAgICAgICAgICAgICAuc2V0SWNvbihcIm1heGltaXplXCIpXHJcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudXJsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IFdlYlZpZXdNb2RhbChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXJsLCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZCwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpblxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnTm8gVVJMIGZvdW5kIGZvciB0aGlzIGNsaXBwaW5nJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICBpdGVtXHJcbiAgICAgICAgICAgICAgICAuc2V0VGl0bGUoXCJPcGVuIGluIEVkaXRvclwiKVxyXG4gICAgICAgICAgICAgICAgLnNldEljb24oXCJmaWxlLXRleHRcIilcclxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uT3BlbkFydGljbGUodGhpcy5maWxlKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgaXRlbVxyXG4gICAgICAgICAgICAgICAgLnNldFRpdGxlKFwiRGVsZXRlXCIpXHJcbiAgICAgICAgICAgICAgICAuc2V0SWNvbihcInRyYXNoXCIpXHJcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRlbGV0ZSh0aGlzLmZpbGUpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlY3QgPSBhbmNob3JFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIG1lbnUuc2hvd0F0UG9zaXRpb24oeyB4OiByZWN0LmxlZnQsIHk6IHJlY3QuYm90dG9tIH0pO1xyXG4gICAgfVxyXG59IiwgImltcG9ydCB7IEFwcCwgTW9kYWwsIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgV2ViVmlld0NvbXBvbmVudCB9IGZyb20gJy4uL3dlYlZpZXdDb21wb25lbnQnO1xyXG5pbXBvcnQgV2ViQ2xpcHBlclBsdWdpbiBmcm9tICcuLi9tYWluJztcclxuXHJcbmludGVyZmFjZSBNb2RhbFdlYlZpZXdTZXR0aW5ncyB7XHJcbiAgICBkZWZhdWx0V2lkdGg6IHN0cmluZztcclxuICAgIGRlZmF1bHRIZWlnaHQ6IHN0cmluZztcclxufVxyXG5cclxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTW9kYWxXZWJWaWV3U2V0dGluZ3MgPSB7XHJcbiAgICBkZWZhdWx0V2lkdGg6ICcxMDAlJyxcclxuICAgIGRlZmF1bHRIZWlnaHQ6ICcxMDAlJyxcclxufTtcclxuZXhwb3J0IGNsYXNzIFdlYlZpZXdNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICAgIHByaXZhdGUgd2ViVmlld0NvbXBvbmVudDogV2ViVmlld0NvbXBvbmVudDtcclxuICAgIHByaXZhdGUgcGx1Z2luOiBXZWJDbGlwcGVyUGx1Z2luO1xyXG4gICAgcHJpdmF0ZSBzZXR0aW5nczogTW9kYWxXZWJWaWV3U2V0dGluZ3M7XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgYXBwOiBBcHAsIFxyXG4gICAgICAgIHVybDogc3RyaW5nLCBcclxuICAgICAgICBzZXR0aW5nczogTW9kYWxXZWJWaWV3U2V0dGluZ3MgPSBERUZBVUxUX1NFVFRJTkdTLCBcclxuICAgICAgICBwbHVnaW46IFdlYkNsaXBwZXJQbHVnaW5cclxuICAgICkge1xyXG4gICAgICAgIHN1cGVyKGFwcCk7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHtcclxuICAgICAgICAgICAgZGVmYXVsdFdpZHRoOiBwbHVnaW4/LnNldHRpbmdzPy5tb2RhbFdpZHRoIHx8IHNldHRpbmdzLmRlZmF1bHRXaWR0aCB8fCAnODB2dycsXHJcbiAgICAgICAgICAgIGRlZmF1bHRIZWlnaHQ6IHBsdWdpbj8uc2V0dGluZ3M/Lm1vZGFsSGVpZ2h0IHx8IHNldHRpbmdzLmRlZmF1bHRIZWlnaHQgfHwgJzgwdmgnXHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuXHJcblxyXG4gICAgICAgIHRoaXMud2ViVmlld0NvbXBvbmVudCA9IG5ldyBXZWJWaWV3Q29tcG9uZW50KFxyXG4gICAgICAgICAgICB0aGlzLmFwcCwgXHJcbiAgICAgICAgICAgIHVybCwgXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHRXaWR0aDogdGhpcy5zZXR0aW5ncy5kZWZhdWx0V2lkdGgsXHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0SGVpZ2h0OiB0aGlzLnNldHRpbmdzLmRlZmF1bHRIZWlnaHQsXHJcbiAgICAgICAgICAgICAgICBzZWFyY2hFbmdpbmU6IHBsdWdpbj8uc2V0dGluZ3M/LnNlYXJjaEVuZ2luZSB8fCAnZGVmYXVsdCdcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIGFzeW5jIChjbGlwVXJsKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4gJiYgdHlwZW9mIHRoaXMucGx1Z2luLmNsaXBXZWJwYWdlID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uY2xpcFdlYnBhZ2UoY2xpcFVybCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0NsaXAgd2VicGFnZSBmdW5jdGlvbiBub3QgYXZhaWxhYmxlJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIG9uT3BlbigpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLm1vZGFsRWwuc3R5bGUud2lkdGggPSB0aGlzLnNldHRpbmdzLmRlZmF1bHRXaWR0aDtcclxuICAgICAgICB0aGlzLm1vZGFsRWwuc3R5bGUuaGVpZ2h0ID0gdGhpcy5zZXR0aW5ncy5kZWZhdWx0SGVpZ2h0O1xyXG5cclxuICAgICAgICBjb25zdCB3ZWJWaWV3Q29udGFpbmVyID0gdGhpcy53ZWJWaWV3Q29tcG9uZW50LmNyZWF0ZUNvbnRhaW5lcigpO1xyXG4gICAgICAgIGNvbnRlbnRFbC5hcHBlbmRDaGlsZCh3ZWJWaWV3Q29udGFpbmVyKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsb3NlKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xyXG4gICAgfVxyXG59IiwgImltcG9ydCB7IEFwcCwgUGxhdGZvcm0gfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFdlYlNlYXJjaCwgV2ViU2VhcmNoU2V0dGluZ3MgfSBmcm9tICcuL3NlYXJjaC9zZWFyY2gnOyBcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgV2Vidmlld1RhZyBleHRlbmRzIEhUTUxFbGVtZW50IHtcclxuICAgIHNyYzogc3RyaW5nO1xyXG4gICAgYWxsb3dwb3B1cHM/OiBib29sZWFuO1xyXG4gICAgcmVsb2FkOiAoKSA9PiB2b2lkO1xyXG4gICAgZ2V0VVJMPzogKCkgPT4gc3RyaW5nO1xyXG4gICAgZ29CYWNrPzogKCkgPT4gdm9pZDtcclxuICAgIGdvRm9yd2FyZD86ICgpID0+IHZvaWQ7XHJcbiAgICBjYW5Hb0JhY2s/OiAoKSA9PiBib29sZWFuO1xyXG4gICAgY2FuR29Gb3J3YXJkPzogKCkgPT4gYm9vbGVhbjtcclxufVxyXG5cclxuXHJcbmludGVyZmFjZSBXZWJWaWV3Q29tcG9uZW50U2V0dGluZ3MgZXh0ZW5kcyBXZWJTZWFyY2hTZXR0aW5ncyB7XHJcbiAgICBkZWZhdWx0V2lkdGg/OiBzdHJpbmc7XHJcbiAgICBkZWZhdWx0SGVpZ2h0Pzogc3RyaW5nO1xyXG4gICAgZml0VG9Db250YWluZXI/OiBib29sZWFuO1xyXG59XHJcblxyXG5cclxuXHJcblxyXG5leHBvcnQgY2xhc3MgV2ViVmlld0NvbXBvbmVudCB7XHJcbiAgICBwcml2YXRlIGZyYW1lOiBIVE1MSUZyYW1lRWxlbWVudCB8IFdlYnZpZXdUYWc7XHJcbiAgICBwcml2YXRlIHVybDogc3RyaW5nO1xyXG4gICAgcHJpdmF0ZSBpc0ZyYW1lUmVhZHk6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHByaXZhdGUgc2V0dGluZ3M6IFdlYlZpZXdDb21wb25lbnRTZXR0aW5ncztcclxuXHJcbiAgICBwcml2YXRlIGJhY2tCdG46IEhUTUxCdXR0b25FbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBmb3J3YXJkQnRuOiBIVE1MQnV0dG9uRWxlbWVudDtcclxuICAgIHByaXZhdGUgY2xpcEJ0bj86IEhUTUxCdXR0b25FbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBuYXZpZ2F0aW9uSGlzdG9yeTogc3RyaW5nW10gPSBbXTtcclxuICAgIHByaXZhdGUgY3VycmVudEhpc3RvcnlJbmRleDogbnVtYmVyID0gLTE7XHJcblxyXG5cclxuICAgIHByaXZhdGUgbG9hZGluZ1NwaW5uZXI6IEhUTUxFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBzZWFyY2hJbnB1dDogSFRNTElucHV0RWxlbWVudDtcclxuICAgIHByaXZhdGUgc2VhcmNoOiBXZWJTZWFyY2g7XHJcblxyXG4gICAgcHJpdmF0ZSBvbkNsaXBDYWxsYmFjaz86ICh1cmw6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxyXG4gICAgICAgIHVybDogc3RyaW5nLFxyXG4gICAgICAgIHNldHRpbmdzOiBXZWJWaWV3Q29tcG9uZW50U2V0dGluZ3MgPSB7fSxcclxuICAgICAgICBvbkNsaXBDYWxsYmFjaz86ICh1cmw6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPlxyXG4gICAgKSB7XHJcbiAgICAgICAgdGhpcy51cmwgPSB1cmw7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHtcclxuICAgICAgICAgICAgZGVmYXVsdFdpZHRoOiAnMTAwJScsXHJcbiAgICAgICAgICAgIGRlZmF1bHRIZWlnaHQ6ICcxMDAlJyxcclxuICAgICAgICAgICAgc2VhcmNoRW5naW5lOiAnZ29vZ2xlJyxcclxuICAgICAgICAgICAgZml0VG9Db250YWluZXI6IHRydWUsXHJcbiAgICAgICAgICAgIC4uLnNldHRpbmdzXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm9uQ2xpcENhbGxiYWNrID0gb25DbGlwQ2FsbGJhY2s7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGNyZWF0ZUNvbnRhaW5lcigpOiBIVE1MRWxlbWVudCB7XHJcblxyXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lckVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgY29udGFpbmVyRWwuY2xhc3NMaXN0LmFkZCgnbmV0Q2xpcF93ZWJ2aWV3X2NvbnRhaW5lcicpO1xyXG4gICAgICAgIGNvbnN0IGNvbnRyb2xzRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoJ25ldENsaXBfd2ViX2NvbnRyb2xzJyk7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0dXBOYXZpZ2F0aW9uQnRucyhjb250cm9sc0VsKTtcclxuICAgICAgICB0aGlzLnNldHVwU2VhcmNoSW5wdXQoY29udHJvbHNFbCk7XHJcbiAgICAgICAgdGhpcy5zZXR1cENsaXBCdG4oY29udHJvbHNFbCk7XHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgIHRoaXMuc2V0dXBGcmFtZUNvbnRhaW5lcihjb250YWluZXJFbCk7XHJcblxyXG4gICAgICAgIHRoaXMubmF2aWdhdGlvbkhpc3RvcnkucHVzaCh0aGlzLnVybCk7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50SGlzdG9yeUluZGV4ID0gMDtcclxuXHJcbiAgICAgICAgcmV0dXJuIGNvbnRhaW5lckVsO1xyXG5cclxuICAgIH1cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiAgICBwcml2YXRlIHNldHVwU2VhcmNoSW5wdXQoY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHNlYXJjaENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoJ25ldENsaXBfc2VhcmNoX2NvbnRhaW5lcicpO1xyXG4gICAgICAgIHRoaXMuc2VhcmNoSW5wdXQgPSBzZWFyY2hDb250YWluZXIuY3JlYXRlRWwoJ2lucHV0JywgeyB0eXBlOiAndGV4dCcsIHBsYWNlaG9sZGVyOiAnU2VhcmNoLi4uJywgdmFsdWU6IHRoaXMudXJsIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBzdWdnZXN0aW9uQ29udGFpbmVyID0gc2VhcmNoQ29udGFpbmVyLmNyZWF0ZURpdignbmV0Q2xpcF9xdWVyeV9ib3gnKTtcclxuICAgICAgICBjb25zdCBzdWdnZXN0aW9uc0JveCA9IHN1Z2dlc3Rpb25Db250YWluZXIuY3JlYXRlRGl2KCduZXRDbGlwX3N1Z2dlc3Rpb25zJyk7XHJcblxyXG5cclxuICAgICAgICB0aGlzLnNlYXJjaCA9IG5ldyBXZWJTZWFyY2goXHJcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoSW5wdXQsXHJcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25Db250YWluZXIsXHJcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zQm94LFxyXG4gICAgICAgICAgICB7IHNlYXJjaEVuZ2luZTogdGhpcy5zZXR0aW5ncy5zZWFyY2hFbmdpbmUgfVxyXG4gICAgICAgICk7XHJcblxyXG5cclxuICAgICAgICB0aGlzLnNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ3NlYXJjaC1xdWVyeScsIChldmVudDogQ3VzdG9tRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgeyB1cmwgfSA9IGV2ZW50LmRldGFpbDtcclxuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0ZVRvKHVybCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIHNldHVwQ2xpcEJ0bihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMub25DbGlwQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgY29uc3QgY2xpcENvbnRpYW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoJ25ldENsaXBfY2xpcF9idG5fY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcEJ0biA9IGNsaXBDb250aWFuZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ0NsaXAnIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBCdG4ub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMub25DbGlwQ2FsbGJhY2s/Lih0aGlzLmdldEN1cnJlbnRVcmwoKSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIHNldHVwTmF2aWdhdGlvbkJ0bnMoY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGxlZnRDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KCduZXRDbGlwX25hdl9sZWZ0Jyk7XHJcblxyXG4gICAgICAgIHRoaXMuYmFja0J0biA9IGxlZnRDb250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAnbmV0Q2xpcF9iYWNrX2J0biBuZXRDbGlwX2J0bicgfSk7XHJcbiAgICAgICAgdGhpcy5iYWNrQnRuLmlubmVySFRNTCA9IGBcclxuICAgICAgICA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiAgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiIGNsYXNzPVwibHVjaWRlIGx1Y2lkZS1jaGV2cm9uLWxlZnRcIj48cGF0aCBkPVwibTE1IDE4LTYtNiA2LTZcIi8+PC9zdmc+XHJcbiAgICAgICAgYFxyXG4gICAgICAgIHRoaXMuYmFja0J0bi5vbmNsaWNrID0gKCkgPT4gdGhpcy5nb0JhY2soKTtcclxuICAgICAgICB0aGlzLmJhY2tCdG4uZGlzYWJsZWQgPSB0cnVlO1xyXG5cclxuXHJcbiAgICAgICAgdGhpcy5mb3J3YXJkQnRuID0gbGVmdENvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywgeyBjbHM6ICduZXRDbGlwX2ZvcndhcmRfYnRuIG5ldENsaXBfYnRuJyB9KTtcclxuICAgICAgICB0aGlzLmZvcndhcmRCdG4uaW5uZXJIVE1MID0gYFxyXG4gICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIiBjbGFzcz1cImx1Y2lkZSBsdWNpZGUtY2hldnJvbi1yaWdodFwiPjxwYXRoIGQ9XCJtOSAxOCA2LTYtNi02XCIvPjwvc3ZnPlxyXG4gICAgICAgIGBcclxuICAgICAgICB0aGlzLmZvcndhcmRCdG4ub25jbGljayA9ICgpID0+IHRoaXMuZ29Gb3J3YXJkKCk7XHJcbiAgICAgICAgdGhpcy5mb3J3YXJkQnRuLmRpc2FibGVkID0gdHJ1ZTtcclxuXHJcblxyXG4gICAgICAgIGNvbnN0IHJlZnJlc2hCdG4gPSBsZWZ0Q29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IGNsczogJ25ldENsaXBfcmVmcmVzaF9idG4gbmV0Q2xpcF9idG4nIH0pO1xyXG4gICAgICAgIHJlZnJlc2hCdG4uaW5uZXJIVE1MID0gYFxyXG4gICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiICB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIgY2xhc3M9XCJsdWNpZGUgbHVjaWRlLXJlZnJlc2gtY2N3XCI+PHBhdGggZD1cIk0yMSAxMmE5IDkgMCAwIDAtOS05IDkuNzUgOS43NSAwIDAgMC02Ljc0IDIuNzRMMyA4XCIvPjxwYXRoIGQ9XCJNMyAzdjVoNVwiLz48cGF0aCBkPVwiTTMgMTJhOSA5IDAgMCAwIDkgOSA5Ljc1IDkuNzUgMCAwIDAgNi43NC0yLjc0TDIxIDE2XCIvPjxwYXRoIGQ9XCJNMTYgMTZoNXY1XCIvPjwvc3ZnPlxyXG4gICAgICAgIGBcclxuICAgICAgICByZWZyZXNoQnRuLm9uY2xpY2sgPSAoKSA9PiB0aGlzLnJlZnJlc2goKTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIFxyXG4gICAgcHJpdmF0ZSBzZXR1cEZyYW1lQ29udGFpbmVyKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCk6IEhUTUxFbGVtZW50IHtcclxuICAgICAgICBjb25zdCBmcmFtZUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdignbmV0Q2xpcF9mcmFtZS1jb250YWluZXInKTtcclxuICAgICAgICBmcmFtZUNvbnRhaW5lci5zdHlsZS5mbGV4R3JvdyA9ICcxJztcclxuICAgICAgICBmcmFtZUNvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XHJcbiAgICAgICAgZnJhbWVDb250YWluZXIuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcclxuXHJcblxyXG4gICAgICAgIHRoaXMubG9hZGluZ1NwaW5uZXIgPSBmcmFtZUNvbnRhaW5lci5jcmVhdGVEaXYoJ2xvYWRpbmctc3Bpbm5lcicpO1xyXG4gICAgICAgIHRoaXMubG9hZGluZ1NwaW5uZXIuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG4gICAgICAgIHRoaXMubG9hZGluZ1NwaW5uZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuXHJcblxyXG4gICAgICAgIHRoaXMuZnJhbWUgPSB0aGlzLmNyZWF0ZUZyYW1lKCk7XHJcbiAgICAgICAgZnJhbWVDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5mcmFtZSk7XHJcblxyXG4gICAgICAgIHJldHVybiBmcmFtZUNvbnRhaW5lcjtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBjcmVhdGVGcmFtZSgpOiBIVE1MSUZyYW1lRWxlbWVudCB8IFdlYnZpZXdUYWcge1xyXG4gICAgICAgIHJldHVybiBQbGF0Zm9ybS5pc01vYmlsZUFwcCA/IHRoaXMuY3JlYXRlSWZyYW1lKCkgOiB0aGlzLmNyZWF0ZVdlYnZpZXcoKTtcclxuICAgICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIGNyZWF0ZUlmcmFtZSgpOiBIVE1MSUZyYW1lRWxlbWVudCB7XHJcbiAgICAgICAgY29uc3QgaWZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7XHJcbiAgICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnYWxsb3dwb3B1cHMnLCAnJyk7XHJcbiAgICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnY3JlZGVudGlhbGxlc3MnLCAndHJ1ZScpO1xyXG4gICAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2Nyb3Nzb3JpZ2luJywgJ2Fub255bW91cycpO1xyXG4gICAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ3NyYycsIHRoaXMudXJsKTtcclxuICAgICAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCdzYW5kYm94JywgJ2FsbG93LWZvcm1zIGFsbG93LW1vZGFscyBhbGxvdy1wb3B1cHMgYWxsb3ctcHJlc2VudGF0aW9uIGFsbG93LXNhbWUtb3JpZ2luIGFsbG93LXNjcmlwdHMgYWxsb3ctdG9wLW5hdmlnYXRpb24tYnktdXNlci1hY3RpdmF0aW9uJyk7XHJcbiAgICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnYWxsb3cnLCAnZW5jcnlwdGVkLW1lZGlhO2Z1bGxzY3JlZW47b3ZlcnNpemVkLWltYWdlcztwaWN0dXJlLWluLXBpY3R1cmU7c3luYy14aHI7Z2VvbG9jYXRpb24nKTtcclxuICAgICAgICBcclxuICAgICAgICBpZnJhbWUuc3R5bGUud2lkdGggPSAnMTAwJSc7XHJcbiAgICAgICAgaWZyYW1lLnN0eWxlLmhlaWdodCA9ICcxMDAlJztcclxuICAgICAgICBpZnJhbWUuc3R5bGUuYm9yZGVyID0gJ25vbmUnO1xyXG4gICAgICAgIGlmcmFtZS5zdHlsZS5vYmplY3RGaXQgPSAnY29udGFpbic7XHJcbiAgICAgICAgaWZyYW1lLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjZjBmMGYwJztcclxuICAgIFxyXG4gICAgICAgIGlmcmFtZS5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5vbkZyYW1lTG9hZCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBpZnJhbWU7XHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgICAvLyBDcmVhdGUgd2VidmlldyBmb3IgZGVza3RvcFxyXG4gICAgICBwcml2YXRlIGNyZWF0ZVdlYnZpZXcoKTogV2Vidmlld1RhZyB7XHJcbiAgICAgICAgY29uc3Qgd2VidmlldyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3dlYnZpZXcnKSBhcyBXZWJ2aWV3VGFnO1xyXG4gICAgICAgIHdlYnZpZXcuYWxsb3dwb3B1cHMgPSB0cnVlO1xyXG4gICAgICAgIHdlYnZpZXcuc3JjID0gdGhpcy51cmw7XHJcbiAgICAgICAgd2Vidmlldy5zdHlsZS53aWR0aCA9ICcxMDAlJztcclxuICAgICAgICB3ZWJ2aWV3LnN0eWxlLmhlaWdodCA9ICcxMDAlJztcclxuICAgICAgICB3ZWJ2aWV3LnN0eWxlLmJvcmRlciA9ICdub25lJztcclxuICAgICAgICB3ZWJ2aWV3LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjZjBmMGYwJztcclxuICAgICAgICB3ZWJ2aWV3LnN0eWxlLm9iamVjdEZpdCA9ICdjb250YWluJztcclxuICAgIFxyXG4gICAgICAgIHdlYnZpZXcuYWRkRXZlbnRMaXN0ZW5lcignZG9tLXJlYWR5JywgKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5pc0ZyYW1lUmVhZHkgPSB0cnVlO1xyXG4gICAgICAgICAgdGhpcy51cGRhdGVVcmxEaXNwbGF5KCk7XHJcbiAgICAgICAgICB0aGlzLmxvYWRpbmdTcGlubmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgfSk7XHJcbiAgICBcclxuICAgICAgICB3ZWJ2aWV3LmFkZEV2ZW50TGlzdGVuZXIoJ2RpZC1zdGFydC1sb2FkaW5nJywgKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5sb2FkaW5nU3Bpbm5lci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICAgICAgICB9KTtcclxuICAgIFxyXG4gICAgICAgIHdlYnZpZXcuYWRkRXZlbnRMaXN0ZW5lcignZGlkLXN0b3AtbG9hZGluZycsICgpID0+IHtcclxuICAgICAgICAgIHRoaXMubG9hZGluZ1NwaW5uZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICB9KTtcclxuICAgIFxyXG4gICAgICAgIHdlYnZpZXcuYWRkRXZlbnRMaXN0ZW5lcignZGlkLW5hdmlnYXRlJywgKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy51cGRhdGVVcmxEaXNwbGF5KCk7XHJcbiAgICAgICAgICB0aGlzLnVwZGF0ZU5hdmlnYXRpb25CdXR0b25zKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICBcclxuICAgICAgICB3ZWJ2aWV3LmFkZEV2ZW50TGlzdGVuZXIoJ2RpZC1uYXZpZ2F0ZS1pbi1wYWdlJywgKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy51cGRhdGVVcmxEaXNwbGF5KCk7XHJcbiAgICAgICAgICB0aGlzLnVwZGF0ZU5hdmlnYXRpb25CdXR0b25zKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICBcclxuICAgICAgICByZXR1cm4gd2VidmlldztcclxuICAgICAgfVxyXG5cclxuXHJcblxyXG5cclxuICAgIHByaXZhdGUgb25GcmFtZUxvYWQoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5pc0ZyYW1lUmVhZHkgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMudXBkYXRlVXJsRGlzcGxheSgpO1xyXG4gICAgICAgIHRoaXMubG9hZGluZ1NwaW5uZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgIFxyXG4gICAgICAgIC8vIFVwZGF0ZSBuYXZpZ2F0aW9uIGhpc3Rvcnkgd2hlbiBpZnJhbWUgbG9hZHMgbmV3IHBhZ2VcclxuICAgICAgICBjb25zdCBjdXJyZW50VXJsID0gdGhpcy5nZXRDdXJyZW50VXJsKCk7XHJcbiAgICAgICAgaWYgKGN1cnJlbnRVcmwgIT09IHRoaXMubmF2aWdhdGlvbkhpc3RvcnlbdGhpcy5jdXJyZW50SGlzdG9yeUluZGV4XSkge1xyXG4gICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uSGlzdG9yeSA9IHRoaXMubmF2aWdhdGlvbkhpc3Rvcnkuc2xpY2UoMCwgdGhpcy5jdXJyZW50SGlzdG9yeUluZGV4ICsgMSk7XHJcbiAgICAgICAgICB0aGlzLm5hdmlnYXRpb25IaXN0b3J5LnB1c2goY3VycmVudFVybCk7XHJcbiAgICAgICAgICB0aGlzLmN1cnJlbnRIaXN0b3J5SW5kZXgrKztcclxuICAgICAgICAgIHRoaXMudXBkYXRlTmF2aWdhdGlvbkJ1dHRvbnMoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcblxyXG5cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBuYXZpZ2F0ZVRvKHVybDogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy51cmwgPSB1cmw7XHJcbiAgICAgICAgdGhpcy5uYXZpZ2F0aW9uSGlzdG9yeS5wdXNoKHRoaXMudXJsKTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRIaXN0b3J5SW5kZXggPSB0aGlzLm5hdmlnYXRpb25IaXN0b3J5Lmxlbmd0aCAtIDE7XHJcbiAgICAgICAgdGhpcy5mcmFtZS5zcmMgPSB0aGlzLnVybDtcclxuICAgICAgICB0aGlzLnVwZGF0ZVVybERpc3BsYXkoKTtcclxuICAgIH1cclxuXHJcblxyXG5cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBnZXRDdXJyZW50VXJsKCk6IHN0cmluZyB7XHJcbiAgICAgICAgaWYgKHRoaXMuZnJhbWUgaW5zdGFuY2VvZiBIVE1MSUZyYW1lRWxlbWVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mcmFtZS5jb250ZW50V2luZG93Py5sb2NhdGlvbi5ocmVmIHx8IHRoaXMudXJsO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5mcmFtZSAmJiB0eXBlb2YgdGhpcy5mcmFtZS5nZXRVUkwgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZnJhbWUuZ2V0VVJMKCkgfHwgdGhpcy51cmw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnVybDtcclxuICAgIH1cclxuXHJcblxyXG5cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZVVybERpc3BsYXkoKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudFVybCA9IHRoaXMuZ2V0Q3VycmVudFVybCgpO1xyXG4gICAgICAgIHRoaXMudXJsID0gY3VycmVudFVybDtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuc2VhcmNoSW5wdXQpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWFyY2hJbnB1dC52YWx1ZSA9IGN1cnJlbnRVcmw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcblxyXG5cclxuICAgIHByaXZhdGUgdXBkYXRlTmF2aWdhdGlvbkJ1dHRvbnMoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuZnJhbWUgaW5zdGFuY2VvZiBIVE1MSUZyYW1lRWxlbWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLmJhY2tCdG4uZGlzYWJsZWQgPSB0aGlzLmN1cnJlbnRIaXN0b3J5SW5kZXggPD0gMDtcclxuICAgICAgICAgICAgdGhpcy5mb3J3YXJkQnRuLmRpc2FibGVkID0gdGhpcy5jdXJyZW50SGlzdG9yeUluZGV4ID49IHRoaXMubmF2aWdhdGlvbkhpc3RvcnkubGVuZ3RoIC0gMTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCB3ZWJ2aWV3ID0gdGhpcy5mcmFtZSBhcyBXZWJ2aWV3VGFnO1xyXG4gICAgICAgICAgICB0aGlzLmJhY2tCdG4uZGlzYWJsZWQgPSAhKHdlYnZpZXcuY2FuR29CYWNrPy4oKSk7XHJcbiAgICAgICAgICAgIHRoaXMuZm9yd2FyZEJ0bi5kaXNhYmxlZCA9ICEod2Vidmlldy5jYW5Hb0ZvcndhcmQ/LigpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuXHJcblxyXG5cclxuICAgIHByaXZhdGUgZ29CYWNrKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmlzRnJhbWVSZWFkeSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRpbmdTcGlubmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZnJhbWUgaW5zdGFuY2VvZiBIVE1MSUZyYW1lRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudEhpc3RvcnlJbmRleCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRIaXN0b3J5SW5kZXgtLTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZyYW1lLnNyYyA9IHRoaXMubmF2aWdhdGlvbkhpc3RvcnlbdGhpcy5jdXJyZW50SGlzdG9yeUluZGV4XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHdlYnZpZXcgPSB0aGlzLmZyYW1lIGFzIFdlYnZpZXdUYWc7XHJcbiAgICAgICAgICAgICAgICBpZiAod2Vidmlldy5jYW5Hb0JhY2s/LigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2Vidmlldy5nb0JhY2s/LigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcblxyXG5cclxuICAgIHByaXZhdGUgZ29Gb3J3YXJkKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmlzRnJhbWVSZWFkeSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRpbmdTcGlubmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZnJhbWUgaW5zdGFuY2VvZiBIVE1MSUZyYW1lRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudEhpc3RvcnlJbmRleCA8IHRoaXMubmF2aWdhdGlvbkhpc3RvcnkubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEhpc3RvcnlJbmRleCsrO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZnJhbWUuc3JjID0gdGhpcy5uYXZpZ2F0aW9uSGlzdG9yeVt0aGlzLmN1cnJlbnRIaXN0b3J5SW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgd2VidmlldyA9IHRoaXMuZnJhbWUgYXMgV2Vidmlld1RhZztcclxuICAgICAgICAgICAgICAgIGlmICh3ZWJ2aWV3LmNhbkdvRm9yd2FyZD8uKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB3ZWJ2aWV3LmdvRm9yd2FyZD8uKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuXHJcblxyXG4gICAgcHJpdmF0ZSByZWZyZXNoKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmlzRnJhbWVSZWFkeSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRpbmdTcGlubmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZnJhbWUgaW5zdGFuY2VvZiBIVE1MSUZyYW1lRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mcmFtZS5jb250ZW50V2luZG93Py5sb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZnJhbWUucmVsb2FkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbn0iLCAiZXhwb3J0IGNvbnN0IGJhc2VTZWFyY2hVcmxzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xyXG4gICAgZ29vZ2xlOiAnaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9zZWFyY2g/cT0nLFxyXG4gICAgeW91dHViZTogJ2h0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3Jlc3VsdHM/c2VhcmNoX3F1ZXJ5PScsXHJcbiAgICBiaW5nOiAnaHR0cHM6Ly93d3cuYmluZy5jb20vc2VhcmNoP3E9JyxcclxuICAgIHBlcnBsZXhpdHk6ICdodHRwczovL3d3dy5wZXJwbGV4aXR5LmFpL3NlYXJjaC9uZXc/cT0nLFxyXG4gICAgZHVja2R1Y2tnbzogJ2h0dHBzOi8vZHVja2R1Y2tnby5jb20vP3E9JyxcclxuICAgIGdlbnNwYXJrOiAnaHR0cHM6Ly93d3cuZ2Vuc3BhcmsuYWkvc2VhcmNoP3F1ZXJ5PScsXHJcbiAgICBrYWdpOiAnaHR0cHM6Ly9rYWdpLmNvbS9zZWFyY2g/cT0nLFxyXG4gICAgeWFob286ICdodHRwOi8vc2VhcmNoLnlhaG9vLmNvbS9zZWFyY2g/cD0nXHJcbn07XHJcbiIsICJpbXBvcnQgeyByZXF1ZXN0VXJsIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuZXhwb3J0IGNvbnN0IGZldGNoU3VnZ2VzdGlvbnMgPSAoXHJcbiAgICBxdWVyeTogc3RyaW5nLFxyXG4gICAgc3VnZ2VzdGlvbkNvbnRhaW5lcjogSFRNTEVsZW1lbnQsXHJcbiAgICBzdWdnZXN0aW9uc0JveDogSFRNTEVsZW1lbnQsXHJcbiAgICBzZWxlY3RTdWdnZXN0aW9uOiAoc3VnZ2VzdGlvbjogc3RyaW5nKSA9PiB2b2lkXHJcbik6IHZvaWQgPT4ge1xyXG4gICAgc3VnZ2VzdGlvbnNCb3guaW5uZXJIVE1MID0gJyc7XHJcblxyXG4gICAgaWYgKCFxdWVyeSB8fCBxdWVyeS50cmltKCkgPT09ICcnKSB7XHJcbiAgICAgICAgc3VnZ2VzdGlvbkNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICByZXF1ZXN0VXJsKHtcclxuICAgICAgICB1cmw6IGBodHRwczovL3N1Z2dlc3RxdWVyaWVzLmdvb2dsZS5jb20vY29tcGxldGUvc2VhcmNoP2NsaWVudD1jaHJvbWUmcT0ke2VuY29kZVVSSUNvbXBvbmVudChxdWVyeSl9YCxcclxuICAgICAgICBtZXRob2Q6ICdHRVQnLFxyXG4gICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgJ1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAnLFxyXG4gICAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgICAgfSxcclxuICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4ge1xyXG4gICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgIT09IDIwMCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIHN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9YCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShyZXNwb25zZS50ZXh0KTtcclxuICAgICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSBkYXRhWzFdIHx8IFtdO1xyXG5cclxuICAgICAgICAgICAgc3VnZ2VzdGlvbkNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gc3VnZ2VzdGlvbnMubGVuZ3RoID4gMCA/ICdibG9jaycgOiAnbm9uZSc7XHJcblxyXG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5mb3JFYWNoKChzdWdnZXN0aW9uOiBzdHJpbmcpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25EaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25EaXYuY2xhc3NMaXN0LmFkZCgnbmV0Q2xpcC1zdWdnZXN0aW9uLWl0ZW0nKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBpY29uU3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgICAgICAgICAgICAgIGljb25TcGFuLmNsYXNzTGlzdC5hZGQoJ3NlYXJjaF9pY29uJyk7XHJcbiAgICAgICAgICAgICAgICBpY29uU3Bhbi5pbm5lckhUTUwgPSAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIiBjbGFzcz1cImx1Y2lkZSBsdWNpZGUtc2VhcmNoXCI+PGNpcmNsZSBjeD1cIjExXCIgY3k9XCIxMVwiIHI9XCI4XCIvPjxwYXRoIGQ9XCJtMjEgMjEtNC4zLTQuM1wiLz48L3N2Zz4nO1xyXG4gICAgIFxyXG4gICAgICAgICAgICAgICAgY29uc3QgdGV4dFNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICAgICAgICAgICAgICB0ZXh0U3Bhbi50ZXh0Q29udGVudCA9IHN1Z2dlc3Rpb247XHJcblxyXG4gICAgICAgICAgICAgICAgc3VnZ2VzdGlvbkRpdi5hcHBlbmRDaGlsZChpY29uU3Bhbik7XHJcbiAgICAgICAgICAgICAgICBzdWdnZXN0aW9uRGl2LmFwcGVuZENoaWxkKHRleHRTcGFuKTtcclxuICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25EaXYub25jbGljayA9ICgpID0+IHNlbGVjdFN1Z2dlc3Rpb24oc3VnZ2VzdGlvbik7XHJcbiAgICAgICAgICAgICAgICBzdWdnZXN0aW9uc0JveC5hcHBlbmRDaGlsZChzdWdnZXN0aW9uRGl2KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwYXJzaW5nIHN1Z2dlc3Rpb25zOicsIHBhcnNlRXJyb3IpO1xyXG4gICAgICAgICAgICBzdWdnZXN0aW9uQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgfVxyXG4gICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHN1Z2dlc3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICBzdWdnZXN0aW9uQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICB9KTtcclxufTtcclxuIiwgImltcG9ydCB7IGJhc2VTZWFyY2hVcmxzIH0gZnJvbSAnLi9zZWFyY2hVcmxzJzsgIC8vIEltcG9ydCBiYXNlIHNlYXJjaCBVUkxzXHJcbmltcG9ydCB7IHJlcXVlc3RVcmwgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IGZldGNoU3VnZ2VzdGlvbnMgfSBmcm9tICcuL2ZldGNoU3VnZ2VzdGlvbnMnOyAvLyBJbXBvcnQgdGhlIGZldGNoU3VnZ2VzdGlvbnMgZnVuY3Rpb25cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgV2ViU2VhcmNoU2V0dGluZ3Mge1xyXG4gICAgc2VhcmNoRW5naW5lPzogJ2dvb2dsZScgfCAneW91dHViZScgfCAnYmluZycgfCAncGVycGxleGl0eScgfCAnZHVja2R1Y2tnbycgfCAnZ2Vuc3BhcmsnIHwgJ2thZ2knO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgV2ViU2VhcmNoIHtcclxuXHJcbiAgICBwcml2YXRlIHNlYXJjaElucHV0OiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBzdWdnZXN0aW9uc0JveDogSFRNTEVsZW1lbnQ7XHJcbiAgICBwcml2YXRlIHN1Z2dlc3Rpb25Db250YWluZXI6IEhUTUxFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50U3VnZ2VzdGlvbkluZGV4OiBudW1iZXIgPSAtMTtcclxuICAgIHByaXZhdGUgc2V0dGluZ3M6IFdlYlNlYXJjaFNldHRpbmdzO1xyXG5cclxuICAgIC8vIFVzZSB0aGUgaW1wb3J0ZWQgYmFzZVNlYXJjaFVybHNcclxuICAgIHByaXZhdGUgYmFzZVNlYXJjaFVybHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSBiYXNlU2VhcmNoVXJscztcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBzZWFyY2hJbnB1dDogSFRNTElucHV0RWxlbWVudCxcclxuICAgICAgICBzdWdnZXN0aW9uQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcclxuICAgICAgICBzdWdnZXN0aW9uc0JveDogSFRNTEVsZW1lbnQsXHJcbiAgICAgICAgc2V0dGluZ3M6IFdlYlNlYXJjaFNldHRpbmdzID0ge31cclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuc2VhcmNoSW5wdXQgPSBzZWFyY2hJbnB1dDtcclxuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Db250YWluZXIgPSBzdWdnZXN0aW9uQ29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvbnNCb3ggPSBzdWdnZXN0aW9uc0JveDtcclxuICAgICAgICB0aGlzLnNldHRpbmdzID0ge1xyXG4gICAgICAgICAgICBzZWFyY2hFbmdpbmU6ICdnb29nbGUnLFxyXG4gICAgICAgICAgICAuLi5zZXR0aW5nc1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuc2V0dXBFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2V0dXBFdmVudExpc3RlbmVycygpOiB2b2lkIHtcclxuICAgICAgICAvLyBJbnB1dCBldmVudCBmb3Igc3VnZ2VzdGlvbnNcclxuICAgICAgICB0aGlzLnNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBxdWVyeSA9IHRoaXMuc2VhcmNoSW5wdXQudmFsdWUudHJpbSgpO1xyXG4gICAgICAgICAgICBpZiAocXVlcnkgPT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGVTdWdnZXN0aW9ucygpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZmV0Y2hTdWdnZXN0aW9ucyhcclxuICAgICAgICAgICAgICAgICAgICBxdWVyeSxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Db250YWluZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWdnZXN0aW9uc0JveCxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdFN1Z2dlc3Rpb24uYmluZCh0aGlzKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBLZXlib2FyZCBuYXZpZ2F0aW9uIGZvciBzdWdnZXN0aW9uc1xyXG4gICAgICAgIHRoaXMuc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0gdGhpcy5zdWdnZXN0aW9uc0JveC5jaGlsZHJlbjtcclxuICAgICAgICAgICAgc3dpdGNoIChldmVudC5rZXkpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0Fycm93RG93bic6XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRlU3VnZ2VzdGlvbnMoJ2Rvd24nLCBzdWdnZXN0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdBcnJvd1VwJzpcclxuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmF2aWdhdGVTdWdnZXN0aW9ucygndXAnLCBzdWdnZXN0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdFbnRlcic6XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVudGVyS2V5KHN1Z2dlc3Rpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0VzY2FwZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBDbGljayBvdXRzaWRlIGhhbmRsZXIgdG8gaGlkZSBzdWdnZXN0aW9uc1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5zZWFyY2hJbnB1dC5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkgJiZcclxuICAgICAgICAgICAgICAgICF0aGlzLnN1Z2dlc3Rpb25Db250YWluZXIuY29udGFpbnMoZXZlbnQudGFyZ2V0IGFzIE5vZGUpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGVTdWdnZXN0aW9ucygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpc1ZhbGlkVXJsKHN0cjogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgbmV3IFVSTChzdHIpO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9IGNhdGNoIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNvbnN0cnVjdFNlYXJjaFVybChxdWVyeTogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICBjb25zdCBzZWxlY3RlZEVuZ2luZSA9IHRoaXMuc2V0dGluZ3Muc2VhcmNoRW5naW5lIHx8ICdnb29nbGUnO1xyXG4gICAgICAgIGNvbnN0IGJhc2VTZWFyY2hVcmwgPSB0aGlzLmJhc2VTZWFyY2hVcmxzW3NlbGVjdGVkRW5naW5lXTtcclxuICAgICAgICBjb25zdCBlbmNvZGVkUXVlcnkgPSBlbmNvZGVVUklDb21wb25lbnQocXVlcnkudHJpbSgpKTtcclxuICAgICAgICByZXR1cm4gYCR7YmFzZVNlYXJjaFVybH0ke2VuY29kZWRRdWVyeX1gO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbmF2aWdhdGVUb1F1ZXJ5KHF1ZXJ5OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgICAgIGNvbnN0IHNlYXJjaFVybCA9IHRoaXMuaXNWYWxpZFVybChxdWVyeSlcclxuICAgICAgICAgICAgPyBxdWVyeVxyXG4gICAgICAgICAgICA6IHRoaXMuY29uc3RydWN0U2VhcmNoVXJsKHF1ZXJ5KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ3NlYXJjaC1xdWVyeScsIHtcclxuICAgICAgICAgICAgZGV0YWlsOiB7IHVybDogc2VhcmNoVXJsLCBxdWVyeTogcXVlcnkgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc2VhcmNoSW5wdXQuZGlzcGF0Y2hFdmVudChldmVudCk7XHJcblxyXG4gICAgICAgIHJldHVybiBzZWFyY2hVcmw7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZWxlY3RTdWdnZXN0aW9uKHN1Z2dlc3Rpb246IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuc2VhcmNoSW5wdXQudmFsdWUgPSBzdWdnZXN0aW9uO1xyXG4gICAgICAgIHRoaXMubmF2aWdhdGVUb1F1ZXJ5KHN1Z2dlc3Rpb24pO1xyXG4gICAgICAgIHRoaXMuaGlkZVN1Z2dlc3Rpb25zKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBuYXZpZ2F0ZVN1Z2dlc3Rpb25zKGRpcmVjdGlvbjogJ3VwJyB8ICdkb3duJywgc3VnZ2VzdGlvbnM6IEhUTUxDb2xsZWN0aW9uKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHN1Z2dlc3Rpb25zLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50U3VnZ2VzdGlvbkluZGV4ICE9PSAtMSkge1xyXG4gICAgICAgICAgICBzdWdnZXN0aW9uc1t0aGlzLmN1cnJlbnRTdWdnZXN0aW9uSW5kZXhdLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZGlyZWN0aW9uID09PSAnZG93bicpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U3VnZ2VzdGlvbkluZGV4ID0gdGhpcy5jdXJyZW50U3VnZ2VzdGlvbkluZGV4IDwgc3VnZ2VzdGlvbnMubGVuZ3RoIC0gMVxyXG4gICAgICAgICAgICAgICAgPyB0aGlzLmN1cnJlbnRTdWdnZXN0aW9uSW5kZXggKyAxXHJcbiAgICAgICAgICAgICAgICA6IC0xO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFN1Z2dlc3Rpb25JbmRleCA9IHRoaXMuY3VycmVudFN1Z2dlc3Rpb25JbmRleCA+IC0xXHJcbiAgICAgICAgICAgICAgICA/IHRoaXMuY3VycmVudFN1Z2dlc3Rpb25JbmRleCAtIDFcclxuICAgICAgICAgICAgICAgIDogc3VnZ2VzdGlvbnMubGVuZ3RoIC0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFN1Z2dlc3Rpb25JbmRleCA9PT0gLTEpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWFyY2hJbnB1dC52YWx1ZSA9IHRoaXMuc2VhcmNoSW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLW9yaWdpbmFsLXZhbHVlJykgfHwgJyc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRTdWdnZXN0aW9uID0gc3VnZ2VzdGlvbnNbdGhpcy5jdXJyZW50U3VnZ2VzdGlvbkluZGV4XSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICAgICAgc2VsZWN0ZWRTdWdnZXN0aW9uLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XHJcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoSW5wdXQudmFsdWUgPSBzZWxlY3RlZFN1Z2dlc3Rpb24udGV4dENvbnRlbnQgfHwgJyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaGFuZGxlRW50ZXJLZXkoc3VnZ2VzdGlvbnM6IEhUTUxDb2xsZWN0aW9uKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFN1Z2dlc3Rpb25JbmRleCAhPT0gLTEgJiYgc3VnZ2VzdGlvbnNbdGhpcy5jdXJyZW50U3VnZ2VzdGlvbkluZGV4XSkge1xyXG4gICAgICAgICAgICAoc3VnZ2VzdGlvbnNbdGhpcy5jdXJyZW50U3VnZ2VzdGlvbkluZGV4XSBhcyBIVE1MRWxlbWVudCkuY2xpY2soKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBxdWVyeSA9IHRoaXMuc2VhcmNoSW5wdXQudmFsdWU7XHJcbiAgICAgICAgICAgIGlmIChxdWVyeSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5uYXZpZ2F0ZVRvUXVlcnkocXVlcnkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaGlkZVN1Z2dlc3Rpb25zKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBoaWRlU3VnZ2VzdGlvbnMoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uc0JveC5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICB0aGlzLmN1cnJlbnRTdWdnZXN0aW9uSW5kZXggPSAtMTtcclxuICAgIH1cclxufVxyXG4iLCAiaW1wb3J0IHsgSXRlbVZpZXcsIFdvcmtzcGFjZUxlYWYsICBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCBXZWJDbGlwcGVyUGx1Z2luIGZyb20gJy4uL21haW4nO1xyXG5pbXBvcnQgeyBXZWJWaWV3Q29tcG9uZW50IH0gZnJvbSAnLi4vd2ViVmlld0NvbXBvbmVudCc7XHJcblxyXG5leHBvcnQgY29uc3QgVklFV19UWVBFX1dPUktTUEFDRV9XRUJWSUVXID0gJ25ldENsaXBfd29ya3NwYWNlX3dlYnZpZXcnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFdvcmtzcGFjZUxlYWZXZWJWaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xyXG4gICAgcHJpdmF0ZSB3ZWJWaWV3Q29tcG9uZW50OiBXZWJWaWV3Q29tcG9uZW50O1xyXG4gICAgcHJpdmF0ZSBwbHVnaW46IFdlYkNsaXBwZXJQbHVnaW47XHJcbiAgICBwcml2YXRlIGluaXRpYWxVcmw6IHN0cmluZyA9ICcnO1xyXG4gICAgaWNvbiA9ICdnbG9iZSc7XHJcbiAgICB1cmw6IHN0cmluZyB8IHVuZGVmaW5lZDtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihsZWFmOiBXb3Jrc3BhY2VMZWFmLCBwbHVnaW46IFdlYkNsaXBwZXJQbHVnaW4pIHtcclxuICAgICAgICBzdXBlcihsZWFmKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgIH1cclxuXHJcbiAgICBzZXRVcmwodXJsOiBzdHJpbmcpIHtcclxuICAgICAgICB0aGlzLmluaXRpYWxVcmwgPSB1cmw7XHJcbiAgICAgICAgdGhpcy5yZWxvYWRXZWJWaWV3KCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Vmlld1R5cGUoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gVklFV19UWVBFX1dPUktTUEFDRV9XRUJWSUVXO1xyXG4gICAgfVxyXG5cclxuICAgIGdldERpc3BsYXlUZXh0KCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuICdXZWIgVmlldyc7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZWxvYWRXZWJWaWV3KCkge1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuZW1wdHkoKTtcclxuICAgICAgICB0aGlzLmNyZWF0ZVdlYlZpZXdDb21wb25lbnQoKTtcclxuICAgIH1cclxuXHJcbiAgICBcclxuICAgIHByaXZhdGUgY3JlYXRlV2ViVmlld0NvbXBvbmVudCgpIHtcclxuICAgICAgICB0aGlzLndlYlZpZXdDb21wb25lbnQgPSBuZXcgV2ViVmlld0NvbXBvbmVudChcclxuICAgICAgICAgICAgdGhpcy5hcHAsIFxyXG4gICAgICAgICAgICB0aGlzLmluaXRpYWxVcmwsIFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBzZWFyY2hFbmdpbmU6IHRoaXMucGx1Z2luLnNldHRpbmdzLnNlYXJjaEVuZ2luZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBhc3luYyAoY2xpcFVybCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luICYmIHR5cGVvZiB0aGlzLnBsdWdpbi5jbGlwV2VicGFnZSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmNsaXBXZWJwYWdlKGNsaXBVcmwpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdDbGlwIHdlYnBhZ2UgZnVuY3Rpb24gbm90IGF2YWlsYWJsZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICBcclxuICAgICAgICBjb25zdCBjb250YWluZXJFbCA9IHRoaXMud2ViVmlld0NvbXBvbmVudC5jcmVhdGVDb250YWluZXIoKTtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFwcGVuZENoaWxkKGNvbnRhaW5lckVsKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBvbk9wZW4oKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWwuY2hpbGRyZW5bMV0gYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5lbXB0eSgpO1xyXG4gICAgXHJcbiAgICAgICAgY29uc3Qgc3RhdGVVcmwgPSB0aGlzLmxlYWYuZ2V0Vmlld1N0YXRlKCkuc3RhdGU/LnVybDtcclxuICAgICAgICB0aGlzLmluaXRpYWxVcmwgPSAodHlwZW9mIHN0YXRlVXJsID09PSAnc3RyaW5nJyAmJiBzdGF0ZVVybCkgfHwgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVmYXVsdFdlYlVybCB8fCAnaHR0cHM6Ly9nb29nbGUuY29tJztcclxuICAgIFxyXG4gICAgICAgIHRoaXMuY3JlYXRlV2ViVmlld0NvbXBvbmVudCgpO1xyXG4gICAgfVxyXG4gICAgXHJcblxyXG4gICAgYXN5bmMgb25DbG9zZSgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmVtcHR5KCk7XHJcbiAgICB9XHJcbn0iLCAiaW1wb3J0IHsgQXBwLCBOb3RpY2UsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCBOZXRDbGlwUGx1Z2luIGZyb20gJy4vbWFpbic7XHJcbmltcG9ydCB7IENMSVBQRVJfVklFVyB9IGZyb20gJy4vdmlldy9DbGlwcGVyVmlldyc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIE5ldENsaXBTZXR0aW5ncyB7XHJcbiAgICB2aWV3UG9zaXRpb246ICdsZWZ0JyB8ICdyaWdodCcgfCAnZGVmYXVsdCc7XHJcbiAgICBkZWZhdWx0Rm9sZGVyTmFtZTogc3RyaW5nO1xyXG4gICAgZGVmYXVsdFdlYlVybDogc3RyaW5nO1xyXG4gICAgbW9kYWxXaWR0aDogc3RyaW5nO1xyXG4gICAgbW9kYWxIZWlnaHQ6IHN0cmluZztcclxuICAgIHNlYXJjaEVuZ2luZTogJ2dvb2dsZScgfCAneW91dHViZScgfCAnYmluZycgfCAncGVycGxleGl0eScgfCAnZHVja2R1Y2tnbycgfCAnZ2Vuc3BhcmsnIHwgJ2thZ2knO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTmV0Q2xpcFNldHRpbmdzID0ge1xyXG4gICAgdmlld1Bvc2l0aW9uOiAnZGVmYXVsdCcsXHJcbiAgICBkZWZhdWx0Rm9sZGVyTmFtZTogJ1NhdmVkIEFydGljbGVzJyxcclxuICAgIGRlZmF1bHRXZWJVcmw6ICdodHRwczovL2dvb2dsZS5jb20nLFxyXG4gICAgbW9kYWxXaWR0aDogJzgwdncnLFxyXG4gICAgbW9kYWxIZWlnaHQ6ICc4MHZoJyxcclxuICAgIHNlYXJjaEVuZ2luZTogJ2dvb2dsZSdcclxufTtcclxuXHJcbmV4cG9ydCBjbGFzcyBOZXRDbGlwU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG4gICAgcGx1Z2luOiBOZXRDbGlwUGx1Z2luO1xyXG4gICAgdmlld1Bvc2l0aW9uOiBzdHJpbmc7XHJcbiAgICBkZWZhdWx0Rm9sZGVyTmFtZTogc3RyaW5nO1xyXG4gICAgZGVmYXVsdFdlYlVybDogc3RyaW5nO1xyXG4gICAgbW9kYWxIZWlnaHQ6IHN0cmluZztcclxuICAgIG1vZGFsV2lkdGg6IHN0cmluZztcclxuICAgIHNlYXJjaEVuZ2luZTogJ2dvb2dsZScgfCAneW91dHViZScgfCAnYmluZycgfCAncGVycGxleGl0eScgfCAnZHVja2R1Y2tnbycgfCAnZ2Vuc3BhcmsnIHwgJ2thZ2knO1xyXG4gICAgd2ViVmlld0NvbnRyb2xzOiBhbnk7XHJcbiAgICBpZDogc3RyaW5nO1xyXG5cclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBOZXRDbGlwUGx1Z2luKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgICAgIHRoaXMuaWQgPSAnbmV0LWNsaXAtc2V0dGluZ3MnO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBkaXNwbGF5KCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdOZXRDbGlwIFNldHRpbmdzJyB9KTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdWaWV3IFBvc2l0aW9uJylcclxuICAgICAgICAgICAgLnNldERlc2MoJ0Nob29zZSB3aGVyZSB0aGUgV2ViIENsaXBwZXIgdmlldyBzaG91bGQgYXBwZWFyJylcclxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93blxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2xlZnQnLCAnTGVmdCBTaWRlYmFyJylcclxuICAgICAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdyaWdodCcsICdSaWdodCBTaWRlYmFyJylcclxuICAgICAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdkZWZhdWx0JywgJ0RlZmF1bHQgUG9zaXRpb24nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy52aWV3UG9zaXRpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogJ2xlZnQnIHwgJ3JpZ2h0JyB8ICdkZWZhdWx0JykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy52aWV3UG9zaXRpb24gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKENMSVBQRVJfVklFVyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYWN0aXZlTGVhZiA9IGxlYXZlc1swXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZUxlYWYuZGV0YWNoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5hY3RpdmF0ZVZpZXcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICk7XHJcblxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ0RlZmF1bHQgRm9sZGVyIE5hbWUnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnU2V0IHRoZSBkZWZhdWx0IGZvbGRlciB3aGVyZSBjbGlwcGVkIGFydGljbGVzIGFyZSBzYXZlZCcpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT5cclxuICAgICAgICAgICAgICAgIHRleHRcclxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIGZvbGRlciBuYW1lJylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVmYXVsdEZvbGRlck5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUudHJpbSgpID09PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnRm9sZGVyIG5hbWUgY2Fubm90IGJlIGVtcHR5LicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmRlZmF1bHRGb2xkZXJOYW1lID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnTW9kYWwgSGVpZ2h0JylcclxuICAgICAgICAgICAgLnNldERlc2MoJ1NldCB0aGUgZGVmYXVsdCBoZWlnaHQgZm9yIHRoZSB3ZWIgbW9kYWwgKHVzZSBDU1MgdW5pdHMgbGlrZSB2aCwgJSwgcHgpJylcclxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJzgwdmgnKVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vZGFsSGVpZ2h0KVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1vZGFsSGVpZ2h0ID0gdmFsdWUgfHwgJzgwdmgnO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ01vZGFsIFdpZHRoJylcclxuICAgICAgICAgICAgLnNldERlc2MoJ1NldCB0aGUgZGVmYXVsdCBoZWlnaHQgZm9yIHRoZSB3ZWIgbW9kYWwgKHVzZSBDU1MgdW5pdHMgbGlrZSB2aCwgJSwgcHgpJylcclxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJzgwdmgnKVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vZGFsV2lkdGgpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9kYWxXaWR0aCA9IHZhbHVlIHx8ICc4MHZoJztcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9KSlcclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ1NlYXJjaCBFbmdpbmUnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnQ2hvb3NlIHRoZSBkZWZhdWx0IHNlYXJjaCBlbmdpbmUgZm9yIHNlYXJjaCBxdWVyaWVzJylcclxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93blxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2dvb2dsZScsICdHb29nbGUnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ3lvdXR1YmUnLCAnWW91VHViZScpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbignYmluZycsICdCaW5nJylcclxuICAgICAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdwZXJwbGV4aXR5JywgJ1BlcnBsZXhpdHknKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2R1Y2tkdWNrZ28nLCAnRHVja2R1Y2tnbycpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbignZ2Vuc3BhcmsnLCAnR2Vuc3BhcmsnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2thZ2knLCAnS2FnaScpXHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VhcmNoRW5naW5lKSAvLyBTZXQgdGhlIGluaXRpYWwgdmFsdWVcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiAnZ29vZ2xlJyB8ICd5b3V0dWJlJyB8ICdiaW5nJyB8ICdwZXJwbGV4aXR5JyB8ICdkdWNrZHVja2dvJyB8ICdnZW5zcGFyaycgfCAna2FnaScpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NlbGVjdGVkIFNlYXJjaCBFbmdpbmU6JywgdmFsdWUpOyAvLyBEZWJ1ZyBsb2dcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VhcmNoRW5naW5lID0gdmFsdWU7IC8vIFVwZGF0ZSB0aGUgc2V0dGluZ3Mgb2JqZWN0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICk7XHJcblxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ0RlZmF1bHQgV2ViIE1vZGFsIFVSTCcpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdTZXQgdGhlIGRlZmF1bHQgVVJMIG9wZW5lZCB3aGVuIHVzaW5nIHRoZSB3ZWIgbW9kYWwvZWRpdG9yJylcclxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PlxyXG4gICAgICAgICAgICAgICAgdGV4dFxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignRW50ZXIgZGVmYXVsdCBVUkwnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWZhdWx0V2ViVXJsKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBVUkwodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVmYXVsdFdlYlVybCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2gge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnSW52YWxpZCBVUkwuIFBsZWFzZSBlbnRlciBhIHZhbGlkIFVSTC4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG4iLCAiaW1wb3J0ICBXZWJDbGlwcGVyUGx1Z2luICBmcm9tICcuL21haW4nO1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb2Nlc3NOb2RlSGVscGVyIHtcclxuXHJcbiAgcHJpdmF0ZSBwbHVnaW46IFdlYkNsaXBwZXJQbHVnaW47XHJcbiAgcHJpdmF0ZSByZWNlbnRMaW5rczogU2V0PHN0cmluZz4gPSBuZXcgU2V0KCk7XHJcbiAgcHJpdmF0ZSBzZWVuSW1hZ2VzOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoKTtcclxuICBwcml2YXRlIGZpcnN0SW1hZ2VQcm9jZXNzZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBXZWJDbGlwcGVyUGx1Z2luKSB7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICB9XHJcbiAgcmVzZXRQcm9jZXNzaW5nRmxhZ3MoKTogdm9pZCB7XHJcbiAgICB0aGlzLmZpcnN0SW1hZ2VQcm9jZXNzZWQgPSBmYWxzZTtcclxuICAgIHRoaXMuc2VlbkltYWdlcy5jbGVhcigpO1xyXG4gICAgdGhpcy5yZWNlbnRMaW5rcy5jbGVhcigpO1xyXG4gIH1cclxuICBwcm9jZXNzTm9kZShub2RlOiBOb2RlLCBiYXNlVXJsOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7XHJcbiAgICAgIHJldHVybiAobm9kZS50ZXh0Q29udGVudCB8fCAnJykudHJpbSgpO1xyXG4gICAgfVxyXG4gICAgaWYgKCEobm9kZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkge1xyXG4gICAgICByZXR1cm4gJyc7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGNvbnRlbnQgPSAnJztcclxuICAgIGNvbnN0IGVsZW1lbnQgPSBub2RlIGFzIEhUTUxFbGVtZW50O1xyXG5cclxuICAgIHN3aXRjaCAoZWxlbWVudC50YWdOYW1lKSB7XHJcbiAgICAgIGNhc2UgJ0JMT0NLUVVPVEUnOiB7XHJcbiAgICAgICAgY29uc3QgcXVvdGVDb250ZW50ID0gQXJyYXkuZnJvbShlbGVtZW50LmNoaWxkTm9kZXMpXHJcbiAgICAgICAgICAubWFwKGNoaWxkID0+IHRoaXMucHJvY2Vzc05vZGUoY2hpbGQsIGJhc2VVcmwpKVxyXG4gICAgICAgICAgLmpvaW4oJycpXHJcbiAgICAgICAgICAudHJpbSgpO1xyXG4gICAgICAgICAgICAgIGlmIChxdW90ZUNvbnRlbnQpIHtcclxuICAgICAgICAgIGNvbnRlbnQgKz0gYD4gJHtxdW90ZUNvbnRlbnQucmVwbGFjZSgvXFxuL2csICdcXG4+ICcpfVxcblxcbmA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ0EnOiB7XHJcbiAgICAgICAgY29uc3QgaHJlZiA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdocmVmJyk7XHJcbiAgICAgICAgY29uc3QgdGV4dCA9IGVsZW1lbnQudGV4dENvbnRlbnQ/LnRyaW0oKSB8fCAnJztcclxuICAgICAgICBcclxuICAgICAgICBpZiAoaHJlZiAmJiB0ZXh0KSB7XHJcbiAgICAgICAgICBjb25zdCBwcmV2aW91c1RleHROb2RlID0gZWxlbWVudC5wcmV2aW91c1NpYmxpbmc7XHJcbiAgICAgICAgICBjb25zdCBuZXh0VGV4dE5vZGUgPSBlbGVtZW50Lm5leHRTaWJsaW5nO1xyXG4gICAgICAgICAgY29uc3QgcHJlZml4U3BhY2UgPSB0aGlzLnNob3VsZEFkZFNwYWNlKHByZXZpb3VzVGV4dE5vZGUpO1xyXG4gICAgICAgICAgY29uc3Qgc3VmZml4U3BhY2UgPSB0aGlzLnNob3VsZEFkZFNwYWNlKG5leHRUZXh0Tm9kZSk7XHJcbiAgICAgICAgICBjb25zdCBhYnNvbHV0ZUxpbmsgPSB0aGlzLnJlc29sdmVVcmwoYmFzZVVybCwgaHJlZik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICBpZiAoIXRoaXMuaXNSZXBlYXRlZExpbmsodGV4dCwgYWJzb2x1dGVMaW5rKSkge1xyXG4gICAgICAgICAgICBjb250ZW50ICs9IGAke3ByZWZpeFNwYWNlfVske3RleHR9XSgke2Fic29sdXRlTGlua30pJHtzdWZmaXhTcGFjZX1gO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjYXNlICdTVFJPTkcnOiB7XHJcbiAgICAgICAgY29udGVudCArPSBgKioke0FycmF5LmZyb20oZWxlbWVudC5jaGlsZE5vZGVzKVxyXG4gICAgICAgICAgLm1hcChjaGlsZCA9PiB0aGlzLnByb2Nlc3NOb2RlKGNoaWxkLCBiYXNlVXJsKSlcclxuICAgICAgICAgIC5qb2luKCcnKX0qKmA7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgY2FzZSAnRU0nOiB7XHJcbiAgICAgICAgY29udGVudCArPSBgKiR7QXJyYXkuZnJvbShlbGVtZW50LmNoaWxkTm9kZXMpXHJcbiAgICAgICAgICAubWFwKGNoaWxkID0+IHRoaXMucHJvY2Vzc05vZGUoY2hpbGQsIGJhc2VVcmwpKVxyXG4gICAgICAgICAgLmpvaW4oJycpfSpgO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ0gxJzoge1xyXG4gICAgICAgIGNvbnRlbnQgKz0gYCMgJHtBcnJheS5mcm9tKGVsZW1lbnQuY2hpbGROb2RlcylcclxuICAgICAgICAgIC5tYXAoY2hpbGQgPT4gdGhpcy5wcm9jZXNzTm9kZShjaGlsZCwgYmFzZVVybCkpXHJcbiAgICAgICAgICAuam9pbignJyl9XFxuXFxuYDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjYXNlICdIMic6IHtcclxuICAgICAgICBjb250ZW50ICs9IGAjIyAke0FycmF5LmZyb20oZWxlbWVudC5jaGlsZE5vZGVzKVxyXG4gICAgICAgICAgLm1hcChjaGlsZCA9PiB0aGlzLnByb2Nlc3NOb2RlKGNoaWxkLCBiYXNlVXJsKSlcclxuICAgICAgICAgIC5qb2luKCcnKX1cXG5cXG5gO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ0gzJzoge1xyXG4gICAgICAgIGNvbnRlbnQgKz0gYCMjIyAke0FycmF5LmZyb20oZWxlbWVudC5jaGlsZE5vZGVzKVxyXG4gICAgICAgICAgLm1hcChjaGlsZCA9PiB0aGlzLnByb2Nlc3NOb2RlKGNoaWxkLCBiYXNlVXJsKSlcclxuICAgICAgICAgIC5qb2luKCcnKX1cXG5cXG5gO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ0g0Jzoge1xyXG4gICAgICAgIGNvbnRlbnQgKz0gYCMjIyMgJHtBcnJheS5mcm9tKGVsZW1lbnQuY2hpbGROb2RlcylcclxuICAgICAgICAgIC5tYXAoY2hpbGQgPT4gdGhpcy5wcm9jZXNzTm9kZShjaGlsZCwgYmFzZVVybCkpXHJcbiAgICAgICAgICAuam9pbignJyl9XFxuXFxuYDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjYXNlICdINSc6IHtcclxuICAgICAgICBjb250ZW50ICs9IGAjIyMjIyAke0FycmF5LmZyb20oZWxlbWVudC5jaGlsZE5vZGVzKVxyXG4gICAgICAgICAgLm1hcChjaGlsZCA9PiB0aGlzLnByb2Nlc3NOb2RlKGNoaWxkLCBiYXNlVXJsKSlcclxuICAgICAgICAgIC5qb2luKCcnKX1cXG5cXG5gO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ0g2Jzoge1xyXG4gICAgICAgIGNvbnRlbnQgKz0gYCMjIyMjIyAke0FycmF5LmZyb20oZWxlbWVudC5jaGlsZE5vZGVzKVxyXG4gICAgICAgICAgLm1hcChjaGlsZCA9PiB0aGlzLnByb2Nlc3NOb2RlKGNoaWxkLCBiYXNlVXJsKSlcclxuICAgICAgICAgIC5qb2luKCcnKX1cXG5cXG5gO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ1RBQkxFJzoge1xyXG4gICAgICAgIGNvbnRlbnQgKz0gdGhpcy5wcm9jZXNzVGFibGVFbGVtZW50KGVsZW1lbnQgYXMgSFRNTFRhYmxlRWxlbWVudCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgY2FzZSAnVUwnOiB7XHJcbiAgICAgICAgY29udGVudCArPSBBcnJheS5mcm9tKGVsZW1lbnQuY2hpbGROb2RlcylcclxuICAgICAgICAgIC5tYXAoY2hpbGQgPT4gdGhpcy5wcm9jZXNzTm9kZShjaGlsZCwgYmFzZVVybCkpXHJcbiAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS50cmltKCkpXHJcbiAgICAgICAgICAubWFwKGl0ZW0gPT4gYC0gJHtpdGVtLnRyaW0oKX1gKVxyXG4gICAgICAgICAgLmpvaW4oJ1xcbicpICsgJ1xcblxcbic7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgY2FzZSAnT0wnOiB7XHJcbiAgICAgICAgY29udGVudCArPSBBcnJheS5mcm9tKGVsZW1lbnQuY2hpbGROb2RlcylcclxuICAgICAgICAgIC5tYXAoY2hpbGQgPT4gdGhpcy5wcm9jZXNzTm9kZShjaGlsZCwgYmFzZVVybCkpXHJcbiAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS50cmltKCkpXHJcbiAgICAgICAgICAubWFwKGl0ZW0gPT4gYC0gJHtpdGVtLnRyaW0oKX1gKVxyXG4gICAgICAgICAgLmpvaW4oJ1xcbicpICsgJ1xcblxcbic7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgY2FzZSAnUCc6IHtcclxuICAgICAgICBjb250ZW50ICs9IEFycmF5LmZyb20oZWxlbWVudC5jaGlsZE5vZGVzKVxyXG4gICAgICAgICAgLm1hcChjaGlsZCA9PiB0aGlzLnByb2Nlc3NOb2RlKGNoaWxkLCBiYXNlVXJsKSlcclxuICAgICAgICAgIC5qb2luKCcnKSArICdcXG5cXG4nO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ0JSJzoge1xyXG4gICAgICAgIGNvbnRlbnQgKz0gJ1xcbic7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgY2FzZSAnSFInOiB7XHJcbiAgICAgICAgY29udGVudCArPSAnLS0tXFxuXFxuJztcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjYXNlICdJTUcnOiB7XHJcbiAgICAgICAgY29uc3QgaW1nU3JjID0gdGhpcy5yZXNvbHZlSW1hZ2VTcmMobm9kZSBhcyBIVE1MSW1hZ2VFbGVtZW50LCBiYXNlVXJsKTtcclxuICAgICAgICBpZiAoaW1nU3JjKSB7XHJcbiAgICAgICAgICBjb25zdCBhbHRUZXh0ID0gKG5vZGUgYXMgSFRNTEltYWdlRWxlbWVudCkuZ2V0QXR0cmlidXRlKCdhbHQnKSB8fCAnSW1hZ2UnO1xyXG4gIFxyXG4gICAgICAgICAgaWYgKChub2RlIGFzIEhUTUxJbWFnZUVsZW1lbnQpLmNsb3Nlc3QoJy5oZWFkaW5nLFtjbGFzcyo9XCJ0aHVtYm5haWxJbWFnZVwiXScpIHx8IFxyXG4gICAgICAgICAgICAgIGFsdFRleHQudG9Mb3dlckNhc2UoKSA9PT0gJ2hlYWRpbmcnKSB7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgfVxyXG4gIFxyXG4gICAgICAgICAgaWYgKCF0aGlzLmZpcnN0SW1hZ2VQcm9jZXNzZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5maXJzdEltYWdlUHJvY2Vzc2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcbiAgXHJcbiAgICAgICAgICBpZiAoIXRoaXMuc2VlbkltYWdlcy5oYXMoaW1nU3JjKSkge1xyXG4gICAgICAgICAgICBjb250ZW50ICs9IGAhWyR7YWx0VGV4dH1dKCR7aW1nU3JjfSlcXG5cXG5gO1xyXG4gICAgICAgICAgICB0aGlzLnNlZW5JbWFnZXMuYWRkKGltZ1NyYyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjYXNlICdGSUdDQVBUSU9OJzoge1xyXG4gICAgICAgIGNvbnRlbnQgKz0gYCoke0FycmF5LmZyb20oZWxlbWVudC5jaGlsZE5vZGVzKVxyXG4gICAgICAgICAgLm1hcChjaGlsZCA9PiB0aGlzLnByb2Nlc3NOb2RlKGNoaWxkLCBiYXNlVXJsKSlcclxuICAgICAgICAgIC5qb2luKCcnKX0qXFxuXFxuYDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjYXNlICdJRlJBTUUnOiB7XHJcbiAgICAgICAgY29uc3QgaWZyYW1lU3JjID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3NyYycpO1xyXG4gICAgICAgIGNvbnN0IGlmcmFtZVRpdGxlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3RpdGxlJykgfHwgJ0VtYmVkZGVkIFZpZGVvL0NvbnRlbnQnO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChpZnJhbWVTcmMpIHtcclxuICAgIFxyXG4gICAgICBcclxuICAgICAgICAgIGNvbnRlbnQgKz0gYDxpZnJhbWUgc3JjPVwiJHtpZnJhbWVTcmN9XCIgdGl0bGU9XCIke2lmcmFtZVRpdGxlfVwiPjwvaWZyYW1lPlxcblxcbmA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBjYXNlICdDT0RFJzoge1xyXG4gICAgICAgIGNvbnN0IGNvZGVDb250ZW50ID0gZWxlbWVudC50ZXh0Q29udGVudCB8fCAnJztcclxuICAgICAgICBjb250ZW50ICs9IGBcXGBcXGBcXGBcXG4ke2NvZGVDb250ZW50LnRyaW0oKX1cXG5cXGBcXGBcXGBcXG5cXG5gO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ1BSRSc6IHtcclxuICAgICAgICBjb25zdCBwcmVDb250ZW50ID0gQXJyYXkuZnJvbShlbGVtZW50LmNoaWxkTm9kZXMpXHJcbiAgICAgICAgICAubWFwKGNoaWxkID0+IHRoaXMucHJvY2Vzc05vZGUoY2hpbGQsIGJhc2VVcmwpKVxyXG4gICAgICAgICAgLmpvaW4oJycpO1xyXG4gICAgICAgIGNvbnRlbnQgKz0gYFxcYFxcYFxcYFxcbiR7cHJlQ29udGVudC50cmltKCl9XFxuXFxgXFxgXFxgXFxuXFxuYDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBkZWZhdWx0OiB7XHJcbiAgICAgICAgY29udGVudCArPSBBcnJheS5mcm9tKGVsZW1lbnQuY2hpbGROb2RlcylcclxuICAgICAgICAgIC5tYXAoY2hpbGQgPT4gdGhpcy5wcm9jZXNzTm9kZShjaGlsZCwgYmFzZVVybCkpXHJcbiAgICAgICAgICAuam9pbignJyk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBjb250ZW50O1xyXG4gIH1cclxuXHJcblxyXG5cclxuXHJcblxyXG4gIHByaXZhdGUgc2hvdWxkQWRkU3BhY2Uobm9kZTogTm9kZSB8IG51bGwpOiBzdHJpbmcge1xyXG4gICAgaWYgKCFub2RlKSByZXR1cm4gJyc7XHJcbiAgICBcclxuICAgIGlmIChub2RlLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSkge1xyXG4gICAgICBjb25zdCB0ZXh0ID0gbm9kZS50ZXh0Q29udGVudD8udHJpbSgpIHx8ICcnO1xyXG4gICAgICByZXR1cm4gdGV4dCAmJiAhdGV4dC5lbmRzV2l0aCgnICcpID8gJyAnIDogJyc7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiAnJztcclxuICB9XHJcbiAgICBcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuICBwcml2YXRlIGlzUmVwZWF0ZWRMaW5rKHRleHQ6IHN0cmluZywgbGluazogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCBsaW5rS2V5ID0gYCR7dGV4dH06JHtsaW5rfWA7XHJcbiAgICBpZiAodGhpcy5yZWNlbnRMaW5rcy5oYXMobGlua0tleSkpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICB0aGlzLnJlY2VudExpbmtzLmFkZChsaW5rS2V5KTtcclxuICAgIGlmICh0aGlzLnJlY2VudExpbmtzLnNpemUgPiAxMCkge1xyXG4gICAgICBjb25zdCBvbGRlc3RMaW5rID0gdGhpcy5yZWNlbnRMaW5rcy52YWx1ZXMoKS5uZXh0KCkudmFsdWU7XHJcbiAgICAgIHRoaXMucmVjZW50TGlua3MuZGVsZXRlKG9sZGVzdExpbmspO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuICBwcml2YXRlIHJlc29sdmVJbWFnZVNyYyhpbWc6IEhUTUxJbWFnZUVsZW1lbnQsIGJhc2VVcmw6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBwb3NzaWJsZVNyY0F0dHJpYnV0ZXMgPSBbXHJcbiAgICAgICdkYXRhLXNyYycsICdzcmMnLCAnZGF0YS1vcmlnaW5hbCcsXHJcbiAgICAgICdkYXRhLWxhenknLCAnZGF0YS1mYWxsYmFjay1zcmMnLFxyXG4gICAgICAnc3Jjc2V0JyBcclxuICAgIF07XHJcbiAgXHJcbiAgICBmb3IgKGNvbnN0IGF0dHIgb2YgcG9zc2libGVTcmNBdHRyaWJ1dGVzKSB7XHJcbiAgICAgIGxldCBzcmMgPSBpbWcuZ2V0QXR0cmlidXRlKGF0dHIpO1xyXG4gICAgICBcclxuICAgICAgaWYgKGF0dHIgPT09ICdkYXRhLXNyYycgJiYgIXNyYykge1xyXG4gICAgICAgIHNyYyA9IGltZy5nZXRBdHRyaWJ1dGUoJ3NyYycpO1xyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIGlmIChhdHRyID09PSAnc3Jjc2V0JyAmJiBzcmMpIHtcclxuICAgICAgICBzcmMgPSBzcmMuc3BsaXQoJywnKVswXS50cmltKCkuc3BsaXQoJyAnKVswXTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgaWYgKHNyYykge1xyXG4gICAgICAgIGlmIChzcmMuc3RhcnRzV2l0aCgnZGF0YTonKSB8fCBzcmMuc3RhcnRzV2l0aCgnaHR0cCcpKSB7XHJcbiAgICAgICAgICByZXR1cm4gc3JjO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXNvbHZlVXJsKGJhc2VVcmwsIHNyYyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiAnJztcclxuICB9XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuICBwcml2YXRlIHByb2Nlc3NUYWJsZUVsZW1lbnQodGFibGVFbGVtZW50OiBIVE1MVGFibGVFbGVtZW50KTogc3RyaW5nIHtcclxuICAgIGxldCB0YWJsZUNvbnRlbnQgPSAnXFxuXFxuJztcclxuICAgIGNvbnN0IHRoZWFkID0gdGFibGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3RoZWFkJyk7XHJcbiAgICBjb25zdCB0Ym9keSA9IHRhYmxlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCd0Ym9keScpO1xyXG5cclxuICAgIGlmICh0aGVhZCkge1xyXG4gICAgICBjb25zdCBoZWFkZXJSb3dzID0gdGhlYWQucXVlcnlTZWxlY3RvckFsbCgndHInKTtcclxuICAgICAgaGVhZGVyUm93cy5mb3JFYWNoKHJvdyA9PiB7XHJcbiAgICAgICAgY29uc3QgaGVhZGVyQ2VsbHMgPSBBcnJheS5mcm9tKHJvdy5xdWVyeVNlbGVjdG9yQWxsKCd0aCx0ZCcpKTtcclxuICAgICAgICBjb25zdCBoZWFkZXJDb250ZW50ID0gaGVhZGVyQ2VsbHNcclxuICAgICAgICAgIC5tYXAoY2VsbCA9PiBjZWxsLnRleHRDb250ZW50Py50cmltKCkucmVwbGFjZSgvXFx8L2csICdcXFxcfCcpIHx8ICcnKVxyXG4gICAgICAgICAgLmpvaW4oJ3wnKTtcclxuICAgICAgICBjb25zdCBoZWFkZXJTZXBhcmF0b3IgPSBoZWFkZXJDZWxscy5tYXAoKCkgPT4gJy0tLScpLmpvaW4oJ3wnKTtcclxuICAgICAgICB0YWJsZUNvbnRlbnQgKz0gYCR7aGVhZGVyQ29udGVudH1cXG4ke2hlYWRlclNlcGFyYXRvcn1cXG5gO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcblxyXG5cclxuICAgIGNvbnN0IGJvZHlSb3dzID0gdGJvZHlcclxuICAgICAgPyB0Ym9keS5xdWVyeVNlbGVjdG9yQWxsKCd0cicpXHJcbiAgICAgIDogdGFibGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyJyk7XHJcblxyXG4gICAgYm9keVJvd3MuZm9yRWFjaCgocm93LCBpbmRleCkgPT4ge1xyXG4gICAgICBpZiAodGhlYWQgJiYgaW5kZXggPCB0aGVhZC5xdWVyeVNlbGVjdG9yQWxsKCd0cicpLmxlbmd0aCkgcmV0dXJuO1xyXG5cclxuICAgICAgY29uc3QgY2VsbHMgPSBBcnJheS5mcm9tKHJvdy5xdWVyeVNlbGVjdG9yQWxsKCd0aCx0ZCcpKTtcclxuICAgICAgY29uc3Qgcm93Q29udGVudCA9IGNlbGxzXHJcbiAgICAgICAgLm1hcChjZWxsID0+IGNlbGwudGV4dENvbnRlbnQ/LnRyaW0oKS5yZXBsYWNlKC9cXHwvZywgJ1xcXFx8JykgfHwgJycpXHJcbiAgICAgICAgLmpvaW4oJ3wnKTtcclxuXHJcbiAgICAgIHRhYmxlQ29udGVudCArPSBgJHtyb3dDb250ZW50fVxcbmA7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0YWJsZUNvbnRlbnQgKz0gJ1xcbic7XHJcbiAgICByZXR1cm4gdGFibGVDb250ZW50O1xyXG4gIH1cclxuXHJcblxyXG5cclxuXHJcbiAgcHJpdmF0ZSByZXNvbHZlVXJsKGJhc2U6IHN0cmluZywgcmVsYXRpdmU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICB0cnkge1xyXG4gICAgICByZXR1cm4gbmV3IFVSTChyZWxhdGl2ZSwgYmFzZSkudG9TdHJpbmcoKTtcclxuICAgIH0gY2F0Y2gge1xyXG4gICAgICByZXR1cm4gcmVsYXRpdmU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxufSIsICJpbXBvcnQgV2ViQ2xpcHBlclBsdWdpbiBmcm9tICcuL21haW4nO1xyXG5pbXBvcnQgeyBQcm9jZXNzTm9kZUhlbHBlciB9IGZyb20gJy4vaGVscGVyJztcclxuXHJcbmV4cG9ydCBjbGFzcyBDb250ZW50RXh0cmFjdG9ycyB7XHJcbiAgcHJpdmF0ZSBwbHVnaW46IFdlYkNsaXBwZXJQbHVnaW47XHJcbiAgcHJpdmF0ZSBwcm9jZXNzTm9kZUhlbHBlcjogUHJvY2Vzc05vZGVIZWxwZXI7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogV2ViQ2xpcHBlclBsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICB0aGlzLnByb2Nlc3NOb2RlSGVscGVyID0gbmV3IFByb2Nlc3NOb2RlSGVscGVyKHBsdWdpbik7XHJcbiAgfVxyXG5cclxuICBleHRyYWN0TWFpbkNvbnRlbnQoZG9jOiBEb2N1bWVudCwgYmFzZVVybDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIHRoaXMucHJvY2Vzc05vZGVIZWxwZXIucmVzZXRQcm9jZXNzaW5nRmxhZ3MoKTtcclxuXHJcbiAgICBjb25zdCBtYWluU2VsZWN0b3JzID0gW1xyXG4gICAgICAnbWFpbicsICdhcnRpY2xlJywgJy5tYWluLWNvbnRlbnQnLCAnI21haW4tY29udGVudCcsXHJcbiAgICAgICcuZW50cnktY29udGVudCcsICcjcHJvZHVjdERlc2NyaXB0aW9uJywgJyNmZWF0dXJlLWJ1bGxldHMnLCAnLm1hcmtkb3duJywnW2NsYXNzKj1cImJsb2dcIl0nLFxyXG4gICAgICAnI2NlbnRlckNvbCcsICcuYS1zZWN0aW9uLmEtc3BhY2luZy1ub25lJywgJy5CbG9nJywgJ1tjbGFzcyo9XCJibG9nXCJdJ1xyXG4gICAgXTtcclxuXHJcblxyXG4gICAgbGV0IG1haW5Db250ZW50ID0gdGhpcy5maW5kTWFpbkNvbnRlbnRFbGVtZW50KGRvYywgbWFpblNlbGVjdG9ycyk7XHJcblxyXG4gICAgdGhpcy5yZW1vdmVVbm5lY2Vzc2FyeUVsZW1lbnRzKG1haW5Db250ZW50KTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5wcm9jZXNzTm9kZUhlbHBlci5wcm9jZXNzTm9kZShtYWluQ29udGVudCwgYmFzZVVybClcclxuICAgICAgLnJlcGxhY2UoL1xcbns1LH0vZywgJ1xcblxcbicpXHJcbiAgICAgIC50cmltKCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGZpbmRNYWluQ29udGVudEVsZW1lbnQoZG9jOiBEb2N1bWVudCwgc2VsZWN0b3JzOiBzdHJpbmdbXSk6IEVsZW1lbnQge1xyXG4gICAgZm9yIChjb25zdCBzZWxlY3RvciBvZiBzZWxlY3RvcnMpIHtcclxuICAgICAgY29uc3QgY29udGVudCA9IGRvYy5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxuICAgICAgaWYgKGNvbnRlbnQpIHJldHVybiBjb250ZW50O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRvYy5ib2R5O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSByZW1vdmVVbm5lY2Vzc2FyeUVsZW1lbnRzKG1haW5Db250ZW50OiBFbGVtZW50KTogdm9pZCB7XHJcblxyXG4gICAgbWFpbkNvbnRlbnQucXVlcnlTZWxlY3RvckFsbCgnKicpLmZvckVhY2goZWwgPT4ge1xyXG4gICAgICBpZiAoZWwuY2xhc3NOYW1lICYmIC9cXGJyZWxhdGVkXFxiL2kudGVzdChlbC5jbGFzc05hbWUpKSB7XHJcbiAgICAgICAgZWwucmVtb3ZlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5jb25zdCBlbGVtZW50c1RvUmVtb3ZlID0gW1xyXG4gICdzY3JpcHQnLCAnc3R5bGUnLCAnc3ZnJywgJ25hdicsICdmb290ZXInLCAnaGVhZGVyJywgJ2FzaWRlJywgXHJcbiAgJ1tjbGFzcyo9XCJmb290ZXJcIl0nLCAnW2NsYXNzKj1cIm5hdlwiXScsICdbY2xhc3MqPVwic2lkZWJhclwiXScsICdbY2xhc3MqPVwic3RpY2t5XCJdJyxcclxuICAnLmFkLWNvbnRhaW5lcicsICcuYWR2ZXJ0aXNlbWVudCcsICcuY29va2llLWNvbnNlbnQnLCAnLm1lbnUnLCAnW2NsYXNzKj1cIm1lbnVcIl0nLFxyXG4gICcudGFncycsICdbY2xhc3MqPVwidGFnc1wiXScsICdbY2xhc3MqPVwicG9wdXBcIl0nLCAnW2NsYXNzKj1cInJlbGF0ZWRcIl0nLCAnLnJlbGF0ZWQnLFxyXG4gICdbY2xhc3MqPVwiaGVhZGVyXCJdJywgJ1tjbGFzcyo9XCJuZXdzbGV0dGVyXCJdJywgJ1tjbGFzcyo9XCJmb3JtXCJdJywgJ1thcmlhLWxhYmVsPVwiTmF2aWdhdGlvblwiXScsXHJcbiAgJ1tjbGFzcyo9XCJzaGFyZVwiXScsICdbY2xhc3MqPVwiYXV0aG9yXCJdJywgJy5yZWFkLW5leHQnLCAnW2NsYXNzKj1cInJlYWQtbmV4dFwiXScsXHJcbiAgJ1tkYXRhLW1vZHVsZT1cIm5ld3NsZXR0ZXJcIl0nLCAnW2RhdGEtY29tcG9uZW50PVwibmF2aWdhdGlvblwiXScsICdbY2xhc3MqPVwiaWNvblwiXScsICcuZmxleC1jb2wnXHJcbl0uam9pbignLCcpO1xyXG5cclxuY29uc3QgcHJlc2VydmVkVGFncyA9IFtcclxuICAnbWFpbicsICdhcnRpY2xlJywgJ1tjbGFzcyo9XCJhcnRpY2xlXCJdJywgJ1tjbGFzcyo9XCJtYWluXCJdJywgJy5hcnRpY2xlJyxcclxuICAncCcsICdpbWcnLCAndWwnLCAnb2wnLCAnW2NsYXNzKj1cImJsb2dcIl0nLCAnLmVudHJ5LWNvbnRlbnQnLCAnLkJsb2cnLFxyXG4gICdoZWFkZXInXHJcbl07XHJcblxyXG5cclxuICAgIC8vIFJlbW92ZSBlbGVtZW50c1xyXG4gICAgbWFpbkNvbnRlbnQucXVlcnlTZWxlY3RvckFsbChlbGVtZW50c1RvUmVtb3ZlKS5mb3JFYWNoKGVsID0+IHtcclxuICAgICAgY29uc3QgdGFnTmFtZSA9IGVsLnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcclxuICAgICAgaWYgKCFwcmVzZXJ2ZWRUYWdzLmluY2x1ZGVzKHRhZ05hbWUpKSB7XHJcbiAgICAgICAgZWwucmVtb3ZlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG5cclxuXHJcblxyXG4gIGV4dHJhY3REZXNjcmlwdGlvbihkb2M6IERvY3VtZW50KTogc3RyaW5nIHwgbnVsbCB7XHJcbiAgICBjb25zdCBtZXRhRGVzY3JpcHRpb24gPSBkb2MucXVlcnlTZWxlY3RvcignbWV0YVtuYW1lPVwiZGVzY3JpcHRpb25cIl0nKT8uZ2V0QXR0cmlidXRlKCdjb250ZW50Jyk7XHJcbiAgICBjb25zdCBvZ0Rlc2NyaXB0aW9uID0gZG9jLnF1ZXJ5U2VsZWN0b3IoJ21ldGFbcHJvcGVydHk9XCJvZzpkZXNjcmlwdGlvblwiXScpPy5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnKTtcclxuXHJcbiAgICBjb25zdCBkZXNjcmlwdGlvbiA9IG1ldGFEZXNjcmlwdGlvbiB8fCBvZ0Rlc2NyaXB0aW9uO1xyXG4gICAgcmV0dXJuIGRlc2NyaXB0aW9uID8gZGVzY3JpcHRpb24ucmVwbGFjZSgvWzw+I1wiXS9nLCAnJykudHJpbSgpIDogbnVsbDtcclxuICB9XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiAgZXh0cmFjdFRodW1ibmFpbChkb2M6IERvY3VtZW50KTogc3RyaW5nIHtcclxuICAgIGNvbnN0IG9nSW1hZ2VUYWcgPSBkb2MucXVlcnlTZWxlY3RvcignbWV0YVtwcm9wZXJ0eT1cIm9nOmltYWdlXCJdJyk7XHJcbiAgICBjb25zdCBhbWF6b25JbWFnZSA9IGRvYy5xdWVyeVNlbGVjdG9yKCcuYS1keW5hbWljLWltYWdlJyk7XHJcblxyXG4gICAgY29uc3Qgb2dJbWFnZSA9IG9nSW1hZ2VUYWc/LmdldEF0dHJpYnV0ZSgnY29udGVudCcpO1xyXG4gICAgY29uc3QgYW1hem9uSW1hZ2VTcmMgPSBhbWF6b25JbWFnZT8uZ2V0QXR0cmlidXRlKCdzcmMnKTtcclxuXHJcbiAgICByZXR1cm4gb2dJbWFnZSB8fCBhbWF6b25JbWFnZVNyYyB8fCAnJztcclxuICB9XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuICBcclxuICBleHRyYWN0UHVibGlzaFRpbWUoZG9jOiBEb2N1bWVudCk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBwdWJsaXNoRGF0ZSA9IGRvYy5xdWVyeVNlbGVjdG9yKCdtZXRhW3Byb3BlcnR5PVwiYXJ0aWNsZTpwdWJsaXNoZWRfdGltZVwiXScpPy5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnKTtcclxuICAgIHJldHVybiBwdWJsaXNoRGF0ZSB8fCAnJztcclxuICB9XHJcblxyXG5cclxuXHJcblxyXG5cclxuICBleHRyYWN0QXV0aG9yKGRvYzogRG9jdW1lbnQpOiBzdHJpbmcgfCBudWxsIHtcclxuICAgIGNvbnN0IGF1dGhvck1ldGEgPSBkb2MucXVlcnlTZWxlY3RvcignbWV0YVtuYW1lPVwiYXV0aG9yXCJdJyk/LmdldEF0dHJpYnV0ZSgnY29udGVudCcpO1xyXG4gICAgY29uc3QgYXV0aG9yRWxlbWVudCA9IEFycmF5LmZyb20oXHJcbiAgICAgIGRvYy5xdWVyeVNlbGVjdG9yQWxsKCdbY2xhc3MqPVwiQXV0aG9yXCJdLFtjbGFzcyo9XCJhdXRob3JcIl0sW2lkKj1cIkF1dGhvclwiXSxbaWQqPVwiYXV0aG9yXCJdJylcclxuICAgICkuZmluZChlbCA9PiBlbC50ZXh0Q29udGVudD8udHJpbSgpKTtcclxuXHJcbiAgICBjb25zdCBieWxpbmUgPSBhdXRob3JFbGVtZW50Py50ZXh0Q29udGVudD8udHJpbSgpO1xyXG4gICAgY29uc3QgcG9zc2libGVPcmcgPSBkb2MucXVlcnlTZWxlY3RvcignbWV0YVtuYW1lPVwicHVibGlzaGVyXCJdLG1ldGFbcHJvcGVydHk9XCJvZzpzaXRlX25hbWVcIl0nKT8uZ2V0QXR0cmlidXRlKCdjb250ZW50Jyk7XHJcblxyXG4gICAgcmV0dXJuIGF1dGhvck1ldGEgfHwgYnlsaW5lIHx8IHBvc3NpYmxlT3JnIHx8IFwiXCI7XHJcbiAgfVxyXG5cclxuXHJcblxyXG5cclxuICBcclxuICBleHRyYWN0UHJpY2UoZG9jOiBEb2N1bWVudCk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgY29uc3QgcHJpY2VTZWxlY3RvcnMgPSBbXHJcbiAgICAgICcucHJpY2UnLCAnbWV0YVtpdGVtcHJvcD1cInByaWNlXCJdJywgJy5jdXJyZW50LXByaWNlJyxcclxuICAgICAgJy54LXByaWNlLXByaW1hcnknLCAnLnByaWNlVG9QYXknLCAnLmEtcHJpY2UnXHJcbiAgICBdO1xyXG5cclxuICAgIGZvciAoY29uc3Qgc2VsZWN0b3Igb2YgcHJpY2VTZWxlY3RvcnMpIHtcclxuICAgICAgY29uc3QgcHJpY2VFbGVtZW50ID0gZG9jLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xyXG4gICAgICBpZiAocHJpY2VFbGVtZW50KSB7XHJcbiAgICAgICAgcmV0dXJuIHByaWNlRWxlbWVudC50ZXh0Q29udGVudD8udHJpbSgpIHx8IG51bGw7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgXHJcblxyXG5cclxuXHJcbiAgZXh0cmFjdEJyYW5kKGRvYzogRG9jdW1lbnQpOiBzdHJpbmcgfCBudWxsIHtcclxuICAgIGNvbnN0IGJyYW5kU2VsZWN0b3JzID0gWycjYnlsaW5lSW5mbyddO1xyXG5cclxuICAgIGZvciAoY29uc3Qgc2VsZWN0b3Igb2YgYnJhbmRTZWxlY3RvcnMpIHtcclxuICAgICAgY29uc3QgYnJhbmRFbGVtZW50ID0gZG9jLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xyXG4gICAgICBpZiAoYnJhbmRFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgYnJhbmRUZXh0ID0gYnJhbmRFbGVtZW50LnRleHRDb250ZW50Py50cmltKCkgfHwgJyc7XHJcbiAgICAgICAgY29uc3QgYnJhbmRMaW5rRWxlbWVudCA9IGJyYW5kRWxlbWVudC5xdWVyeVNlbGVjdG9yKCdhJyk7XHJcbiAgICAgICAgY29uc3QgYnJhbmRMaW5rID0gYnJhbmRMaW5rRWxlbWVudD8uZ2V0QXR0cmlidXRlKCdocmVmJyk7XHJcblxyXG4gICAgICAgIGlmIChicmFuZExpbmspIHtcclxuICAgICAgICAgIGNvbnN0IGFic29sdXRlQnJhbmRMaW5rID0gdGhpcy5yZXNvbHZlVXJsKGJyYW5kTGluaywgd2luZG93LmxvY2F0aW9uLmhyZWYpO1xyXG4gICAgICAgICAgcmV0dXJuIGBbJHticmFuZFRleHR9XSgke2Fic29sdXRlQnJhbmRMaW5rfSlgO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGJyYW5kVGV4dDtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuXHJcblxyXG5cclxuXHJcbiAgZXh0cmFjdFJhdGluZyhkb2M6IERvY3VtZW50KTogc3RyaW5nIHwgbnVsbCB7XHJcbiAgICBjb25zdCByYXRpbmdTZWxlY3RvcnMgPSBbXHJcbiAgICAgICAgJyNhY3JQb3BvdmVyJywgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICdtZXRhW2l0ZW1wcm9wPVwicmF0aW5nXCJdJywgICAgICAgIFxyXG4gICAgICAgICdtZXRhW2l0ZW1wcm9wPVwicmV2aWV3XCJdJywgICAgICBcclxuICAgICAgICAnLmF2ZXJhZ2UtcmF0aW5nJywgICAgICAgICAgICAgICBcclxuICAgICAgICAnLnN0YXItcmF0aW5nJywgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICdbY2xhc3MqPVwicmF0aW5nXCJdJywgICAgICAgICAgICAgICBcclxuICAgIF07XHJcblxyXG4gICAgbGV0IHJhdGluZ1RleHQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG5cclxuXHJcbiAgICBmb3IgKGNvbnN0IHNlbGVjdG9yIG9mIHJhdGluZ1NlbGVjdG9ycykge1xyXG4gICAgICAgIGNvbnN0IHJhdGluZ0VsZW1lbnQgPSBkb2MucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbiAgICAgICAgaWYgKHJhdGluZ0VsZW1lbnQpIHtcclxuICAgICAgICAgICAgY29uc3QgdGV4dCA9IHJhdGluZ0VsZW1lbnQudGV4dENvbnRlbnQ/LnRyaW0oKTtcclxuICAgICAgICAgICAgaWYgKHRleHQpIHtcclxuICAgICAgICAgICAgICAgIHJhdGluZ1RleHQgPSB0ZXh0O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gIFxyXG4gICAgaWYgKCFyYXRpbmdUZXh0KSB7XHJcbiAgICAgICAgY29uc3Qgc3Rhckljb25zID0gQXJyYXkuZnJvbShkb2MucXVlcnlTZWxlY3RvckFsbCgnc3BhbiwgZGl2JykpLmZpbmQoXHJcbiAgICAgICAgICAgIGVsID0+IGVsLnRleHRDb250ZW50Py50cmltKCkubWF0Y2goL15cdTI2MDUrJC8pXHJcbiAgICAgICAgKTtcclxuICAgICAgICBpZiAoc3Rhckljb25zKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJDb3VudCA9IHN0YXJJY29ucy50ZXh0Q29udGVudCEubGVuZ3RoO1xyXG4gICAgICAgICAgICByYXRpbmdUZXh0ID0gYCR7c3RhckNvdW50fSBvdXQgb2YgNSBzdGFyc2A7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChyYXRpbmdUZXh0KSB7XHJcblxyXG4gICAgICAgIGNvbnN0IG51bWVyaWNNYXRjaCA9IHJhdGluZ1RleHQubWF0Y2goLyhcXGQrKFxcLlxcZCspPylcXHMqb3V0XFxzKm9mXFxzKjUvaSk7XHJcbiAgICAgICAgaWYgKG51bWVyaWNNYXRjaCkge1xyXG4gICAgICAgICAgICBjb25zdCBudW1lcmljUmF0aW5nID0gcGFyc2VGbG9hdChudW1lcmljTWF0Y2hbMV0pO1xyXG4gICAgICAgICAgICBjb25zdCByb3VuZGVkU3RhcnMgPSBNYXRoLnJvdW5kKG51bWVyaWNSYXRpbmcpO1xyXG4gICAgICAgICAgICBjb25zdCBzdGFycyA9ICdcdTI2MDUnLnJlcGVhdChyb3VuZGVkU3RhcnMpICsgJ1x1MjYwNicucmVwZWF0KDUgLSByb3VuZGVkU3RhcnMpO1xyXG4gICAgICAgICAgICByZXR1cm4gYCR7bnVtZXJpY1JhdGluZ30gb3V0IG9mIDUgc3RhcnMgKCR7c3RhcnN9KWA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBzdGFyTWF0Y2ggPSByYXRpbmdUZXh0Lm1hdGNoKC9cdTI2MDUrLyk7XHJcbiAgICAgICAgaWYgKHN0YXJNYXRjaCkge1xyXG4gICAgICAgICAgICBjb25zdCBzdGFyUmF0aW5nID0gc3Rhck1hdGNoWzBdLmxlbmd0aDtcclxuICAgICAgICAgICAgY29uc3Qgc3RhcnMgPSAnXHUyNjA1Jy5yZXBlYXQoc3RhclJhdGluZykgKyAnXHUyNjA2Jy5yZXBlYXQoNSAtIHN0YXJSYXRpbmcpO1xyXG4gICAgICAgICAgICByZXR1cm4gYCR7c3RhclJhdGluZ30gb3V0IG9mIDUgc3RhcnMgKCR7c3RhcnN9KWA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiAgcHJpdmF0ZSByZXNvbHZlVXJsKGJhc2U6IHN0cmluZywgcmVsYXRpdmU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICB0cnkge1xyXG4gICAgICByZXR1cm4gbmV3IFVSTChyZWxhdGl2ZSwgYmFzZSkudG9TdHJpbmcoKTtcclxuICAgIH0gY2F0Y2gge1xyXG4gICAgICByZXR1cm4gcmVsYXRpdmU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHJcblxyXG4gIFxyXG59XHJcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBd0Q7OztBQ0F4RCxJQUFBQyxtQkFBd0Q7OztBQ0NqRCxTQUFTLGFBQWEsS0FBNEI7QUFDdkQsTUFBSTtBQUNGLFVBQU0sWUFBWSxJQUFJLElBQUksR0FBRztBQUc3QixVQUFNLGlCQUFpQjtBQUFBLE1BQ3JCO0FBQUEsTUFBYztBQUFBLE1BQWM7QUFBQSxNQUM1QjtBQUFBLE1BQVk7QUFBQSxNQUFlO0FBQUEsTUFBVTtBQUFBLElBQ3ZDO0FBRUEsbUJBQWUsUUFBUSxXQUFTO0FBQzlCLGdCQUFVLGFBQWEsT0FBTyxLQUFLO0FBQUEsSUFDckMsQ0FBQztBQUVELFdBQU8sVUFBVSxTQUFTO0FBQUEsRUFDNUIsU0FBUSxHQUFOO0FBQ0EsV0FBTztBQUFBLEVBQ1Q7QUFDRjtBQUdPLFNBQVMsYUFBYSxNQUFzQjtBQUNqRCxTQUFPLEtBQ0osUUFBUSxrQkFBa0IsR0FBRyxFQUM3QixRQUFRLFFBQVEsR0FBRyxFQUNuQixLQUFLO0FBQ1Y7QUFHTyxTQUFTLFVBQVUsS0FBcUI7QUFDN0MsTUFBSTtBQUNGLFVBQU0sWUFBWSxJQUFJLElBQUksR0FBRztB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R3hDLFVBQU0sVUFBVSxLQUFLLGtCQUFrQixtQkFBbUIsS0FBSyxhQUFhO0FBQzVFLFVBQU0sZUFBZSxLQUFLLGtCQUFrQixpQkFBaUIsR0FBRztBQUNoRSxVQUFNLFNBQVMsS0FBSyxrQkFBa0IsY0FBYyxHQUFHO0FBQ3ZELFVBQU0sT0FBTyxLQUFLLGtCQUFrQixtQkFBbUIsR0FBRztBQUMxRCxVQUFNLGNBQWMsS0FBSyxrQkFBa0IsbUJBQW1CLEdBQUc7QUFDakUsVUFBTSxRQUFRLEtBQUssa0JBQWtCLGFBQWEsR0FBRztBQUNyRCxVQUFNLFFBQVEsS0FBSyxrQkFBa0IsYUFBYSxHQUFHO0FBQ3JELFVBQU0sU0FBUyxLQUFLLGtCQUFrQixjQUFjLEdBQUc7QUFFdkQsVUFBTSxZQUFZLFFBQVEsTUFBTSxLQUFLLEVBQUU7QUFDdkMsVUFBTSxjQUFjLEtBQUssTUFBTSxZQUFZLEdBQUc7QUFDOUMsVUFBTSxjQUFjLEtBQUssS0FBSyxZQUFZLEdBQUc7QUFDN0MsVUFBTSxjQUFjLGdCQUFnQixjQUNuQyxHQUFHLGdCQUNILEdBQUcsZUFBZTtBQUduQixVQUFNLFdBQVcsYUFBYSxHQUFHLFVBQVU7QUFDM0MsVUFBTSxXQUFXLEdBQUcsY0FBYztBQUlsQyxVQUFNLEtBQUssSUFBSSxNQUFNO0FBQUEsTUFDbkI7QUFBQSxNQUNBO0FBQUEsVUFDVztBQUFBLFdBQ0M7QUFBQSxLQUNYLGNBQWMsY0FBYztBQUFBLElBQWtCLE9BQzlDLFNBQVMsWUFBWTtBQUFBLElBQWMsT0FDbkMsT0FBTyxVQUFVO0FBQUEsSUFBWSxPQUM3QixjQUFjLGlCQUFpQjtBQUFBLElBQXNCLE9BQ3JELFFBQVEsV0FBVztBQUFBLElBQWEsT0FDaEMsUUFBUSxXQUFXO0FBQUEsSUFBYSxPQUNoQyxTQUFTLFdBQVc7QUFBQSxJQUFjLE1BQ25DO0FBQUE7QUFBQSxLQUNDLGVBQWUsZ0JBQWdCO0FBQUE7QUFBQSxJQUFzQixNQUN0RCxHQUFHO0FBQUEsSUFDTDtBQUVBLFVBQU0sS0FBSyxlQUFlO0FBQzFCLFFBQUksd0JBQU8sd0JBQXdCLE9BQU87QUFBQSxFQUM1QztBQUFBLEVBRUEsTUFBYyxpQkFBaUI7QUFDN0IsUUFBSSxLQUFLLGFBQWE7QUFDcEIsWUFBTSxZQUFZLEtBQUssWUFBWSxZQUFZLGNBQWMsMEJBQTBCO0FBQ3ZGLFVBQUkscUJBQXFCLGdCQUFnQjtBQUN2QyxjQUFNLEtBQUssWUFBWSxtQkFBbUIsU0FBUztBQUFBLE1BRXJEO0FBQUEsSUFDRjtBQUFBLEVBQ0Y7QUFJRjsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJERUZBVUxUX1NFVFRJTkdTIiwgIl9hIiwgIkRFRkFVTFRfU0VUVElOR1MiXQp9Cg==
